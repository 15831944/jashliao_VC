<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>DSACSS Operational Code: DefaultObserver.cpp Source File</title>
<link href="doxygen.css" tppabs="http://dsacss.sourceforge.net/doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.4 -->
<h1>DefaultObserver.cpp</h1><a href="DefaultObserver_8cpp.html" tppabs="http://dsacss.sourceforge.net/DefaultObserver_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 
00002 
00009 <span class="comment">/*  </span>
00010 <span class="comment">*/</span>
00012 
00013 <span class="preprocessor">#include "<a class="code" href="DefaultObserver_8h.html" tppabs="http://dsacss.sourceforge.net/DefaultObserver_8h.html">DefaultObserver.h</a>"</span>
00014 
00015 Matrix <a class="code" href="DefaultObserver_8cpp.html#a0" tppabs="http://dsacss.sourceforge.net/DefaultObserver_8cpp.html#a0">Euler_Fmatrix</a>(<a class="code" href="classKalmanFilter.html" tppabs="http://dsacss.sourceforge.net/classKalmanFilter.html">KalmanFilter</a>* ekf);
00016 Matrix <a class="code" href="DefaultObserver_8cpp.html#a1" tppabs="http://dsacss.sourceforge.net/DefaultObserver_8cpp.html#a1">Euler_Hmatrix</a>(<a class="code" href="classKalmanFilter.html" tppabs="http://dsacss.sourceforge.net/classKalmanFilter.html">KalmanFilter</a>* kf);
00017 Matrix <a class="code" href="DefaultObserver_8cpp.html#a2" tppabs="http://dsacss.sourceforge.net/DefaultObserver_8cpp.html#a2">Euler_Qmatrix</a>(<a class="code" href="classKalmanFilter.html" tppabs="http://dsacss.sourceforge.net/classKalmanFilter.html">KalmanFilter</a>* kf);
00018 Matrix <a class="code" href="DefaultObserver_8cpp.html#a3" tppabs="http://dsacss.sourceforge.net/DefaultObserver_8cpp.html#a3">Euler_Rmatrix</a>(<a class="code" href="classKalmanFilter.html" tppabs="http://dsacss.sourceforge.net/classKalmanFilter.html">KalmanFilter</a>* kf);
00019 Vector <a class="code" href="DefaultObserver_8cpp.html#a4" tppabs="http://dsacss.sourceforge.net/DefaultObserver_8cpp.html#a4">Euler_stateRHSFunc</a>(<span class="keywordtype">double</span> t, Vector initialState, Vector controls, Vector params);
00020 Vector <a class="code" href="DefaultObserver_8cpp.html#a5" tppabs="http://dsacss.sourceforge.net/DefaultObserver_8cpp.html#a5">Euler_measurementRHSFunc</a>(<a class="code" href="classExtendedKalmanFilter.html" tppabs="http://dsacss.sourceforge.net/classExtendedKalmanFilter.html">ExtendedKalmanFilter</a>* ekf);
00021 
<a name="l00023"></a><a class="code" href="classDefaultObserver.html#DefaultObservera3" tppabs="http://dsacss.sourceforge.net/classDefaultObserver.html#DefaultObservera3">00023</a> <span class="keywordtype">int</span> <a class="code" href="classDefaultObserver.html#DefaultObservera3" tppabs="http://dsacss.sourceforge.net/classDefaultObserver.html#DefaultObservera3">DefaultObserver::Initialize</a>() {
00024         
00026         Matrix P(3,3);
00027         P(1,1) = 0.001; P(1,2) = 0.0;   P(1,3) = 0.0;
00028         P(2,1) = 0.0;   P(2,2) = 0.001; P(2,3) = 0.0;
00029         P(3,1) = 0.0;   P(3,2) = 0.0;   P(3,3) = 0.001;
00030         Matrix K(3,3);
00031         K(1,1) = 0.001; K(1,2) = 0.0;   K(1,3) = 0.0;
00032         K(2,1) = 0.0;   K(2,2) = 0.001; K(2,3) = 0.0;
00033         K(3,1) = 0.0;   K(3,2) = 0.0;   K(3,3) = 0.001;
00034         
00035         <a class="code" href="classDefaultObserver.html#DefaultObserverr0" tppabs="http://dsacss.sourceforge.net/classDefaultObserver.html#DefaultObserverr0">ekf</a>.<a class="code" href="classKalmanFilter.html#KalmanFiltera8" tppabs="http://dsacss.sourceforge.net/classKalmanFilter.html#KalmanFiltera8">SetCovarianceMatrix</a>(P);
00036         <a class="code" href="classDefaultObserver.html#DefaultObserverr0" tppabs="http://dsacss.sourceforge.net/classDefaultObserver.html#DefaultObserverr0">ekf</a>.<a class="code" href="classKalmanFilter.html#KalmanFiltera9" tppabs="http://dsacss.sourceforge.net/classKalmanFilter.html#KalmanFiltera9">SetKalmanGainMatrix</a>(K);
00037         
00038         <a class="code" href="classDefaultObserver.html#DefaultObserverr0" tppabs="http://dsacss.sourceforge.net/classDefaultObserver.html#DefaultObserverr0">ekf</a>.<a class="code" href="classKalmanFilter.html#KalmanFiltera15" tppabs="http://dsacss.sourceforge.net/classKalmanFilter.html#KalmanFiltera15">SetSystemProcessNoiseMatrix</a>(&amp;<a class="code" href="DefaultObserver_8cpp.html#a2" tppabs="http://dsacss.sourceforge.net/DefaultObserver_8cpp.html#a2">Euler_Qmatrix</a>);
00039         <a class="code" href="classDefaultObserver.html#DefaultObserverr0" tppabs="http://dsacss.sourceforge.net/classDefaultObserver.html#DefaultObserverr0">ekf</a>.<a class="code" href="classKalmanFilter.html#KalmanFiltera16" tppabs="http://dsacss.sourceforge.net/classKalmanFilter.html#KalmanFiltera16">SetMeasurementCovarianceMatrix</a>(&amp;<a class="code" href="DefaultObserver_8cpp.html#a3" tppabs="http://dsacss.sourceforge.net/DefaultObserver_8cpp.html#a3">Euler_Rmatrix</a>);
00040         <a class="code" href="classDefaultObserver.html#DefaultObserverr0" tppabs="http://dsacss.sourceforge.net/classDefaultObserver.html#DefaultObserverr0">ekf</a>.<a class="code" href="classKalmanFilter.html#KalmanFiltera17" tppabs="http://dsacss.sourceforge.net/classKalmanFilter.html#KalmanFiltera17">SetStateJacobianMatrix</a>(&amp;<a class="code" href="DefaultObserver_8cpp.html#a0" tppabs="http://dsacss.sourceforge.net/DefaultObserver_8cpp.html#a0">Euler_Fmatrix</a>);
00041         <a class="code" href="classDefaultObserver.html#DefaultObserverr0" tppabs="http://dsacss.sourceforge.net/classDefaultObserver.html#DefaultObserverr0">ekf</a>.<a class="code" href="classKalmanFilter.html#KalmanFiltera18" tppabs="http://dsacss.sourceforge.net/classKalmanFilter.html#KalmanFiltera18">SetMeasurementJacobianMatrix</a>(&amp;<a class="code" href="DefaultObserver_8cpp.html#a1" tppabs="http://dsacss.sourceforge.net/DefaultObserver_8cpp.html#a1">Euler_Hmatrix</a>);
00042         
00043         <a class="code" href="classDefaultObserver.html#DefaultObserverr0" tppabs="http://dsacss.sourceforge.net/classDefaultObserver.html#DefaultObserverr0">ekf</a>.<a class="code" href="classExtendedKalmanFilter.html#IteratedExtendedKalmanFiltera9" tppabs="http://dsacss.sourceforge.net/classExtendedKalmanFilter.html#IteratedExtendedKalmanFiltera9">SetStateRHS</a>(&amp;<a class="code" href="DefaultObserver_8cpp.html#a4" tppabs="http://dsacss.sourceforge.net/DefaultObserver_8cpp.html#a4">Euler_stateRHSFunc</a>);
00044         <a class="code" href="classDefaultObserver.html#DefaultObserverr0" tppabs="http://dsacss.sourceforge.net/classDefaultObserver.html#DefaultObserverr0">ekf</a>.<a class="code" href="classExtendedKalmanFilter.html#IteratedExtendedKalmanFiltera10" tppabs="http://dsacss.sourceforge.net/classExtendedKalmanFilter.html#IteratedExtendedKalmanFiltera10">SetMeasurementRHS</a>(&amp;<a class="code" href="DefaultObserver_8cpp.html#a5" tppabs="http://dsacss.sourceforge.net/DefaultObserver_8cpp.html#a5">Euler_measurementRHSFunc</a>);
00045         
00046         <span class="keywordflow">return</span> 0;
00047         
00048 };
00049 
<a name="l00051"></a><a class="code" href="classDefaultObserver.html#DefaultObservera4" tppabs="http://dsacss.sourceforge.net/classDefaultObserver.html#DefaultObservera4">00051</a> <span class="keywordtype">int</span> <a class="code" href="classDefaultObserver.html#DefaultObservera4" tppabs="http://dsacss.sourceforge.net/classDefaultObserver.html#DefaultObservera4">DefaultObserver::Run</a>() {
00052         
00054         <a class="code" href="classDefaultObserver.html#DefaultObserverr4" tppabs="http://dsacss.sourceforge.net/classDefaultObserver.html#DefaultObserverr4">m_measurements</a>[0] = <a class="code" href="classDefaultObserver.html#DefaultObserverr1" tppabs="http://dsacss.sourceforge.net/classDefaultObserver.html#DefaultObserverr1">m_whorl</a>-&gt;<a class="code" href="classWhorl.html#Whorla15" tppabs="http://dsacss.sourceforge.net/classWhorl.html#Whorla15">GetRateGyro</a>(string(<span class="stringliteral">"dmu_rg1"</span>))-&gt;<a class="code" href="classSensor.html#WheelSensora3" tppabs="http://dsacss.sourceforge.net/classSensor.html#WheelSensora3">GetMeasurement</a>();
00055         <a class="code" href="classDefaultObserver.html#DefaultObserverr4" tppabs="http://dsacss.sourceforge.net/classDefaultObserver.html#DefaultObserverr4">m_measurements</a>[1] = <a class="code" href="classDefaultObserver.html#DefaultObserverr1" tppabs="http://dsacss.sourceforge.net/classDefaultObserver.html#DefaultObserverr1">m_whorl</a>-&gt;<a class="code" href="classWhorl.html#Whorla15" tppabs="http://dsacss.sourceforge.net/classWhorl.html#Whorla15">GetRateGyro</a>(string(<span class="stringliteral">"dmu_rg2"</span>))-&gt;<a class="code" href="classSensor.html#WheelSensora3" tppabs="http://dsacss.sourceforge.net/classSensor.html#WheelSensora3">GetMeasurement</a>();
00056         <a class="code" href="classDefaultObserver.html#DefaultObserverr4" tppabs="http://dsacss.sourceforge.net/classDefaultObserver.html#DefaultObserverr4">m_measurements</a>[2] = <a class="code" href="classDefaultObserver.html#DefaultObserverr1" tppabs="http://dsacss.sourceforge.net/classDefaultObserver.html#DefaultObserverr1">m_whorl</a>-&gt;<a class="code" href="classWhorl.html#Whorla15" tppabs="http://dsacss.sourceforge.net/classWhorl.html#Whorla15">GetRateGyro</a>(string(<span class="stringliteral">"dmu_rg3"</span>))-&gt;<a class="code" href="classSensor.html#WheelSensora3" tppabs="http://dsacss.sourceforge.net/classSensor.html#WheelSensora3">GetMeasurement</a>();
00057         Vector z(3);
00058         z(1) = <a class="code" href="classDefaultObserver.html#DefaultObserverr4" tppabs="http://dsacss.sourceforge.net/classDefaultObserver.html#DefaultObserverr4">m_measurements</a>[0].<a class="code" href="classMeasurement.html#Measurementa12" tppabs="http://dsacss.sourceforge.net/classMeasurement.html#Measurementa12">GetAsDouble</a>();
00059         z(2) = <a class="code" href="classDefaultObserver.html#DefaultObserverr4" tppabs="http://dsacss.sourceforge.net/classDefaultObserver.html#DefaultObserverr4">m_measurements</a>[1].<a class="code" href="classMeasurement.html#Measurementa12" tppabs="http://dsacss.sourceforge.net/classMeasurement.html#Measurementa12">GetAsDouble</a>();
00060         z(3) = <a class="code" href="classDefaultObserver.html#DefaultObserverr4" tppabs="http://dsacss.sourceforge.net/classDefaultObserver.html#DefaultObserverr4">m_measurements</a>[2].<a class="code" href="classMeasurement.html#Measurementa12" tppabs="http://dsacss.sourceforge.net/classMeasurement.html#Measurementa12">GetAsDouble</a>();
00061         
00063         timeval measurementTime, currentTime;
00064         <a class="code" href="classDefaultObserver.html#DefaultObserverr4" tppabs="http://dsacss.sourceforge.net/classDefaultObserver.html#DefaultObserverr4">m_measurements</a>[0].<a class="code" href="classMeasurement.html#Measurementa6" tppabs="http://dsacss.sourceforge.net/classMeasurement.html#Measurementa6">GetTime</a>(measurementTime);
00065         currentTime = <a class="code" href="classDefaultObserver.html#DefaultObserverr1" tppabs="http://dsacss.sourceforge.net/classDefaultObserver.html#DefaultObserverr1">m_whorl</a>-&gt;<a class="code" href="classWhorl.html#Whorla10" tppabs="http://dsacss.sourceforge.net/classWhorl.html#Whorla10">GetTimeOfEstimate</a>();
00066         <span class="keywordtype">double</span> relTimeOfMeasurement = static_cast&lt;double&gt;(measurementTime.tv_sec - currentTime.tv_sec) + (static_cast&lt;double&gt;(measurementTime.tv_usec - currentTime.tv_usec)) * 1e-6;
00067         
00068         <span class="comment">/* Begin filter code --------------------------------- */</span>
00069         
00071         Vector state   = <a class="code" href="classDefaultObserver.html#DefaultObserverr1" tppabs="http://dsacss.sourceforge.net/classDefaultObserver.html#DefaultObserverr1">m_whorl</a>-&gt;<a class="code" href="classWhorl.html#Whorla8" tppabs="http://dsacss.sourceforge.net/classWhorl.html#Whorla8">GetOmegaBL</a>();
00072         Vector control = <a class="code" href="classDefaultObserver.html#DefaultObserverr1" tppabs="http://dsacss.sourceforge.net/classDefaultObserver.html#DefaultObserverr1">m_whorl</a>-&gt;<a class="code" href="classWhorl.html#Whorla9" tppabs="http://dsacss.sourceforge.net/classWhorl.html#Whorla9">GetControl</a>();
00073         Vector params  = <a class="code" href="classDefaultObserver.html#DefaultObserverr1" tppabs="http://dsacss.sourceforge.net/classDefaultObserver.html#DefaultObserverr1">m_whorl</a>-&gt;<a class="code" href="classWhorl.html#Whorla3" tppabs="http://dsacss.sourceforge.net/classWhorl.html#Whorla3">GetParameter</a>();
00074         <span class="keywordtype">double</span> zero = 0.0;
00075         <a class="code" href="classDefaultObserver.html#DefaultObserverr0" tppabs="http://dsacss.sourceforge.net/classDefaultObserver.html#DefaultObserverr0">ekf</a>.<a class="code" href="classSequentialFilter.html#SequentialFiltera1" tppabs="http://dsacss.sourceforge.net/classSequentialFilter.html#SequentialFiltera1">SetTimeOfEstimate</a>(zero);             <span class="comment">// set time of the last estimate</span>
00076         <a class="code" href="classDefaultObserver.html#DefaultObserverr0" tppabs="http://dsacss.sourceforge.net/classDefaultObserver.html#DefaultObserverr0">ekf</a>.<a class="code" href="classSequentialFilter.html#SequentialFiltera2" tppabs="http://dsacss.sourceforge.net/classSequentialFilter.html#SequentialFiltera2">SetTimeOfMeasurements</a>(relTimeOfMeasurement); <span class="comment">// set time of the measurements</span>
00077         <a class="code" href="classDefaultObserver.html#DefaultObserverr0" tppabs="http://dsacss.sourceforge.net/classDefaultObserver.html#DefaultObserverr0">ekf</a>.<a class="code" href="classSequentialFilter.html#SequentialFiltera3" tppabs="http://dsacss.sourceforge.net/classSequentialFilter.html#SequentialFiltera3">SetStateVector</a>(state);                  <span class="comment">// set the state vector</span>
00078         <a class="code" href="classDefaultObserver.html#DefaultObserverr0" tppabs="http://dsacss.sourceforge.net/classDefaultObserver.html#DefaultObserverr0">ekf</a>.<a class="code" href="classSequentialFilter.html#SequentialFiltera4" tppabs="http://dsacss.sourceforge.net/classSequentialFilter.html#SequentialFiltera4">SetControlVector</a>(control);
00079         <a class="code" href="classDefaultObserver.html#DefaultObserverr0" tppabs="http://dsacss.sourceforge.net/classDefaultObserver.html#DefaultObserverr0">ekf</a>.<a class="code" href="classSequentialFilter.html#SequentialFiltera6" tppabs="http://dsacss.sourceforge.net/classSequentialFilter.html#SequentialFiltera6">SetParameterVector</a>(params);
00080         <a class="code" href="classDefaultObserver.html#DefaultObserverr0" tppabs="http://dsacss.sourceforge.net/classDefaultObserver.html#DefaultObserverr0">ekf</a>.<a class="code" href="classSequentialFilter.html#SequentialFiltera5" tppabs="http://dsacss.sourceforge.net/classSequentialFilter.html#SequentialFiltera5">SetMeasurementVector</a>(z);
00081         
00083         <a class="code" href="classDefaultObserver.html#DefaultObserverr0" tppabs="http://dsacss.sourceforge.net/classDefaultObserver.html#DefaultObserverr0">ekf</a>.<a class="code" href="classExtendedKalmanFilter.html#ExtendedKalmanFiltera7" tppabs="http://dsacss.sourceforge.net/classExtendedKalmanFilter.html#ExtendedKalmanFiltera7">EstimateState</a>();
00084         
00085         <span class="comment">/* End filter code --------------------------------- */</span>
00086         <span class="comment">// Update the global Whorl class</span>
00087         state = <a class="code" href="classDefaultObserver.html#DefaultObserverr0" tppabs="http://dsacss.sourceforge.net/classDefaultObserver.html#DefaultObserverr0">ekf</a>.<a class="code" href="classSequentialFilter.html#SequentialFiltera10" tppabs="http://dsacss.sourceforge.net/classSequentialFilter.html#SequentialFiltera10">GetStateVector</a>();
00088         Vector fullState(7);
00089         fullState(4) = 1.0;
00090         fullState(_(5,7)) = state;
00091         <a class="code" href="classDefaultObserver.html#DefaultObserverr1" tppabs="http://dsacss.sourceforge.net/classDefaultObserver.html#DefaultObserverr1">m_whorl</a>-&gt;<a class="code" href="classWhorl.html#Whorla11" tppabs="http://dsacss.sourceforge.net/classWhorl.html#Whorla11">SetState</a>(fullState);
00092         <a class="code" href="classDefaultObserver.html#DefaultObserverr1" tppabs="http://dsacss.sourceforge.net/classDefaultObserver.html#DefaultObserverr1">m_whorl</a>-&gt;<a class="code" href="classWhorl.html#Whorla14" tppabs="http://dsacss.sourceforge.net/classWhorl.html#Whorla14">SetTimeOfEstimate</a>(measurementTime);
00093         
00094         <span class="keywordflow">return</span> 0;
00095         
00096 };
00097 
<a name="l00098"></a><a class="code" href="DefaultObserver_8cpp.html#a0" tppabs="http://dsacss.sourceforge.net/DefaultObserver_8cpp.html#a0">00098</a> Matrix <a class="code" href="DefaultObserver_8cpp.html#a0" tppabs="http://dsacss.sourceforge.net/DefaultObserver_8cpp.html#a0">Euler_Fmatrix</a>(<a class="code" href="classKalmanFilter.html" tppabs="http://dsacss.sourceforge.net/classKalmanFilter.html">KalmanFilter</a>* ekf) {
00099         
00100         Vector state  = ekf-&gt;<a class="code" href="classSequentialFilter.html#SequentialFiltera10" tppabs="http://dsacss.sourceforge.net/classSequentialFilter.html#SequentialFiltera10">GetStateVector</a>();
00101         Vector params = ekf-&gt;<a class="code" href="classSequentialFilter.html#SequentialFiltera13" tppabs="http://dsacss.sourceforge.net/classSequentialFilter.html#SequentialFiltera13">GetParameterVector</a>();
00102         
00103         Matrix MOI(3,3);
00104 
00105         MOI(1,1) = params(1); MOI(1,2) = params(2); MOI(1,3) = params(3);
00106         MOI(2,1) = params(2); MOI(2,2) = params(4); MOI(2,3) = params(5);
00107         MOI(3,1) = params(3); MOI(3,2) = params(5); MOI(3,3) = params(6);
00108         
00109         Vector w = state;
00110         
00111         Matrix temp = MOI/( -skew(w)*MOI +  skew(MOI * w) );
00112         
00113         <span class="keywordflow">return</span> temp;
00114         
00115 };
00116 
<a name="l00117"></a><a class="code" href="DefaultObserver_8cpp.html#a1" tppabs="http://dsacss.sourceforge.net/DefaultObserver_8cpp.html#a1">00117</a> Matrix <a class="code" href="DefaultObserver_8cpp.html#a1" tppabs="http://dsacss.sourceforge.net/DefaultObserver_8cpp.html#a1">Euler_Hmatrix</a>(<a class="code" href="classKalmanFilter.html" tppabs="http://dsacss.sourceforge.net/classKalmanFilter.html">KalmanFilter</a>* kf) {
00118         
00119         Matrix temp(3,3);
00120         
00121         temp(1,1) = 1.0; temp(1,2) = 0.0; temp(1,3) = 0.0;
00122         temp(2,1) = 0.0; temp(2,2) = 1.0; temp(2,3) = 0.0;
00123         temp(3,1) = 0.0; temp(3,2) = 0.0; temp(3,3) = 1.0;
00124         
00125         <span class="keywordflow">return</span> temp;
00126         
00127 };
00128 
<a name="l00129"></a><a class="code" href="DefaultObserver_8cpp.html#a2" tppabs="http://dsacss.sourceforge.net/DefaultObserver_8cpp.html#a2">00129</a> Matrix <a class="code" href="DefaultObserver_8cpp.html#a2" tppabs="http://dsacss.sourceforge.net/DefaultObserver_8cpp.html#a2">Euler_Qmatrix</a>(<a class="code" href="classKalmanFilter.html" tppabs="http://dsacss.sourceforge.net/classKalmanFilter.html">KalmanFilter</a>* kf) {
00130         
00131         Matrix temp(3,3);
00132         
00133         temp(1,1) = 0.0001; temp(1,2) = 0.0;   temp(1,3) = 0.0;
00134         temp(2,1) = 0.0;   temp(2,2) = 0.001; temp(2,3) = 0.0;
00135         temp(3,1) = 0.0;   temp(3,2) = 0.0;   temp(3,3) = 0.001;
00136 
00137         <span class="keywordflow">return</span> temp;
00138 
00139 };
00140 
<a name="l00141"></a><a class="code" href="DefaultObserver_8cpp.html#a3" tppabs="http://dsacss.sourceforge.net/DefaultObserver_8cpp.html#a3">00141</a> Matrix <a class="code" href="DefaultObserver_8cpp.html#a3" tppabs="http://dsacss.sourceforge.net/DefaultObserver_8cpp.html#a3">Euler_Rmatrix</a>(<a class="code" href="classKalmanFilter.html" tppabs="http://dsacss.sourceforge.net/classKalmanFilter.html">KalmanFilter</a>* ekf) {
00142         
00143         Matrix temp(3,3);
00144         <span class="keywordtype">double</span> gyro_err = 0.005, gyro_std = gyro_err / pow(2.0, 0.5);
00145         
00146         temp(1,1) = pow(gyro_std, 2.0); temp(1,2) = 0.0;                temp(1,3) = 0.0;
00147         temp(2,1) = 0.0;                temp(2,2) = pow(gyro_std, 2.0); temp(2,3) = 0.0;
00148         temp(3,1) = 0.0;                temp(3,2) = 0.0;                temp(3,3) = pow(gyro_std, 2.0);
00149         
00150         <span class="keywordflow">return</span> temp;
00151         
00152 };
00153 
<a name="l00154"></a><a class="code" href="DefaultObserver_8cpp.html#a4" tppabs="http://dsacss.sourceforge.net/DefaultObserver_8cpp.html#a4">00154</a> Vector <a class="code" href="DefaultObserver_8cpp.html#a4" tppabs="http://dsacss.sourceforge.net/DefaultObserver_8cpp.html#a4">Euler_stateRHSFunc</a>(<span class="keywordtype">double</span> t, Vector initialState, Vector controls, Vector params) {
00155 
00156         Vector w = initialState;
00157 
00158         Matrix MOI(3,3);
00159 
00160         MOI(1,1) = params(1); MOI(1,2) = params(2); MOI(1,3) = params(3);
00161         MOI(2,1) = params(2); MOI(2,2) = params(4); MOI(2,3) = params(5);
00162         MOI(3,1) = params(3); MOI(3,2) = params(5); MOI(3,3) = params(6);
00163         
00164 
00165         <span class="keywordflow">return</span> (MOI / ( (-skew(w) * MOI * w) + controls) );
00166 };
00167 
<a name="l00168"></a><a class="code" href="DefaultObserver_8cpp.html#a5" tppabs="http://dsacss.sourceforge.net/DefaultObserver_8cpp.html#a5">00168</a> Vector <a class="code" href="DefaultObserver_8cpp.html#a5" tppabs="http://dsacss.sourceforge.net/DefaultObserver_8cpp.html#a5">Euler_measurementRHSFunc</a>(<a class="code" href="classExtendedKalmanFilter.html" tppabs="http://dsacss.sourceforge.net/classExtendedKalmanFilter.html">ExtendedKalmanFilter</a>* ekf) { <span class="keywordflow">return</span> ekf-&gt;<a class="code" href="classSequentialFilter.html#SequentialFiltera10" tppabs="http://dsacss.sourceforge.net/classSequentialFilter.html#SequentialFiltera10">GetStateVector</a>(); };
00169 
00170 <span class="comment">// Do not change the comments below - they will be added automatically by CVS</span>
00171 <span class="comment">/*****************************************************************************</span>
00172 <span class="comment">*       $Log: DefaultObserver.cpp,v $</span>
00173 <span class="comment">*       Revision 1.12  2003/08/29 00:43:48  simpliciter</span>
00174 <span class="comment">*       Fixed bugs in F and RHS functions</span>
00175 <span class="comment">*       </span>
00176 <span class="comment">*       Revision 1.11  2003/08/18 19:09:30  mavandyk</span>
00177 <span class="comment">*       Fixed state update to include quaternion.</span>
00178 <span class="comment">*       </span>
00179 <span class="comment">*       Revision 1.10  2003/08/13 23:18:07  mavandyk</span>
00180 <span class="comment">*       Altered structure as outline in meeting.</span>
00181 <span class="comment">*       </span>
00182 <span class="comment">*       Revision 1.9  2003/08/06 21:49:11  mavandyk</span>
00183 <span class="comment">*       Added comments fixed class structure and runs with config parsig.</span>
00184 <span class="comment">*       </span>
00185 <span class="comment">*       Revision 1.8  2003/08/01 11:21:30  mavandyk</span>
00186 <span class="comment">*       Changed class structure.</span>
00187 <span class="comment">*       </span>
00188 <span class="comment">*       Revision 1.7  2003/07/22 21:22:52  mavandyk</span>
00189 <span class="comment">*       Fixed bugs.</span>
00190 <span class="comment">*       </span>
00191 <span class="comment">*       Revision 1.6  2003/07/21 21:53:48  mavandyk</span>
00192 <span class="comment">*       Fixed some syntax errors.</span>
00193 <span class="comment">*       </span>
00194 <span class="comment">*       Revision 1.5  2003/07/14 20:06:48  mavandyk</span>
00195 <span class="comment">*       Fixed calls to Whorl class, and handling of time and measurements.</span>
00196 <span class="comment">*       </span>
00197 <span class="comment">*       Revision 1.4  2003/07/10 19:51:02  mavandyk</span>
00198 <span class="comment">*       Fixed time handling.</span>
00199 <span class="comment">*       </span>
00200 <span class="comment">*       Revision 1.3  2003/07/07 20:47:44  mavandyk</span>
00201 <span class="comment">*       Changed the state RHS function to use the skew utility function.</span>
00202 <span class="comment">*       </span>
00203 <span class="comment">*       Revision 1.2  2003/07/07 20:43:34  mavandyk</span>
00204 <span class="comment">*       Fixed the Fmatrix function with JS's derivation of the Jacobian matrix for omegadot.</span>
00205 <span class="comment">*       </span>
00206 <span class="comment">*       Revision 1.1  2003/07/04 14:12:29  simpliciter</span>
00207 <span class="comment">*       Moved from src directory.</span>
00208 <span class="comment">*       </span>
00209 <span class="comment">*       Revision 1.1  2003/07/02 21:33:42  mavandyk</span>
00210 <span class="comment">*       The observer for the demo.</span>
00211 <span class="comment">*       </span>
00212 <span class="comment">*       Revision 1.1  2003/06/30 16:06:00  nicmcp</span>
00213 <span class="comment">*       replaced the controller files with the Controller files</span>
00214 <span class="comment">*       </span>
00215 <span class="comment">*       Revision 1.3  2003/06/30 15:51:57  nicmcp</span>
00216 <span class="comment">*       made some changes to the controller files</span>
00217 <span class="comment">*       </span>
00218 <span class="comment">*       Revision 1.2  2003/06/30 14:13:35  simpliciter</span>
00219 <span class="comment">*       Modified comments, added log blocks.</span>
00220 <span class="comment">*       </span>
00221 <span class="comment">*       </span>
00222 <span class="comment">*</span>
00223 <span class="comment">******************************************************************************/</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Tue Jun 15 11:49:54 2004 for DSACSS Operational Code by
<a href="javascript:if(confirm('http://www.doxygen.org/index.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.doxygen.org/index.html'" tppabs="http://www.doxygen.org/index.html">
<img src="doxygen.png" tppabs="http://dsacss.sourceforge.net/doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.4 </small></address>
</body>
</html>
