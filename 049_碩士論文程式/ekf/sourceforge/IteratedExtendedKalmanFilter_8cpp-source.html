<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>DSACSS Operational Code: IteratedExtendedKalmanFilter.cpp Source File</title>
<link href="doxygen.css" tppabs="http://dsacss.sourceforge.net/doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.4 -->
<h1>IteratedExtendedKalmanFilter.cpp</h1><a href="IteratedExtendedKalmanFilter_8cpp.html" tppabs="http://dsacss.sourceforge.net/IteratedExtendedKalmanFilter_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/************************************************************************************************/</span>
00012 <span class="preprocessor">#include "<a class="code" href="IteratedExtendedKalmanFilter_8h.html" tppabs="http://dsacss.sourceforge.net/IteratedExtendedKalmanFilter_8h.html">IteratedExtendedKalmanFilter.h</a>"</span>
00013 <span class="preprocessor">#include "<a class="code" href="LKFfunctions_8h.html" tppabs="http://dsacss.sourceforge.net/LKFfunctions_8h.html">LKFfunctions.h</a>"</span>
00014 <span class="preprocessor">#include "<a class="code" href="EKFfunctions_8h.html" tppabs="http://dsacss.sourceforge.net/EKFfunctions_8h.html">EKFfunctions.h</a>"</span>
00015 
<a name="l00016"></a><a class="code" href="classIteratedExtendedKalmanFilter.html#IteratedExtendedKalmanFiltera0" tppabs="http://dsacss.sourceforge.net/classIteratedExtendedKalmanFilter.html#IteratedExtendedKalmanFiltera0">00016</a> <a class="code" href="classIteratedExtendedKalmanFilter.html#IteratedExtendedKalmanFiltera0" tppabs="http://dsacss.sourceforge.net/classIteratedExtendedKalmanFilter.html#IteratedExtendedKalmanFiltera0">IteratedExtendedKalmanFilter::IteratedExtendedKalmanFilter</a>() {
00017         
00018         <a class="code" href="classKalmanFilter.html#KalmanFiltera15" tppabs="http://dsacss.sourceforge.net/classKalmanFilter.html#KalmanFiltera15">SetSystemProcessNoiseMatrix</a>(&amp;<a class="code" href="LKFfunctions_8cpp.html#a7" tppabs="http://dsacss.sourceforge.net/LKFfunctions_8cpp.html#a7">Qmatrix</a>);
00019         <a class="code" href="classKalmanFilter.html#KalmanFiltera16" tppabs="http://dsacss.sourceforge.net/classKalmanFilter.html#KalmanFiltera16">SetMeasurementCovarianceMatrix</a>(&amp;<a class="code" href="LKFfunctions_8cpp.html#a8" tppabs="http://dsacss.sourceforge.net/LKFfunctions_8cpp.html#a8">Rmatrix</a>);
00020         <a class="code" href="classKalmanFilter.html#KalmanFiltera17" tppabs="http://dsacss.sourceforge.net/classKalmanFilter.html#KalmanFiltera17">SetStateJacobianMatrix</a>(&amp;<a class="code" href="LKFfunctions_8cpp.html#a5" tppabs="http://dsacss.sourceforge.net/LKFfunctions_8cpp.html#a5">Fmatrix</a>);
00021         <a class="code" href="classKalmanFilter.html#KalmanFiltera18" tppabs="http://dsacss.sourceforge.net/classKalmanFilter.html#KalmanFiltera18">SetMeasurementJacobianMatrix</a>(&amp;<a class="code" href="LKFfunctions_8cpp.html#a6" tppabs="http://dsacss.sourceforge.net/LKFfunctions_8cpp.html#a6">Hmatrix</a>);
00022         
00023         <a class="code" href="classExtendedKalmanFilter.html#IteratedExtendedKalmanFiltera12" tppabs="http://dsacss.sourceforge.net/classExtendedKalmanFilter.html#IteratedExtendedKalmanFiltera12">SetNonlinearStatePropagator</a>(&amp;<a class="code" href="EKFfunctions_8cpp.html#a0" tppabs="http://dsacss.sourceforge.net/EKFfunctions_8cpp.html#a0">EKFStatePropagator</a>);
00024     <a class="code" href="classKalmanFilter.html#KalmanFiltera11" tppabs="http://dsacss.sourceforge.net/classKalmanFilter.html#KalmanFiltera11">SetCovariancePropagator</a>(&amp;<a class="code" href="LKFfunctions_8cpp.html#a1" tppabs="http://dsacss.sourceforge.net/LKFfunctions_8cpp.html#a1">LKFCovarianceMatrixPropagator</a>);
00025     <a class="code" href="classKalmanFilter.html#KalmanFiltera12" tppabs="http://dsacss.sourceforge.net/classKalmanFilter.html#KalmanFiltera12">SetKalmanGainCalculation</a>(&amp;<a class="code" href="LKFfunctions_8cpp.html#a2" tppabs="http://dsacss.sourceforge.net/LKFfunctions_8cpp.html#a2">LKFCalcualteKalmanGain</a>);
00026     <a class="code" href="classKalmanFilter.html#KalmanFiltera13" tppabs="http://dsacss.sourceforge.net/classKalmanFilter.html#KalmanFiltera13">SetStateMeasurementUpdate</a>(&amp;<a class="code" href="LKFfunctions_8cpp.html#a3" tppabs="http://dsacss.sourceforge.net/LKFfunctions_8cpp.html#a3">LKFStateMeasurementUpdate</a>);
00027     <a class="code" href="classKalmanFilter.html#KalmanFiltera14" tppabs="http://dsacss.sourceforge.net/classKalmanFilter.html#KalmanFiltera14">SetCovarianceMeasurementUpdate</a>(&amp;<a class="code" href="LKFfunctions_8cpp.html#a4" tppabs="http://dsacss.sourceforge.net/LKFfunctions_8cpp.html#a4">LKFCovarianceMeasurementUpdate</a>);
00028         <a class="code" href="classExtendedKalmanFilter.html#IteratedExtendedKalmanFiltera11" tppabs="http://dsacss.sourceforge.net/classExtendedKalmanFilter.html#IteratedExtendedKalmanFiltera11">SetPropagationStepSize</a>(<a class="code" href="ExtendedKalmanFilter_8h.html#a0" tppabs="http://dsacss.sourceforge.net/ExtendedKalmanFilter_8h.html#a0">DEFAULT_PROPAGATION_STEP_SIZE</a>);
00029         
00030         <a class="code" href="classIteratedExtendedKalmanFilter.html#IteratedExtendedKalmanFiltera3" tppabs="http://dsacss.sourceforge.net/classIteratedExtendedKalmanFilter.html#IteratedExtendedKalmanFiltera3">SetIterationLimit</a>(<a class="code" href="IteratedExtendedKalmanFilter_8h.html#a0" tppabs="http://dsacss.sourceforge.net/IteratedExtendedKalmanFilter_8h.html#a0">DEFAULT_ITERATION_LIMIT</a>);
00031         <a class="code" href="classIteratedExtendedKalmanFilter.html#IteratedExtendedKalmanFiltera4" tppabs="http://dsacss.sourceforge.net/classIteratedExtendedKalmanFilter.html#IteratedExtendedKalmanFiltera4">SetTolerance</a>(<a class="code" href="IteratedExtendedKalmanFilter_8h.html#a1" tppabs="http://dsacss.sourceforge.net/IteratedExtendedKalmanFilter_8h.html#a1">DEFAULT_TOLERANCE</a>);
00032         
00033 };
00034 
<a name="l00035"></a><a class="code" href="classIteratedExtendedKalmanFilter.html#IteratedExtendedKalmanFiltera1" tppabs="http://dsacss.sourceforge.net/classIteratedExtendedKalmanFilter.html#IteratedExtendedKalmanFiltera1">00035</a> <a class="code" href="classIteratedExtendedKalmanFilter.html#IteratedExtendedKalmanFiltera0" tppabs="http://dsacss.sourceforge.net/classIteratedExtendedKalmanFilter.html#IteratedExtendedKalmanFiltera0">IteratedExtendedKalmanFilter::IteratedExtendedKalmanFilter</a>(<span class="keywordtype">double</span> propStepSize, <span class="keywordtype">int</span> iterLimit, <span class="keywordtype">double</span> tol) {
00036         
00037         <a class="code" href="classKalmanFilter.html#KalmanFiltera15" tppabs="http://dsacss.sourceforge.net/classKalmanFilter.html#KalmanFiltera15">SetSystemProcessNoiseMatrix</a>(&amp;<a class="code" href="LKFfunctions_8cpp.html#a7" tppabs="http://dsacss.sourceforge.net/LKFfunctions_8cpp.html#a7">Qmatrix</a>);
00038         <a class="code" href="classKalmanFilter.html#KalmanFiltera16" tppabs="http://dsacss.sourceforge.net/classKalmanFilter.html#KalmanFiltera16">SetMeasurementCovarianceMatrix</a>(&amp;<a class="code" href="LKFfunctions_8cpp.html#a8" tppabs="http://dsacss.sourceforge.net/LKFfunctions_8cpp.html#a8">Rmatrix</a>);
00039         <a class="code" href="classKalmanFilter.html#KalmanFiltera17" tppabs="http://dsacss.sourceforge.net/classKalmanFilter.html#KalmanFiltera17">SetStateJacobianMatrix</a>(&amp;<a class="code" href="LKFfunctions_8cpp.html#a5" tppabs="http://dsacss.sourceforge.net/LKFfunctions_8cpp.html#a5">Fmatrix</a>);
00040         <a class="code" href="classKalmanFilter.html#KalmanFiltera18" tppabs="http://dsacss.sourceforge.net/classKalmanFilter.html#KalmanFiltera18">SetMeasurementJacobianMatrix</a>(&amp;<a class="code" href="LKFfunctions_8cpp.html#a6" tppabs="http://dsacss.sourceforge.net/LKFfunctions_8cpp.html#a6">Hmatrix</a>);
00041         
00042         <a class="code" href="classExtendedKalmanFilter.html#IteratedExtendedKalmanFiltera12" tppabs="http://dsacss.sourceforge.net/classExtendedKalmanFilter.html#IteratedExtendedKalmanFiltera12">SetNonlinearStatePropagator</a>(&amp;<a class="code" href="EKFfunctions_8cpp.html#a0" tppabs="http://dsacss.sourceforge.net/EKFfunctions_8cpp.html#a0">EKFStatePropagator</a>);
00043     <a class="code" href="classKalmanFilter.html#KalmanFiltera11" tppabs="http://dsacss.sourceforge.net/classKalmanFilter.html#KalmanFiltera11">SetCovariancePropagator</a>(&amp;<a class="code" href="LKFfunctions_8cpp.html#a1" tppabs="http://dsacss.sourceforge.net/LKFfunctions_8cpp.html#a1">LKFCovarianceMatrixPropagator</a>);
00044     <a class="code" href="classKalmanFilter.html#KalmanFiltera12" tppabs="http://dsacss.sourceforge.net/classKalmanFilter.html#KalmanFiltera12">SetKalmanGainCalculation</a>(&amp;<a class="code" href="LKFfunctions_8cpp.html#a2" tppabs="http://dsacss.sourceforge.net/LKFfunctions_8cpp.html#a2">LKFCalcualteKalmanGain</a>);
00045     <a class="code" href="classKalmanFilter.html#KalmanFiltera13" tppabs="http://dsacss.sourceforge.net/classKalmanFilter.html#KalmanFiltera13">SetStateMeasurementUpdate</a>(&amp;<a class="code" href="LKFfunctions_8cpp.html#a3" tppabs="http://dsacss.sourceforge.net/LKFfunctions_8cpp.html#a3">LKFStateMeasurementUpdate</a>);
00046     <a class="code" href="classKalmanFilter.html#KalmanFiltera14" tppabs="http://dsacss.sourceforge.net/classKalmanFilter.html#KalmanFiltera14">SetCovarianceMeasurementUpdate</a>(&amp;<a class="code" href="LKFfunctions_8cpp.html#a4" tppabs="http://dsacss.sourceforge.net/LKFfunctions_8cpp.html#a4">LKFCovarianceMeasurementUpdate</a>);
00047         <a class="code" href="classExtendedKalmanFilter.html#IteratedExtendedKalmanFiltera11" tppabs="http://dsacss.sourceforge.net/classExtendedKalmanFilter.html#IteratedExtendedKalmanFiltera11">SetPropagationStepSize</a>(propStepSize);
00048         
00049         <a class="code" href="classIteratedExtendedKalmanFilter.html#IteratedExtendedKalmanFiltera3" tppabs="http://dsacss.sourceforge.net/classIteratedExtendedKalmanFilter.html#IteratedExtendedKalmanFiltera3">SetIterationLimit</a>(iterLimit);
00050         <a class="code" href="classIteratedExtendedKalmanFilter.html#IteratedExtendedKalmanFiltera4" tppabs="http://dsacss.sourceforge.net/classIteratedExtendedKalmanFilter.html#IteratedExtendedKalmanFiltera4">SetTolerance</a>(tol);
00051         
00052 };
00053 
<a name="l00055"></a><a class="code" href="classIteratedExtendedKalmanFilter.html#IteratedExtendedKalmanFiltera5" tppabs="http://dsacss.sourceforge.net/classIteratedExtendedKalmanFilter.html#IteratedExtendedKalmanFiltera5">00055</a> <span class="keywordtype">void</span> <a class="code" href="classIteratedExtendedKalmanFilter.html#IteratedExtendedKalmanFiltera5" tppabs="http://dsacss.sourceforge.net/classIteratedExtendedKalmanFilter.html#IteratedExtendedKalmanFiltera5">IteratedExtendedKalmanFilter::EstimateState</a>() {
00056         
00057         <a class="code" href="classExtendedKalmanFilter.html#IteratedExtendedKalmanFilterb0" tppabs="http://dsacss.sourceforge.net/classExtendedKalmanFilter.html#IteratedExtendedKalmanFilterb0">PropagateState</a>();
00058         <a class="code" href="classKalmanFilter.html#KalmanFiltera4" tppabs="http://dsacss.sourceforge.net/classKalmanFilter.html#KalmanFiltera4">PropagateCovariance</a>();
00059         <a class="code" href="classKalmanFilter.html#KalmanFiltera5" tppabs="http://dsacss.sourceforge.net/classKalmanFilter.html#KalmanFiltera5">CalculateKalmanGain</a>();
00060         <a class="code" href="classKalmanFilter.html#KalmanFiltera6" tppabs="http://dsacss.sourceforge.net/classKalmanFilter.html#KalmanFiltera6">MeasurementUpdateState</a>();
00061         
00062         <span class="keywordtype">int</span> count = 0;
00063         Vector stateError = <a class="code" href="classSequentialFilter.html#SequentialFilterp2" tppabs="http://dsacss.sourceforge.net/classSequentialFilter.html#SequentialFilterp2">m_states</a>;
00064         Vector priorStates = m_states;
00065         <span class="keywordflow">while</span> ((count &lt;= m_iterationLimit) &amp;&amp; (norm2(stateError) &gt; <a class="code" href="classIteratedExtendedKalmanFilter.html#IteratedExtendedKalmanFilterp1" tppabs="http://dsacss.sourceforge.net/classIteratedExtendedKalmanFilter.html#IteratedExtendedKalmanFilterp1">m_tolerance</a>)) {
00066                 
00067                 count++;
00068                 <a class="code" href="classKalmanFilter.html#KalmanFiltera5" tppabs="http://dsacss.sourceforge.net/classKalmanFilter.html#KalmanFiltera5">CalculateKalmanGain</a>();
00069                 <a class="code" href="classKalmanFilter.html#KalmanFiltera6" tppabs="http://dsacss.sourceforge.net/classKalmanFilter.html#KalmanFiltera6">MeasurementUpdateState</a>();
00070                 stateError = m_states - priorStates;
00071                 priorStates = m_states;
00072                                 
00073         };
00074         
00075         <a class="code" href="classKalmanFilter.html#KalmanFiltera7" tppabs="http://dsacss.sourceforge.net/classKalmanFilter.html#KalmanFiltera7">MeasurementUpdateCovariance</a>();
00076         <a class="code" href="classSequentialFilter.html#SequentialFilterp0" tppabs="http://dsacss.sourceforge.net/classSequentialFilter.html#SequentialFilterp0">m_timeOfEstimate</a> = <a class="code" href="classSequentialFilter.html#SequentialFilterp1" tppabs="http://dsacss.sourceforge.net/classSequentialFilter.html#SequentialFilterp1">m_timeOfMeasurements</a>;
00077         <a class="code" href="classIteratedExtendedKalmanFilter.html#IteratedExtendedKalmanFilterp2" tppabs="http://dsacss.sourceforge.net/classIteratedExtendedKalmanFilter.html#IteratedExtendedKalmanFilterp2">m_numIterations</a> = count;
00078         
00079 };
00080 
00081 <span class="comment">// Do not change the comments below - they will be added automatically by CVS</span>
00082 <span class="comment">/*****************************************************************************</span>
00083 <span class="comment">* $Log: IteratedExtendedKalmanFilter.cpp,v $</span>
00084 <span class="comment">* Revision 1.7  2003/07/14 20:47:45  simpliciter</span>
00085 <span class="comment">* Fixed logic error in looping.</span>
00086 <span class="comment">*</span>
00087 <span class="comment">* Revision 1.6  2003/07/14 19:42:49  simpliciter</span>
00088 <span class="comment">* Cleaner code.</span>
00089 <span class="comment">*</span>
00090 <span class="comment">* Revision 1.5  2003/07/14 19:36:27  simpliciter</span>
00091 <span class="comment">* Fixed iteration bug</span>
00092 <span class="comment">*</span>
00093 <span class="comment">* Revision 1.4  2003/07/12 17:57:52  simpliciter</span>
00094 <span class="comment">* Added IEKF and EKF Histories.</span>
00095 <span class="comment">*</span>
00096 <span class="comment">* Revision 1.3  2003/07/01 21:04:54  mavandyk</span>
00097 <span class="comment">* Edited default constructor, and added another constructor to set iteration and step size values.</span>
00098 <span class="comment">*</span>
00099 <span class="comment">* Revision 1.2  2003/07/01 20:24:01  mavandyk</span>
00100 <span class="comment">* Corrected syntax errors.</span>
00101 <span class="comment">*</span>
00102 <span class="comment">* Revision 1.1  2003/06/30 21:49:01  mavandyk</span>
00103 <span class="comment">* Implementation file for the IteratedExtendedKalmanFilter class.</span>
00104 <span class="comment">*</span>
00105 <span class="comment">* Revision 1.4  2003/06/12 16:16:00  mavandyk</span>
00106 <span class="comment">* Changed all references to iterative filter to sequential filter for greater clarity.  Removed improper lines of code involving iterated filter references.</span>
00107 <span class="comment">*</span>
00108 <span class="comment">* Revision 1.3  2003/06/11 15:46:42  simpliciter</span>
00109 <span class="comment">* Added include line for IterativeFilter.h.</span>
00110 <span class="comment">*</span>
00111 <span class="comment">* Revision 1.2  2003/06/11 13:08:27  simpliciter</span>
00112 <span class="comment">* Minor changes.</span>
00113 <span class="comment">*</span>
00114 <span class="comment">* Revision 1.1  2003/06/11 03:04:43  simpliciter</span>
00115 <span class="comment">* Initial submission.</span>
00116 <span class="comment">*</span>
00117 <span class="comment">******************************************************************************/</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Tue Jun 15 11:49:54 2004 for DSACSS Operational Code by
<a href="javascript:if(confirm('http://www.doxygen.org/index.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.doxygen.org/index.html'" tppabs="http://www.doxygen.org/index.html">
<img src="doxygen.png" tppabs="http://dsacss.sourceforge.net/doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.4 </small></address>
</body>
</html>
