<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>DSACSS Operational Code: KalmanFilterHistory.cpp Source File</title>
<link href="doxygen.css" tppabs="http://dsacss.sourceforge.net/doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.4 -->
<h1>KalmanFilterHistory.cpp</h1><a href="KalmanFilterHistory_8cpp.html" tppabs="http://dsacss.sourceforge.net/KalmanFilterHistory_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 
00002 
00008 <span class="comment">/*  </span>
00009 <span class="comment"> */</span>
00011 
00012 <span class="preprocessor">#include "<a class="code" href="KalmanFilterHistory_8h.html" tppabs="http://dsacss.sourceforge.net/KalmanFilterHistory_8h.html">KalmanFilterHistory.h</a>"</span>
00013 
<a name="l00016"></a><a class="code" href="classKalmanFilterHistory.html#KalmanFilterHistorya1" tppabs="http://dsacss.sourceforge.net/classKalmanFilterHistory.html#KalmanFilterHistorya1">00016</a> <a class="code" href="classKalmanFilterHistory.html#KalmanFilterHistorya0" tppabs="http://dsacss.sourceforge.net/classKalmanFilterHistory.html#KalmanFilterHistorya0">KalmanFilterHistory::KalmanFilterHistory</a>(<a class="code" href="classSequentialFilter.html" tppabs="http://dsacss.sourceforge.net/classSequentialFilter.html">SequentialFilter</a>* _ptr_filter)
00017 {
00018         <span class="comment">// calls the initialization sequence in SequentialFilterHistory</span>
00019     <a class="code" href="classSequentialFilterHistory.html#SequentialFilterHistoryb0" tppabs="http://dsacss.sourceforge.net/classSequentialFilterHistory.html#SequentialFilterHistoryb0">InitializeSequentialFilterHistory</a>(_ptr_filter);
00020         
00021         <span class="comment">// new Kalman Filter data to be stored:  the covariance and Kalman gain matrices.</span>
00022         <a class="code" href="classKalmanFilterHistory.html#KalmanFilterHistoryp0" tppabs="http://dsacss.sourceforge.net/classKalmanFilterHistory.html#KalmanFilterHistoryp0">m_kfCovarianceHistory</a>.reserve(HISTORY_RESERVE_SIZE);
00023         <a class="code" href="classKalmanFilterHistory.html#KalmanFilterHistoryp1" tppabs="http://dsacss.sourceforge.net/classKalmanFilterHistory.html#KalmanFilterHistoryp1">m_kfKalmanGainHistory</a>.reserve(HISTORY_RESERVE_SIZE);
00024         
00025         <span class="comment">// not doing interpolations at this time</span>
00026         <span class="comment">//m_kalmanFilterInterpolations.reserve(HISTORY_RESERVE_SIZE);</span>
00027 }
00028 
00029 
00030 
<a name="l00040"></a><a class="code" href="classKalmanFilterHistory.html#KalmanFilterHistorya3" tppabs="http://dsacss.sourceforge.net/classKalmanFilterHistory.html#KalmanFilterHistorya3">00040</a> <span class="keywordtype">void</span> <a class="code" href="classKalmanFilterHistory.html#KalmanFilterHistorya3" tppabs="http://dsacss.sourceforge.net/classKalmanFilterHistory.html#KalmanFilterHistorya3">KalmanFilterHistory::AppendHistory</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; _appendTime)
00041 {
00042     <a class="code" href="classKalmanFilterHistory.html#KalmanFilterHistorya3" tppabs="http://dsacss.sourceforge.net/classKalmanFilterHistory.html#KalmanFilterHistorya3">AppendHistory</a>(ssfTime(_appendTime));
00043 }    
00044 
00045 
00046 
<a name="l00056"></a><a class="code" href="classKalmanFilterHistory.html#KalmanFilterHistorya4" tppabs="http://dsacss.sourceforge.net/classKalmanFilterHistory.html#KalmanFilterHistorya4">00056</a> <span class="keywordtype">void</span> <a class="code" href="classKalmanFilterHistory.html#KalmanFilterHistorya3" tppabs="http://dsacss.sourceforge.net/classKalmanFilterHistory.html#KalmanFilterHistorya3">KalmanFilterHistory::AppendHistory</a>(<span class="keyword">const</span> ssfTime&amp; _appendTime)
00057 {
00058         <span class="comment">// This guy logs the time, states, controls, measurements, parameters.</span>
00059         <a class="code" href="classSequentialFilterHistory.html#SequentialFilterHistorya1" tppabs="http://dsacss.sourceforge.net/classSequentialFilterHistory.html#SequentialFilterHistorya1">SequentialFilterHistory::AppendHistory</a>(_appendTime);
00060         
00061         <span class="comment">// And now the P and K matrices.</span>
00062         <a class="code" href="classKalmanFilterHistory.html#KalmanFilterHistoryp0" tppabs="http://dsacss.sourceforge.net/classKalmanFilterHistory.html#KalmanFilterHistoryp0">m_kfCovarianceHistory</a>.push_back( <a class="code" href="classSequentialFilterHistory.html#SequentialFilterHistoryp0" tppabs="http://dsacss.sourceforge.net/classSequentialFilterHistory.html#SequentialFilterHistoryp0">m_ptr_filter</a>-&gt;<a class="code" href="classSequentialFilter.html#SequentialFiltera15" tppabs="http://dsacss.sourceforge.net/classSequentialFilter.html#SequentialFiltera15">GetCovarianceMatrix</a>() );
00063         <a class="code" href="classKalmanFilterHistory.html#KalmanFilterHistoryp1" tppabs="http://dsacss.sourceforge.net/classKalmanFilterHistory.html#KalmanFilterHistoryp1">m_kfKalmanGainHistory</a>.push_back( <a class="code" href="classSequentialFilterHistory.html#SequentialFilterHistoryp0" tppabs="http://dsacss.sourceforge.net/classSequentialFilterHistory.html#SequentialFilterHistoryp0">m_ptr_filter</a>-&gt;<a class="code" href="classSequentialFilter.html#SequentialFiltera16" tppabs="http://dsacss.sourceforge.net/classSequentialFilter.html#SequentialFiltera16">GetKalmanGainMatrix</a>() );
00064         
00065         <span class="keywordflow">return</span>;
00066 }
00067 
00068 
00069 
<a name="l00071"></a><a class="code" href="classKalmanFilterHistory.html#KalmanFilterHistorya5" tppabs="http://dsacss.sourceforge.net/classKalmanFilterHistory.html#KalmanFilterHistorya5">00071</a> <span class="keywordtype">void</span> <a class="code" href="classKalmanFilterHistory.html#KalmanFilterHistorya5" tppabs="http://dsacss.sourceforge.net/classKalmanFilterHistory.html#KalmanFilterHistorya5">KalmanFilterHistory::ResetHistory</a>() { }
00072 
00073 
00074 
<a name="l00078"></a><a class="code" href="classKalmanFilterHistory.html#KalmanFilterHistorya6" tppabs="http://dsacss.sourceforge.net/classKalmanFilterHistory.html#KalmanFilterHistorya6">00078</a> Matrix <a class="code" href="classKalmanFilterHistory.html#KalmanFilterHistorya6" tppabs="http://dsacss.sourceforge.net/classKalmanFilterHistory.html#KalmanFilterHistorya6">KalmanFilterHistory::GetHistory</a>()
00079 {
00080         Matrix returnMatrix;
00081         
00082         <span class="comment">//Let SequentialFilterHistory do the work.</span>
00083         returnMatrix = <a class="code" href="classSequentialFilterHistory.html#SequentialFilterHistorya4" tppabs="http://dsacss.sourceforge.net/classSequentialFilterHistory.html#SequentialFilterHistorya4">SequentialFilterHistory::GetHistory</a>();
00084         
00085         <span class="keywordflow">return</span> returnMatrix;
00086 }
00087 
00088 
00089 
<a name="l00100"></a><a class="code" href="classKalmanFilterHistory.html#KalmanFilterHistorya7" tppabs="http://dsacss.sourceforge.net/classKalmanFilterHistory.html#KalmanFilterHistorya7">00100</a> <span class="keywordtype">void</span> <a class="code" href="classKalmanFilterHistory.html#KalmanFilterHistorya7" tppabs="http://dsacss.sourceforge.net/classKalmanFilterHistory.html#KalmanFilterHistorya7">KalmanFilterHistory::GetKalmanHistory</a>(Matrix&amp; _sfHistMatrix, Matrix&amp; _kfHistMatrix)
00101 {
00102         <span class="comment">// sequential filter data</span>
00103         _sfHistMatrix = <a class="code" href="classSequentialFilterHistory.html#SequentialFilterHistorya4" tppabs="http://dsacss.sourceforge.net/classSequentialFilterHistory.html#SequentialFilterHistorya4">SequentialFilterHistory::GetHistory</a>();
00104         
00105         <span class="comment">// kalman filter data</span>
00106         <span class="comment">// note that the covariance matrix is nxn and the kalman gain matrix is nxm</span>
00107         <span class="keywordtype">int</span> StateVectorSize = <a class="code" href="classSequentialFilterHistory.html#SequentialFilterHistoryp0" tppabs="http://dsacss.sourceforge.net/classSequentialFilterHistory.html#SequentialFilterHistoryp0">m_ptr_filter</a>-&gt;<a class="code" href="classSequentialFilter.html#SequentialFiltera10" tppabs="http://dsacss.sourceforge.net/classSequentialFilter.html#SequentialFiltera10">GetStateVector</a>().getIndexBound();                           <span class="comment">// length n</span>
00108         <span class="keywordtype">int</span> MeasurementVectorSize = <a class="code" href="classSequentialFilterHistory.html#SequentialFilterHistoryp0" tppabs="http://dsacss.sourceforge.net/classSequentialFilterHistory.html#SequentialFilterHistoryp0">m_ptr_filter</a>-&gt;<a class="code" href="classSequentialFilter.html#SequentialFiltera12" tppabs="http://dsacss.sourceforge.net/classSequentialFilter.html#SequentialFiltera12">GetMeasurementVector</a>().getIndexBound();       <span class="comment">// length m</span>
00109                 
00110     Matrix rightSize(m_TimeHistory.size()*StateVectorSize, StateVectorSize + MeasurementVectorSize);
00111         
00112         _kfHistMatrix.initialize(rightSize); 
00113         
00114         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ii = 0; ii*StateVectorSize &lt; m_TimeHistory.size()*StateVectorSize; ii++ )
00115         {
00116                 _kfHistMatrix( _( MatrixIndexBase + ii*StateVectorSize, MatrixIndexBase + ii*StateVectorSize + StateVectorSize - 1 ),
00117                                    _( MatrixIndexBase, MatrixIndexBase + StateVectorSize - 1 ) ) = <a class="code" href="classKalmanFilterHistory.html#KalmanFilterHistoryp0" tppabs="http://dsacss.sourceforge.net/classKalmanFilterHistory.html#KalmanFilterHistoryp0">m_kfCovarianceHistory</a>[ii];
00118                 _kfHistMatrix( _( MatrixIndexBase + ii*StateVectorSize, MatrixIndexBase + ii*StateVectorSize + StateVectorSize - 1 ),
00119                                    _( MatrixIndexBase + StateVectorSize , MatrixIndexBase + StateVectorSize + MeasurementVectorSize - 1 ) ) = <a class="code" href="classKalmanFilterHistory.html#KalmanFilterHistoryp1" tppabs="http://dsacss.sourceforge.net/classKalmanFilterHistory.html#KalmanFilterHistoryp1">m_kfKalmanGainHistory</a>[ii];
00120         }
00121 }
00122 
00123 
00124 
00125 
00126 <span class="comment">// Do not change the comments below - they will be added automatically by CVS</span>
00127 <span class="comment">/*****************************************************************************</span>
00128 <span class="comment">*       $Log: KalmanFilterHistory.cpp,v $</span>
00129 <span class="comment">*       Revision 1.3  2003/11/01 21:00:15  rsharo</span>
00130 <span class="comment">*       changed "Time.h" includes to "utils/Time.h" includes. Also eliminated excess compile warnings.</span>
00131 <span class="comment">*       </span>
00132 <span class="comment">*       Revision 1.2  2003/06/28 00:46:06  simpliciter</span>
00133 <span class="comment">*       Finished GetKalmanHistory.  Huzzah!</span>
00134 <span class="comment">*       </span>
00135 <span class="comment">*       Revision 1.1  2003/06/27 01:52:50  simpliciter</span>
00136 <span class="comment">*       Fully commented!  And almost fully functional.</span>
00137 <span class="comment">*       Once I learn the best way to copy chunks of one Matrix</span>
00138 <span class="comment">*       into another I'll finish GetKalmanHistory.  Otherwise</span>
00139 <span class="comment">*       everything is done.  GetState is not implemented because</span>
00140 <span class="comment">*       it would require / desire interpolations, which seems out</span>
00141 <span class="comment">*       of spirit with tracking the effectiveness of a filter.</span>
00142 <span class="comment">*       </span>
00143 <span class="comment">*       Revision 1.1  2003/06/24 15:50:06  simpliciter</span>
00144 <span class="comment">*       Everything but the all important "GetHistory" command</span>
00145 <span class="comment">*       should work.  :)</span>
00146 <span class="comment">*       </span>
00147 <span class="comment">*       Revision 1.0  2003/06/06 18:44:15  simpliciter</span>
00148 <span class="comment">*       Initial submission.</span>
00149 <span class="comment">*       </span>
00150 <span class="comment">*</span>
00151 <span class="comment">******************************************************************************/</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Tue Jun 15 11:49:54 2004 for DSACSS Operational Code by
<a href="javascript:if(confirm('http://www.doxygen.org/index.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.doxygen.org/index.html'" tppabs="http://www.doxygen.org/index.html">
<img src="doxygen.png" tppabs="http://dsacss.sourceforge.net/doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.4 </small></address>
</body>
</html>
