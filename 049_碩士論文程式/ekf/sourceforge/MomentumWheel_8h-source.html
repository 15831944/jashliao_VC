<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>DSACSS Operational Code: MomentumWheel.h Source File</title>
<link href="doxygen.css" tppabs="http://dsacss.sourceforge.net/doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.4 -->
<h1>MomentumWheel.h</h1><a href="MomentumWheel_8h.html" tppabs="http://dsacss.sourceforge.net/MomentumWheel_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/************************************************************************************************/</span>
00012 <span class="preprocessor">#ifndef __SSSL_MOMENTUMWHEEL_H__</span>
00013 <span class="preprocessor"></span><span class="preprocessor">#define __SSSL_MOMENTUMWHEEL_H__</span>
00014 <span class="preprocessor"></span>
00015 <span class="preprocessor">#include "<a class="code" href="Actuator_8h.html" tppabs="http://dsacss.sourceforge.net/Actuator_8h.html">Actuator.h</a>"</span>
00016 <span class="preprocessor">#include "Matrix.h"</span>
00017 <span class="preprocessor">#include "<a class="code" href="Misc_8h.html" tppabs="http://dsacss.sourceforge.net/Misc_8h.html">Misc.h</a>"</span>
00018 <span class="preprocessor">#include &lt;string&gt;</span>
00019 <span class="comment">//#include &lt;sstream&gt;</span>
00020 <span class="preprocessor">#include "<a class="code" href="PhysicalMomentumWheel_8h.html" tppabs="http://dsacss.sourceforge.net/PhysicalMomentumWheel_8h.html">PhysicalMomentumWheel.h</a>"</span>
00021 <span class="keyword">using</span> <span class="keyword">namespace </span>std;
00022 <span class="keyword">using</span> <span class="keyword">namespace </span>O_SESSAME;
00023 
<a name="l00025"></a><a class="code" href="classMomentumWheel.html" tppabs="http://dsacss.sourceforge.net/classMomentumWheel.html">00025</a> <span class="keyword">class </span><a class="code" href="classMomentumWheel.html" tppabs="http://dsacss.sourceforge.net/classMomentumWheel.html">MomentumWheel</a> : <span class="keyword">public</span> <a class="code" href="classActuator.html" tppabs="http://dsacss.sourceforge.net/classActuator.html">Actuator</a>  
00026 {
00027 <span class="keyword">public</span>:
00028     <span class="comment">// Contructors/Deconstructors</span>
00029 
00031     <a class="code" href="classMomentumWheel.html#MomentumWheela0" tppabs="http://dsacss.sourceforge.net/classMomentumWheel.html#MomentumWheela0">MomentumWheel</a>();
00032     
00034     <a class="code" href="classMomentumWheel.html#MomentumWheela0" tppabs="http://dsacss.sourceforge.net/classMomentumWheel.html#MomentumWheela0">MomentumWheel</a>(<a class="code" href="structcfgBody.html" tppabs="http://dsacss.sourceforge.net/structcfgBody.html">cfgBody</a>&amp; cfgdat);
00035     
00037     <span class="keyword">virtual</span> <a class="code" href="classMomentumWheel.html#MomentumWheela2" tppabs="http://dsacss.sourceforge.net/classMomentumWheel.html#MomentumWheela2">~MomentumWheel</a>();
00038 
00039     <span class="comment">// Facilitators</span>
00040     <span class="comment">//</span>
00043 <span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classMomentumWheel.html#MomentumWheela3" tppabs="http://dsacss.sourceforge.net/classMomentumWheel.html#MomentumWheela3">SetWheelSpeed</a>(<span class="keywordtype">double</span> wheelOmega);   <span class="comment">// will change wheelOmega if set different due to saturation</span>
00044         
00046         <span class="keywordtype">void</span> <a class="code" href="classMomentumWheel.html#MomentumWheela4" tppabs="http://dsacss.sourceforge.net/classMomentumWheel.html#MomentumWheela4">StopPID</a>();
00047         
00049         <span class="keywordtype">void</span> <a class="code" href="classMomentumWheel.html#MomentumWheela5" tppabs="http://dsacss.sourceforge.net/classMomentumWheel.html#MomentumWheela5">StartSpeedQuery</a>();
00050         
00053         <span class="keywordtype">void</span> <a class="code" href="classMomentumWheel.html#MomentumWheela6" tppabs="http://dsacss.sourceforge.net/classMomentumWheel.html#MomentumWheela6">StopSpeedQuery</a>();
00054 
00057     <span class="keywordtype">void</span> <a class="code" href="classMomentumWheel.html#MomentumWheela7" tppabs="http://dsacss.sourceforge.net/classMomentumWheel.html#MomentumWheela7">SetWheelTorque</a>(<span class="keywordtype">double</span> wheelTorque); 
00058         
00061     <span class="keywordtype">void</span> <a class="code" href="classMomentumWheel.html#MomentumWheela8" tppabs="http://dsacss.sourceforge.net/classMomentumWheel.html#MomentumWheela8">SetSystemTorque</a>(<span class="keywordtype">double</span> wheelTorque);
00062 
00064     <span class="keywordtype">int</span> <a class="code" href="classMomentumWheel.html#MomentumWheela9" tppabs="http://dsacss.sourceforge.net/classMomentumWheel.html#MomentumWheela9">Stop</a>();
00065 
00067     <span class="keywordtype">int</span> <a class="code" href="classMomentumWheel.html#MomentumWheela10" tppabs="http://dsacss.sourceforge.net/classMomentumWheel.html#MomentumWheela10">Initialize</a>();
00068 
00070     <span class="keywordtype">int</span> <a class="code" href="classMomentumWheel.html#MomentumWheela11" tppabs="http://dsacss.sourceforge.net/classMomentumWheel.html#MomentumWheela11">Deinitialize</a>();
00071 
00074     <span class="keywordtype">void</span> <a class="code" href="classMomentumWheel.html#MomentumWheela12" tppabs="http://dsacss.sourceforge.net/classMomentumWheel.html#MomentumWheela12">SetWheelAddress</a>(<span class="keywordtype">int</span> wheeladdress);
00075     
00076     <span class="comment">// Mutators</span>
00077     
00080     <span class="keywordtype">void</span> <a class="code" href="classMomentumWheel.html#MomentumWheela13" tppabs="http://dsacss.sourceforge.net/classMomentumWheel.html#MomentumWheela13">SetWheelAxis</a>(<span class="keyword">const</span> Vector&amp; newWheelAxis);
00081 
00083     <span class="keywordtype">void</span> <a class="code" href="classMomentumWheel.html#MomentumWheela14" tppabs="http://dsacss.sourceforge.net/classMomentumWheel.html#MomentumWheela14">SetPort</a>(string Port);
00084     
00086     <span class="keywordtype">void</span> <a class="code" href="classMomentumWheel.html#MomentumWheela15" tppabs="http://dsacss.sourceforge.net/classMomentumWheel.html#MomentumWheela15">SetBiasSpeed</a>(<span class="keywordtype">double</span> BiasSpeed);
00087     
00088     <span class="comment">// Inspectors</span>
00089 
00093    <span class="keywordtype">void</span> <a class="code" href="classMomentumWheel.html#MomentumWheela16" tppabs="http://dsacss.sourceforge.net/classMomentumWheel.html#MomentumWheela16">GetWheelSpeed</a>(<span class="keywordtype">double</span>&amp; Speed, <span class="keywordtype">double</span>&amp; measTime);
00094 
00096     <span class="keywordtype">double</span> <a class="code" href="classMomentumWheel.html#MomentumWheela17" tppabs="http://dsacss.sourceforge.net/classMomentumWheel.html#MomentumWheela17">GetWheelTorque</a>();
00097 
00099     Vector <a class="code" href="classMomentumWheel.html#MomentumWheela18" tppabs="http://dsacss.sourceforge.net/classMomentumWheel.html#MomentumWheela18">GetWheelAxis</a>() <span class="keyword">const</span>;
00100 
<a name="l00102"></a><a class="code" href="classMomentumWheel.html#MomentumWheela19" tppabs="http://dsacss.sourceforge.net/classMomentumWheel.html#MomentumWheela19">00102</a>     <span class="keywordtype">int</span> <a class="code" href="classMomentumWheel.html#MomentumWheela19" tppabs="http://dsacss.sourceforge.net/classMomentumWheel.html#MomentumWheela19">GetWheelCount</a>()<span class="keyword"> const</span>{<span class="keywordflow">return</span> <a class="code" href="classMomentumWheel.html#MomentumWheelv0" tppabs="http://dsacss.sourceforge.net/classMomentumWheel.html#MomentumWheelv0">wheelCount</a>;}  
00103 
<a name="l00105"></a><a class="code" href="classMomentumWheel.html#MomentumWheela20" tppabs="http://dsacss.sourceforge.net/classMomentumWheel.html#MomentumWheela20">00105</a>     <span class="keywordtype">double</span> <a class="code" href="classMomentumWheel.html#MomentumWheela20" tppabs="http://dsacss.sourceforge.net/classMomentumWheel.html#MomentumWheela20">GetAxialInertia</a>(){<span class="keywordflow">return</span> <a class="code" href="classMomentumWheel.html#MomentumWheelr3" tppabs="http://dsacss.sourceforge.net/classMomentumWheel.html#MomentumWheelr3">m_AxialInertia</a>;}
00106         
00108         <span class="keywordtype">int</span> <a class="code" href="classMomentumWheel.html#MomentumWheela21" tppabs="http://dsacss.sourceforge.net/classMomentumWheel.html#MomentumWheela21">GetWheelFD</a>();
00109         
00111         <span class="keywordtype">double</span> <a class="code" href="classMomentumWheel.html#MomentumWheela22" tppabs="http://dsacss.sourceforge.net/classMomentumWheel.html#MomentumWheela22">GetAmps</a>();
00112         
00114         <span class="keywordtype">double</span> <a class="code" href="classMomentumWheel.html#MomentumWheela23" tppabs="http://dsacss.sourceforge.net/classMomentumWheel.html#MomentumWheela23">GetVolts</a>();
00115     
00116 <span class="keyword">protected</span>: 
00117     
00118     
00119 <span class="keyword">private</span>:
00120 
00122     <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classMomentumWheel.html#MomentumWheelv0" tppabs="http://dsacss.sourceforge.net/classMomentumWheel.html#MomentumWheelv0">wheelCount</a>;
00123 
<a name="l00125"></a><a class="code" href="classMomentumWheel.html#MomentumWheelr0" tppabs="http://dsacss.sourceforge.net/classMomentumWheel.html#MomentumWheelr0">00125</a>     <span class="keywordtype">double</span> <a class="code" href="classMomentumWheel.html#MomentumWheelr0" tppabs="http://dsacss.sourceforge.net/classMomentumWheel.html#MomentumWheelr0">m_CurrentWheelSpeed</a>;
00126 
00127     <span class="comment">/* member double representing the current torque on the wheel in N-m*/</span>
<a name="l00128"></a><a class="code" href="classMomentumWheel.html#MomentumWheelr1" tppabs="http://dsacss.sourceforge.net/classMomentumWheel.html#MomentumWheelr1">00128</a>     <span class="keywordtype">double</span> <a class="code" href="classMomentumWheel.html#MomentumWheelr1" tppabs="http://dsacss.sourceforge.net/classMomentumWheel.html#MomentumWheelr1">m_CurrentWheelTorque</a>;
00129 
00130     <span class="comment">/* 3x1 vector corresponding to the axis normal to the wheel*/</span>
<a name="l00131"></a><a class="code" href="classMomentumWheel.html#MomentumWheelr2" tppabs="http://dsacss.sourceforge.net/classMomentumWheel.html#MomentumWheelr2">00131</a>     Vector <a class="code" href="classMomentumWheel.html#MomentumWheelr2" tppabs="http://dsacss.sourceforge.net/classMomentumWheel.html#MomentumWheelr2">m_WheelAxis</a>; 
00132 
00133     <span class="comment">/* Double representing the axial inertia of the wheel*/</span>
<a name="l00134"></a><a class="code" href="classMomentumWheel.html#MomentumWheelr3" tppabs="http://dsacss.sourceforge.net/classMomentumWheel.html#MomentumWheelr3">00134</a>     <span class="keywordtype">double</span> <a class="code" href="classMomentumWheel.html#MomentumWheelr3" tppabs="http://dsacss.sourceforge.net/classMomentumWheel.html#MomentumWheelr3">m_AxialInertia</a>;
00135 
<a name="l00137"></a><a class="code" href="classMomentumWheel.html#MomentumWheelr4" tppabs="http://dsacss.sourceforge.net/classMomentumWheel.html#MomentumWheelr4">00137</a>     <span class="keywordtype">double</span> <a class="code" href="classMomentumWheel.html#MomentumWheelr4" tppabs="http://dsacss.sourceforge.net/classMomentumWheel.html#MomentumWheelr4">m_BiasSpeed</a>;
00138 
00139     <span class="comment">/* Member PhysicalMomentumWheel object*/</span>
<a name="l00140"></a><a class="code" href="classMomentumWheel.html#MomentumWheelr5" tppabs="http://dsacss.sourceforge.net/classMomentumWheel.html#MomentumWheelr5">00140</a>     <a class="code" href="classPhysicalMomentumWheel.html" tppabs="http://dsacss.sourceforge.net/classPhysicalMomentumWheel.html">PhysicalMomentumWheel</a> <a class="code" href="classMomentumWheel.html#MomentumWheelr5" tppabs="http://dsacss.sourceforge.net/classMomentumWheel.html#MomentumWheelr5">m_PhysicalMomentumWheel</a>;
00141 
00142 };
00143 
00144 <span class="preprocessor">#endif </span>
00145 <span class="preprocessor"></span><span class="comment">// Do not change the comments below - they will be added automatically by CVS</span>
00146 <span class="comment">/*****************************************************************************</span>
00147 <span class="comment">*       $Log: MomentumWheel.h,v $</span>
00148 <span class="comment">*       Revision 1.25  2004/03/04 23:13:09  bstreetman</span>
00149 <span class="comment">*       Big changes! new functions and functionality.  FUnctions: GetVolts() -- get motor voltage.  GetAmps() -- ge current used by motors.  GetWheelFD() -- get the wheel comm file descriptor.  SetBiasSpeed() -- Set the bias speed used in momentum wheel mode.  SetSystemTorque() -- old style torque function, used mainly by me.  friend RUnTorqueCOntroller() -- new torque controller, runs in a separate thread.  StartTorqueController() -- spawns torque thread, called internally.  Other Changes:  config parameters -- added BiasSpeed confige parameter, sets bias speed and commands the wheel to go there.  SetWheelSpeed() -- no more PID controller, uses a function created by the data i took.  SetWHeelTorque() -- happens in a better way now based on tons of data and hdot = g.</span>
00150 <span class="comment">*       </span>
00151 <span class="comment">*       Revision 1.24  2003/12/16 17:20:26  bstreetman</span>
00152 <span class="comment">*       A bit o' fall cleaning.  Just look at how pretty it is.</span>
00153 <span class="comment">*       </span>
00154 <span class="comment">*       Revision 1.23  2003/11/14 20:15:44  bstreetman</span>
00155 <span class="comment">*       Apparently I broke the PID controller with the last update, but now it works again.  I also added a StopPID() function to end the thread of the PID controller.  To spin up to 900 rpm (about half speed) use SetWheelSpedd(92).  If you wnat to then switch to torque control sleep for about 12 seconds and run StopPID() and you should be good to go.</span>
00156 <span class="comment">*       </span>
00157 <span class="comment">*       Revision 1.22  2003/10/17 20:01:33  bstreetman</span>
00158 <span class="comment">*       Wheel code updated to reflect hardware changes.  All wheels now considered on separate serial port.  Wheels also changed to read wheel velocity in a separate thread.  Thread is fired off by StartSpeedQuery() function.  Wheel Speed and measurement timestamp are set by the function GetWheelSpeed(speed, time).  See SpeedTest.cpp in the work directory for a sample using the new code.</span>
00159 <span class="comment">*       </span>
00160 <span class="comment">*       Revision 1.21  2003/08/18 19:31:17  mavandyk</span>
00161 <span class="comment">*       Fixed config parsing.</span>
00162 <span class="comment">*       </span>
00163 <span class="comment">*       Revision 1.20  2003/08/06 21:18:48  bstreetman</span>
00164 <span class="comment">*       Updated to work with config parser</span>
00165 <span class="comment">*       </span>
00166 <span class="comment">*       Revision 1.19  2003/08/04 21:25:23  bstreetman</span>
00167 <span class="comment">*       Now with doxygen-style comments</span>
00168 <span class="comment">*       </span>
00169 <span class="comment">*       Revision 1.18  2003/08/01 20:21:20  bstreetman</span>
00170 <span class="comment">*       Cleaned and streamlined all code. Reduced warning and outputs. CMG and Momentum Wheels now no longer accept a global integer in initialization.  The file descriptor is now set and held internally.</span>
00171 <span class="comment">*       </span>
00172 <span class="comment">*       Revision 1.17  2003/07/28 17:54:00  bstreetman</span>
00173 <span class="comment">*       Change some pass-by-reference to pass-by-value</span>
00174 <span class="comment">*       </span>
00175 <span class="comment">*       Revision 1.16  2003/07/21 20:15:30  bstreetman</span>
00176 <span class="comment">*       Updates</span>
00177 <span class="comment">*       </span>
00178 <span class="comment">*       Revision 1.15  2003/07/09 20:24:33  cskelton</span>
00179 <span class="comment">*       Corrected Initialization and Deconstruction</span>
00180 <span class="comment">*       </span>
00181 <span class="comment">*       Revision 1.14  2003/07/08 21:32:26  cskelton</span>
00182 <span class="comment">*       Added functionality, initialization fixed, command torque works</span>
00183 <span class="comment">*       </span>
00184 <span class="comment">*       Revision 1.13  2003/07/07 19:34:08  cskelton</span>
00185 <span class="comment">*       Removed virtual from functions</span>
00186 <span class="comment">*       </span>
00187 <span class="comment">*       Revision 1.12  2003/07/04 16:02:00  nicmcp</span>
00188 <span class="comment">*       Added the AxialInertia from PhysicalMomentumwheel.h</span>
00189 <span class="comment">*       </span>
00190 <span class="comment">*       Revision 1.11  2003/07/04 15:54:51  simpliciter</span>
00191 <span class="comment">*       Fixed capitalization.</span>
00192 <span class="comment">*       </span>
00193 <span class="comment">*       Revision 1.10  2003/07/03 19:47:49  nicmcp</span>
00194 <span class="comment">*       Added an instance counter</span>
00195 <span class="comment">*       </span>
00196 <span class="comment">*       Revision 1.9  2003/07/02 22:02:12  bstreetman</span>
00197 <span class="comment">*       Improve functionality and made to work with the c hardware code.</span>
00198 <span class="comment">*       </span>
00199 <span class="comment">*       Revision 1.8  2003/07/01 20:54:18  bstreetman</span>
00200 <span class="comment">*       Fixed Small #include problem</span>
00201 <span class="comment">*       </span>
00202 <span class="comment">*       Revision 1.7  2003/07/01 19:56:09  cskelton</span>
00203 <span class="comment">*       Added Hardware software support</span>
00204 <span class="comment">*       </span>
00205 <span class="comment">*       Revision 1.6  2003/07/01 19:19:43  cskelton</span>
00206 <span class="comment">*       Debugged to compile</span>
00207 <span class="comment">*       </span>
00208 <span class="comment">*       Revision 1.5  2003/06/30 17:22:20  cskelton</span>
00209 <span class="comment">*       Updated functions and herader file</span>
00210 <span class="comment">*       </span>
00211 <span class="comment">*       Revision 1.3  2003/06/30 15:34:23  cskelton</span>
00212 <span class="comment">*       Added PMW member</span>
00213 <span class="comment">*       </span>
00214 <span class="comment">*       Revision 1.2  2003/06/19 21:29:58  simpliciter</span>
00215 <span class="comment">*       Updated from Andy's generic layout.</span>
00216 <span class="comment">*       </span>
00217 <span class="comment">*       Revision 1.1  2003/06/13 15:24:33  simpliciter</span>
00218 <span class="comment">*       Initial submission.</span>
00219 <span class="comment">*       </span>
00220 <span class="comment">*</span>
00221 <span class="comment">******************************************************************************/</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Tue Jun 15 11:49:54 2004 for DSACSS Operational Code by
<a href="javascript:if(confirm('http://www.doxygen.org/index.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.doxygen.org/index.html'" tppabs="http://www.doxygen.org/index.html">
<img src="doxygen.png" tppabs="http://dsacss.sourceforge.net/doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.4 </small></address>
</body>
</html>
