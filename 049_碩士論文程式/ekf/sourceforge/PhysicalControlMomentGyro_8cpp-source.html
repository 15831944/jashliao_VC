<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>DSACSS Operational Code: PhysicalControlMomentGyro.cpp Source File</title>
<link href="doxygen.css" tppabs="http://dsacss.sourceforge.net/doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.4 -->
<h1>PhysicalControlMomentGyro.cpp</h1><a href="PhysicalControlMomentGyro_8cpp.html" tppabs="http://dsacss.sourceforge.net/PhysicalControlMomentGyro_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 
00002 
00008 
00010 
00011 
00012 
00013 <span class="preprocessor">#include "<a class="code" href="PhysicalControlMomentGyro_8h.html" tppabs="http://dsacss.sourceforge.net/PhysicalControlMomentGyro_8h.html">PhysicalControlMomentGyro.h</a>"</span>
00014 <span class="preprocessor">#include &lt;fstream&gt;</span>
00015 
<a name="l00016"></a><a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">00016</a> <span class="keywordtype">int</span> <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">PhysicalControlMomentGyro::m_fd</a> = -1;
00018 <span class="comment">// Construction/Destruction</span>
00020 <span class="comment"></span>
00021 
<a name="l00022"></a><a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa0">00022</a> <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa0">PhysicalControlMomentGyro::PhysicalControlMomentGyro</a>()
00023 {
00024 }
00025 
<a name="l00026"></a><a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa1" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa1">00026</a> <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa1" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa1">PhysicalControlMomentGyro::~PhysicalControlMomentGyro</a>()
00027 {
00028         <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa6" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa6">Stop</a>();
00029 }
00030 
00031 
00033 <span class="comment">// Facilitators</span>
00035 <span class="comment"></span>
00036 
<a name="l00037"></a><a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa2" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa2">00037</a> <span class="keywordtype">void</span> <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa2" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa2">PhysicalControlMomentGyro::CommandWheelSpeed</a>(<span class="keywordtype">double</span> wheelOmega)
00038 {
00039         wheelOmega = wheelOmega*64425.156/2/3.15159265359; <span class="comment">//64425.156 cts/s / rps * 1 rps/ 2pi rad/s</span>
00040 
00041         wheelOmega = round(wheelOmega); <span class="comment">// motor accepts only integer velocities</span>
00042 
00043         <span class="keyword">static</span> <span class="keywordtype">char</span> *speedCommand = <span class="keyword">new</span> <span class="keywordtype">char</span>[80];
00044         sprintf(speedCommand, <span class="stringliteral">"%cV%d\n"</span>, <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror8" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror8">m_WheelAddress</a>, wheelOmega);
00045         <a class="code" href="common_8c.html#a1" tppabs="http://dsacss.sourceforge.net/common_8c.html#a1">say</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, speedCommand);
00046 
00047         <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrod0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrod0">GoCommand</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror8" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror8">m_WheelAddress</a>);
00048 
00049 }
00050 
00051 
00052 
<a name="l00053"></a><a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa3" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa3">00053</a> <span class="keywordtype">void</span> <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa3" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa3">PhysicalControlMomentGyro::CommandWheelTorque</a>(<span class="keywordtype">double</span> wheelTorque)
00054 {
00055         
00056         <span class="comment">//Torque input a double in n-m  </span>
00057         wheelTorque = wheelTorque/0.0018;
00058         wheelTorque = floor(wheelTorque);
00059         <span class="keywordtype">int</span> torque;
00060         torque = (<span class="keywordtype">int</span>) wheelTorque;
00061         <span class="keyword">static</span> <span class="keywordtype">char</span> *torqueCommand = <span class="keyword">new</span> <span class="keywordtype">char</span>[80];
00062 
00063         sprintf(torqueCommand, <span class="stringliteral">"%cMT\n\n"</span>, <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror8" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror8">m_WheelAddress</a>);
00064         <a class="code" href="common_8c.html#a1" tppabs="http://dsacss.sourceforge.net/common_8c.html#a1">say</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, torqueCommand);
00065         
00066         sprintf(torqueCommand, <span class="stringliteral">"%cT%d\n\n"</span>, <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror8" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror8">m_WheelAddress</a>, torque);
00067         <a class="code" href="common_8c.html#a1" tppabs="http://dsacss.sourceforge.net/common_8c.html#a1">say</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, torqueCommand);
00068 
00069         <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror1" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror1">m_CurrentWheelTorque</a> = wheelTorque;
00070 }
00071 
00072 
<a name="l00073"></a><a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa4" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa4">00073</a> <span class="keywordtype">void</span> <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa4" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa4">PhysicalControlMomentGyro::CommandAngle</a>(<span class="keywordtype">double</span> wheelAngle)
00074 {
00075         <span class="comment">// wheelAngle should be radians</span>
00076         <span class="comment">// Angles measured as a change from the mid-point of the cmg's rotation limits</span>
00077         
00078         wheelAngle = wheelAngle/0.000010224; <span class="comment">// 1.0224e-5 rad/ct</span>
00079         wheelAngle = round(wheelAngle);
00080         
00081         <span class="keywordtype">int</span> DesiredLAPosition;
00082 
00083         DesiredLAPosition = <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror7" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror7">m_LAMid</a> + (<span class="keywordtype">int</span>)wheelAngle;
00084 
00085         <span class="keywordflow">if</span> (DesiredLAPosition &gt; <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror5" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror5">m_LAMax</a>){
00086                 DesiredLAPosition = <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror5" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror5">m_LAMax</a>;
00087         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (DesiredLAPosition &lt; <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror6" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror6">m_LAMin</a>){
00088                 DesiredLAPosition = <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror6" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror6">m_LAMin</a>;
00089         }
00090         
00091         <span class="keyword">static</span> <span class="keywordtype">char</span> *AngleCommand = <span class="keyword">new</span> <span class="keywordtype">char</span>[80];
00092         sprintf(AngleCommand, <span class="stringliteral">"%cP%d\n\n"</span>, <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror9" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror9">m_LAAddress</a>, DesiredLAPosition);
00093 
00094         <a class="code" href="common_8c.html#a1" tppabs="http://dsacss.sourceforge.net/common_8c.html#a1">say</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, AngleCommand);
00095         <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrod0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrod0">GoCommand</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror9" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror9">m_LAAddress</a>);
00096         
00097         <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror2" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror2">m_CurrentAngle</a> = DesiredLAPosition*0.000010224;
00098 }
00099 
<a name="l00100"></a><a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa5" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa5">00100</a> <span class="keywordtype">void</span> <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa5" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa5">PhysicalControlMomentGyro::CommandGimbalRate</a>(<span class="keywordtype">double</span> gimbalRate)
00101 {
00102         <span class="comment">//gimbal rate in rad/sec</span>
00103         gimbalRate = gimbalRate * 1.0/0.000010224 * 1.0/2000.0 * 32212.578; <span class="comment">// 1 rad/s(in gimbal axis) * 1 pos ct/1.0224e-5 rad (linear axis)* 1 rev/2000 ct (la motor speed)* 32212.578 scaled ct/ 1 rev/s</span>
00104         gimbalRate = round(gimbalRate);
00105         
00106         <span class="keyword">static</span> <span class="keywordtype">char</span> *GimbalCommand = <span class="keyword">new</span> <span class="keywordtype">char</span>[80];
00107         sprintf(GimbalCommand, <span class="stringliteral">"%cV%f\n\n"</span>, <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror9" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror9">m_LAAddress</a>, gimbalRate);
00108         
00109         <a class="code" href="common_8c.html#a1" tppabs="http://dsacss.sourceforge.net/common_8c.html#a1">say</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, GimbalCommand);
00110         <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrod0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrod0">GoCommand</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror9" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror9">m_LAAddress</a>);
00111 }
00112 
00113 
<a name="l00114"></a><a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa6" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa6">00114</a> <span class="keywordtype">int</span> <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa6" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa6">PhysicalControlMomentGyro::Stop</a>()
00115 {
00116         <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa2" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa2">CommandWheelSpeed</a>(0.0);
00117         <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa3" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa3">CommandWheelTorque</a>(0.0);
00118         <span class="keywordflow">return</span> 0;
00119 }
00120 
00121 
<a name="l00122"></a><a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa7" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa7">00122</a> <span class="keywordtype">int</span> <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa7" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa7">PhysicalControlMomentGyro::Initialize</a>()
00123 {
00124 
00125         <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror8" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror8">m_WheelAddress</a> = 130;
00126         <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror9" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror9">m_LAAddress</a> = 129;
00127 
00128         
00129         <span class="keywordtype">char</span> *stringPort;
00130         stringPort = (<span class="keywordtype">char</span> *)malloc(80);
00131         
00132         cout &lt;&lt; <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror10" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror10">m_DaisyChainPort</a> &lt;&lt; endl;
00133         <span class="keywordflow">if</span> (<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a> &lt; 0) { <span class="comment">// g_fd has NOT been set yet, then init the daisychain</span>
00134           sprintf(stringPort,<span class="stringliteral">"/dev/tty%s"</span>,<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror10" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror10">m_DaisyChainPort</a>.c_str());
00135 
00136           <a class="code" href="common_8c.html#a0" tppabs="http://dsacss.sourceforge.net/common_8c.html#a0">init_serial</a>(stringPort,B9600,&amp;<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>);  
00137 
00138           cout &lt;&lt; stringPort &lt;&lt; endl;
00139         
00140           <span class="keywordtype">char</span> *testCommand;
00141           testCommand = <span class="keyword">new</span> <span class="keywordtype">char</span>[80];
00142         
00143           sprintf(testCommand, <span class="stringliteral">"%c%s\x0D"</span>, 0x80, <span class="stringliteral">"Z"</span>);
00144           <a class="code" href="common_8c.html#a1" tppabs="http://dsacss.sourceforge.net/common_8c.html#a1">say</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, testCommand); 
00145           usleep(500000);
00146         
00147           sprintf(testCommand, <span class="stringliteral">"%c%s\x0D"</span>, 0x80, <span class="stringliteral">"SADDR1"</span>);
00148           <a class="code" href="common_8c.html#a1" tppabs="http://dsacss.sourceforge.net/common_8c.html#a1">say</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, testCommand); 
00149                 
00150           usleep(500000);
00151           sprintf(testCommand, <span class="stringliteral">"%c%s\x0D"</span>, 0x81, <span class="stringliteral">"ECHO"</span>);
00152           <a class="code" href="common_8c.html#a1" tppabs="http://dsacss.sourceforge.net/common_8c.html#a1">say</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, testCommand); 
00153           usleep(500000);
00154 
00155           sprintf(testCommand, <span class="stringliteral">"%c%s\x0D"</span>, 0x81, <span class="stringliteral">"SLEEP"</span>);
00156           <a class="code" href="common_8c.html#a1" tppabs="http://dsacss.sourceforge.net/common_8c.html#a1">say</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, testCommand); 
00157           usleep(500000);
00158 
00159           sprintf(testCommand, <span class="stringliteral">"%c%s\x0D"</span>, 0x80, <span class="stringliteral">"SADDR2"</span>);
00160           <a class="code" href="common_8c.html#a1" tppabs="http://dsacss.sourceforge.net/common_8c.html#a1">say</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, testCommand); 
00161           usleep(500000);
00162 
00163           sprintf(testCommand, <span class="stringliteral">"%c%s\x0D"</span>, 0x82, <span class="stringliteral">"ECHO"</span>);
00164           <a class="code" href="common_8c.html#a1" tppabs="http://dsacss.sourceforge.net/common_8c.html#a1">say</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, testCommand); 
00165           usleep(500000);
00166 
00167           sprintf(testCommand, <span class="stringliteral">"%c%s\x0D"</span>, 0x81, <span class="stringliteral">"WAKE"</span>);
00168           <a class="code" href="common_8c.html#a1" tppabs="http://dsacss.sourceforge.net/common_8c.html#a1">say</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, testCommand); 
00169           usleep(500000);
00170          
00171           
00172           <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrod1" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrod1">FindLimits</a>();
00173 
00174           sleep(3);
00175 
00176           <span class="comment">//Set slower LA speed for actual travel</span>
00177           sprintf(testCommand, <span class="stringliteral">"%c%s\x0D"</span>, 0x81, <span class="stringliteral">"V50000"</span>);
00178           <a class="code" href="common_8c.html#a1" tppabs="http://dsacss.sourceforge.net/common_8c.html#a1">say</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, testCommand);
00179           usleep(500000);
00180           
00181           <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrod0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrod0">GoCommand</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror9" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror9">m_LAAddress</a>);
00182 
00183 
00184           <span class="comment">//Set up Wheel</span>
00185 
00186           sprintf(testCommand, <span class="stringliteral">"%c%s\x0D"</span>, 0x82, <span class="stringliteral">"MV"</span>);
00187           <a class="code" href="common_8c.html#a1" tppabs="http://dsacss.sourceforge.net/common_8c.html#a1">say</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, testCommand); 
00188           usleep(500000);
00189           
00190           sprintf(testCommand, <span class="stringliteral">"%c%s\x0D"</span>, 0x82, <span class="stringliteral">"KI0"</span>);
00191           <a class="code" href="common_8c.html#a1" tppabs="http://dsacss.sourceforge.net/common_8c.html#a1">say</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, testCommand); 
00192           usleep(500000);
00193           
00194           sprintf(testCommand, <span class="stringliteral">"%c%s\x0D"</span>, 0x82, <span class="stringliteral">"KP50"</span>);
00195           <a class="code" href="common_8c.html#a1" tppabs="http://dsacss.sourceforge.net/common_8c.html#a1">say</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, testCommand); 
00196           usleep(500000);
00197           
00198           sprintf(testCommand, <span class="stringliteral">"%c%s\x0D"</span>, 0x82, <span class="stringliteral">"KD50"</span>);
00199           <a class="code" href="common_8c.html#a1" tppabs="http://dsacss.sourceforge.net/common_8c.html#a1">say</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, testCommand); 
00200           usleep(500000);
00201           
00202           sprintf(testCommand, <span class="stringliteral">"%c%s\x0D"</span>, 0x82, <span class="stringliteral">"KL200"</span>);
00203           <a class="code" href="common_8c.html#a1" tppabs="http://dsacss.sourceforge.net/common_8c.html#a1">say</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, testCommand); 
00204           usleep(500000);
00205           
00206           sprintf(testCommand, <span class="stringliteral">"%c%s\x0D"</span>, 0x82, <span class="stringliteral">"F"</span>);
00207           <a class="code" href="common_8c.html#a1" tppabs="http://dsacss.sourceforge.net/common_8c.html#a1">say</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, testCommand); 
00208           usleep(500000);
00209           
00210           sprintf(testCommand, <span class="stringliteral">"%c%s\x0D"</span>, 0x82, <span class="stringliteral">"V1830000"</span>);
00211           <a class="code" href="common_8c.html#a1" tppabs="http://dsacss.sourceforge.net/common_8c.html#a1">say</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, testCommand); 
00212           usleep(500000);
00213           
00214           sprintf(testCommand, <span class="stringliteral">"%c%s\x0D"</span>, 0x82, <span class="stringliteral">"A25"</span>);
00215           <a class="code" href="common_8c.html#a1" tppabs="http://dsacss.sourceforge.net/common_8c.html#a1">say</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, testCommand); 
00216           usleep(500000);
00217           
00218           <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrod0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrod0">GoCommand</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror8" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror8">m_WheelAddress</a>);
00219                 
00220 <span class="comment">/*        sprintf(testCommand, "%c%s\x0D", 0x82, "V1700000");</span>
00221 <span class="comment">          say(m_fd, testCommand); </span>
00222 <span class="comment">          usleep(500000);</span>
00223 <span class="comment">          </span>
00224 <span class="comment">          GoCommand(m_WheelAddress);</span>
00225 <span class="comment"></span>
00226 <span class="comment">          sleep(15);</span>
00227 <span class="comment">*/</span>        
00228           cout &lt;&lt; <span class="stringliteral">"\nCMG Initialized"</span> &lt;&lt; endl;
00229           
00230         }
00231         <span class="keywordflow">return</span> 0;
00232 }
00233 
00234 
<a name="l00235"></a><a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa8" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa8">00235</a> <span class="keywordtype">int</span> <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa8" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa8">PhysicalControlMomentGyro::Deinitialize</a>()
00236 {
00237         close(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>);
00238         <span class="keywordflow">return</span> 0;
00239 }
00240 
00241 
00242 
00244 <span class="comment">// Mutators</span>
00246 <span class="comment"></span>
00247 
<a name="l00248"></a><a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa9" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa9">00248</a> <span class="keywordtype">void</span> <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa9" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa9">PhysicalControlMomentGyro::SetWheelSpeedLimits</a>(<span class="keywordtype">double</span> minWheelSpeed, <span class="keywordtype">double</span> maxWheelSpeed)
00249 {
00250         <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror13" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror13">m_MinWheelSpeed</a> = minWheelSpeed;
00251         <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror12" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror12">m_MaxWheelSpeed</a> = maxWheelSpeed;
00252 }
00253 
00254 
<a name="l00255"></a><a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa10" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa10">00255</a> <span class="keywordtype">void</span> <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa10" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa10">PhysicalControlMomentGyro::SetWheelTorqueLimits</a>(<span class="keywordtype">double</span> minWheelTorque,<span class="keywordtype">double</span> maxWheelTorque)
00256 {
00257         <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror15" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror15">m_MinWheelTorque</a> = minWheelTorque;
00258         <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror14" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror14">m_MaxWheelTorque</a> = maxWheelTorque;
00259 }
00260 
00261 
<a name="l00262"></a><a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa11" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa11">00262</a> <span class="keywordtype">void</span> <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa11" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa11">PhysicalControlMomentGyro::SetMaxTorqueStep</a>(<span class="keywordtype">double</span> maxTorqueStep)
00263 {
00264         <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror16" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror16">m_MaxTorqueStep</a> = maxTorqueStep;
00265 }
00266 
<a name="l00267"></a><a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa12" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa12">00267</a> <span class="keywordtype">void</span> <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa12" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa12">PhysicalControlMomentGyro::SetDaisyChainNumber</a>(<span class="keywordtype">int</span> DaisyChainNumber)
00268 {
00269         <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror11" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror11">m_DaisyChainNumber</a> = DaisyChainNumber;
00270 }
00271 
<a name="l00272"></a><a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa13" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa13">00272</a> <span class="keywordtype">void</span> <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa13" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa13">PhysicalControlMomentGyro::SetDaisyChainPort</a>(string Port)
00273 {
00274         <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror10" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror10">m_DaisyChainPort</a> = Port;
00275 }
00277 <span class="comment">// Inspectors</span>
00279 <span class="comment"></span>
00280 
<a name="l00281"></a><a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa14" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa14">00281</a> <span class="keywordtype">double</span> <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa14" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa14">PhysicalControlMomentGyro::QueryWheelSpeed</a>()
00282 {
00283         <span class="comment">//clear serial port buffer</span>
00284         <span class="keywordtype">char</span>* clear = <span class="keyword">new</span> <span class="keywordtype">char</span>[80];
00285         <span class="keywordflow">while</span>( !<a class="code" href="common_8c.html#a2" tppabs="http://dsacss.sourceforge.net/common_8c.html#a2">hear</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, clear, 79, 0, 10000, <span class="charliteral">'c'</span>));
00286         
00287         
00288         <span class="comment">//begin commanding and reading</span>
00289         <span class="keywordtype">int</span> pos1 = 0;
00290         <span class="keywordtype">int</span> pos2 = 0;
00291         <span class="keyword">struct </span>timeval *time1 = <span class="keyword">new</span> <span class="keyword">struct </span>timeval;
00292         <span class="keyword">struct </span>timeval *time2 = <span class="keyword">new</span> <span class="keyword">struct </span>timeval;
00293         <span class="keywordtype">int</span> dt;
00294         <span class="keywordtype">char</span> *posString = <span class="keyword">new</span> <span class="keywordtype">char</span>[80];
00295         <span class="keywordtype">double</span> velocity;
00296         <span class="keywordtype">int</span> readdelay =10000;
00297         
00298         
00299         <span class="keywordtype">char</span> *RPCommand = <span class="keyword">new</span> <span class="keywordtype">char</span>[80];
00300         sprintf(RPCommand, <span class="stringliteral">"%cRP\n"</span>, <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror8" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror8">m_WheelAddress</a>);
00301         <a class="code" href="common_8c.html#a1" tppabs="http://dsacss.sourceforge.net/common_8c.html#a1">say</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, RPCommand);
00302         
00303         usleep(10000);  
00304         
00305         <a class="code" href="common_8c.html#a2" tppabs="http://dsacss.sourceforge.net/common_8c.html#a2">hear</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, posString, 79, 0, 1000000, <span class="charliteral">'\n'</span>);
00306 
00307         <a class="code" href="common_8c.html#a2" tppabs="http://dsacss.sourceforge.net/common_8c.html#a2">hear</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, posString, 79, 0, 1000000, <span class="charliteral">'\r'</span>);
00308 
00309         pos1 = atoi(posString);
00310         
00311         gettimeofday(time1,NULL);
00312         
00313         usleep(readdelay);
00314         
00315         <span class="comment">//position2</span>
00316         <a class="code" href="common_8c.html#a1" tppabs="http://dsacss.sourceforge.net/common_8c.html#a1">say</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, RPCommand);
00317         
00318         usleep(10000);  
00319         
00320         <a class="code" href="common_8c.html#a2" tppabs="http://dsacss.sourceforge.net/common_8c.html#a2">hear</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, posString, 15, 0, 1000000, <span class="charliteral">'\n'</span>);
00321         
00322         <a class="code" href="common_8c.html#a2" tppabs="http://dsacss.sourceforge.net/common_8c.html#a2">hear</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, posString, 79, 0, 1000000, <span class="charliteral">'\r'</span>);
00323         
00324         pos2 = atoi(posString);
00325 
00326         gettimeofday(time2,NULL);
00327         
00328         <span class="keyword">delete</span> RPCommand;
00329         <span class="keyword">delete</span> posString;
00330         
00331         
00332         dt = time2-&gt;tv_usec - time1-&gt;tv_usec;
00333         
00334         <span class="keywordflow">if</span> (dt&lt;0) { 
00335                 dt = 1000000 + dt;
00336         }
00337 
00338         velocity = ((pos2 - pos1)/((<span class="keywordtype">double</span>) dt))*2*3.14159*250.0;<span class="comment">// rad/sec -&gt; 2pi rad/4000 ct * 1000000 usec/sec</span>
00339         
00340         
00341         <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror0">m_CurrentWheelSpeed</a> = velocity;
00342         <span class="keywordflow">return</span> <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror0">m_CurrentWheelSpeed</a>;
00343 }
00344     
00345 
<a name="l00346"></a><a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa15" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa15">00346</a> <span class="keywordtype">double</span> <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa15" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa15">PhysicalControlMomentGyro::QueryWheelTorque</a>()
00347 {
00348         
00349         <span class="comment">//clear serial port buffer</span>
00350         <span class="keywordtype">char</span>* clear = <span class="keyword">new</span> <span class="keywordtype">char</span>[80];
00351         <span class="keywordflow">while</span>( !<a class="code" href="common_8c.html#a2" tppabs="http://dsacss.sourceforge.net/common_8c.html#a2">hear</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, clear, 79, 0, 10000, <span class="charliteral">'c'</span>));
00352         
00353         <span class="comment">//Send command  </span>
00354         <span class="keyword">static</span> <span class="keywordtype">char</span> *RTCommand = <span class="keyword">new</span> <span class="keywordtype">char</span>[80];
00355         sprintf(RTCommand, <span class="stringliteral">"%cRT\n\n"</span>, <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror8" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror8">m_WheelAddress</a>);
00356         <a class="code" href="common_8c.html#a1" tppabs="http://dsacss.sourceforge.net/common_8c.html#a1">say</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, RTCommand);
00357         
00358         <span class="keyword">static</span> <span class="keywordtype">char</span> *torqueString = <span class="keyword">new</span> <span class="keywordtype">char</span>[80];
00359         <a class="code" href="common_8c.html#a2" tppabs="http://dsacss.sourceforge.net/common_8c.html#a2">hear</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, torqueString, 20, 0, 1000000, <span class="charliteral">'\n'</span>);
00360         
00361         <a class="code" href="common_8c.html#a2" tppabs="http://dsacss.sourceforge.net/common_8c.html#a2">hear</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, torqueString, 20, 0, 1000000, <span class="charliteral">'\r'</span>);
00362 
00363         <span class="keywordtype">double</span> Wtorque = atoi(torqueString) * 0.0018;<span class="comment">//0.018 N-m per machine torque unit</span>
00364         
00365         <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror1" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror1">m_CurrentWheelTorque</a> = Wtorque;
00366         
00367         
00368         <span class="keywordflow">return</span> <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror1" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror1">m_CurrentWheelTorque</a>;
00369 }
00370 
00371 
<a name="l00372"></a><a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa16" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa16">00372</a> <span class="keywordtype">double</span> <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa16" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa16">PhysicalControlMomentGyro::QueryAngle</a>()
00373 {
00374         <span class="comment">//clear serial port buffer</span>
00375         <span class="keywordtype">char</span>* clear = <span class="keyword">new</span> <span class="keywordtype">char</span>[80];
00376         <span class="keywordflow">while</span>( !<a class="code" href="common_8c.html#a2" tppabs="http://dsacss.sourceforge.net/common_8c.html#a2">hear</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, clear, 79, 0, 10000, <span class="charliteral">'c'</span>));
00377 
00378         <span class="comment">//send command</span>
00379         <span class="keyword">static</span> <span class="keywordtype">char</span> *RPCommand = <span class="keyword">new</span> <span class="keywordtype">char</span>[80];
00380         sprintf(RPCommand, <span class="stringliteral">"%cRP\n\n"</span>, <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror9" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror9">m_LAAddress</a>);
00381         <a class="code" href="common_8c.html#a1" tppabs="http://dsacss.sourceforge.net/common_8c.html#a1">say</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, RPCommand);
00382 
00383         <span class="keyword">static</span> <span class="keywordtype">char</span> *posString = <span class="keyword">new</span> <span class="keywordtype">char</span>[80];
00384         <a class="code" href="common_8c.html#a2" tppabs="http://dsacss.sourceforge.net/common_8c.html#a2">hear</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, posString, 15, 0, 1000000, <span class="charliteral">'\n'</span>);
00385 
00386         <a class="code" href="common_8c.html#a2" tppabs="http://dsacss.sourceforge.net/common_8c.html#a2">hear</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, posString, 79, 0, 1000000, <span class="charliteral">'\r'</span>);
00387 
00388         <span class="keywordtype">int</span> LAPosition = atoi(posString);
00389 
00390         <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror2" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror2">m_CurrentAngle</a> = (LAPosition - <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror7" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror7">m_LAMid</a>)*0.000010224;<span class="comment">//1.0224e-5 rad/ct</span>
00391 
00392         <span class="keywordflow">return</span> <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror2" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror2">m_CurrentAngle</a>;
00393         
00394 }
00395 
00396 
<a name="l00397"></a><a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa17" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa17">00397</a> <span class="keywordtype">void</span> <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa17" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa17">PhysicalControlMomentGyro::GetWheelSpeedLimits</a>(<span class="keywordtype">double</span>&amp; minWheelSpeed, <span class="keywordtype">double</span>&amp; maxWheelSpeed)
00398 {
00399         minWheelSpeed = <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror13" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror13">m_MinWheelSpeed</a>;
00400         maxWheelSpeed = <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror12" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror12">m_MaxWheelSpeed</a>;
00401 }
00402 
00403 
<a name="l00404"></a><a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa18" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa18">00404</a> <span class="keywordtype">void</span> <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa18" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa18">PhysicalControlMomentGyro::GetWheelTorqueLimits</a>(<span class="keywordtype">double</span>&amp; minWheelTorque, <span class="keywordtype">double</span>&amp; maxWheelTorque)
00405 {
00406         minWheelTorque = <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror15" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror15">m_MinWheelTorque</a>;
00407         maxWheelTorque = <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror14" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror14">m_MaxWheelTorque</a>;
00408 }
00409 
00410 
<a name="l00411"></a><a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa19" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa19">00411</a> <span class="keywordtype">void</span> <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa19" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyroa19">PhysicalControlMomentGyro::GetMaxTorqueStep</a>(<span class="keywordtype">double</span>&amp; maxTorqueStep)
00412 {
00413         maxTorqueStep = <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror16" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror16">m_MaxTorqueStep</a>;
00414 }
00415 
00416 
<a name="l00417"></a><a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrod0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrod0">00417</a> <span class="keywordtype">void</span> <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrod0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrod0">PhysicalControlMomentGyro::GoCommand</a>(<span class="keywordtype">int</span> Address)
00418 {
00419         <span class="comment">// generic command G</span>
00420         <span class="comment">// input either wheel address or la address</span>
00421         <span class="keyword">static</span> <span class="keywordtype">char</span> *GoString = <span class="keyword">new</span> <span class="keywordtype">char</span>[80];
00422         sprintf(GoString, <span class="stringliteral">"%cG\n"</span>, Address);
00423         <a class="code" href="common_8c.html#a1" tppabs="http://dsacss.sourceforge.net/common_8c.html#a1">say</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, GoString);
00424 }
00425 
00426 
<a name="l00427"></a><a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrod1" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrod1">00427</a> <span class="keywordtype">void</span> <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrod1" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrod1">PhysicalControlMomentGyro::FindLimits</a>()
00428 {
00429           <span class="comment">//Setup LA</span>
00430           <span class="keywordtype">char</span> *testCommand = <span class="keyword">new</span> <span class="keywordtype">char</span>[80];
00431         
00432           sprintf(testCommand, <span class="stringliteral">"%c%s\x0D"</span>, 0x81, <span class="stringliteral">"MP"</span>);
00433           <a class="code" href="common_8c.html#a1" tppabs="http://dsacss.sourceforge.net/common_8c.html#a1">say</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, testCommand); 
00434           usleep(500000);
00435           
00436           sprintf(testCommand, <span class="stringliteral">"%c%s\x0D"</span>, 0x81, <span class="stringliteral">"F1"</span>);
00437           <a class="code" href="common_8c.html#a1" tppabs="http://dsacss.sourceforge.net/common_8c.html#a1">say</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, testCommand); 
00438           usleep(500000);
00439           
00440           sprintf(testCommand, <span class="stringliteral">"%c%s\x0D"</span>, 0x81, <span class="stringliteral">"V500000"</span>);
00441           <a class="code" href="common_8c.html#a1" tppabs="http://dsacss.sourceforge.net/common_8c.html#a1">say</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, testCommand); 
00442           usleep(500000);
00443           
00444           sprintf(testCommand, <span class="stringliteral">"%c%s\x0D"</span>, 0x81, <span class="stringliteral">"A1000"</span>);
00445           <a class="code" href="common_8c.html#a1" tppabs="http://dsacss.sourceforge.net/common_8c.html#a1">say</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, testCommand);
00446           usleep(500000);
00447 
00448           <span class="comment">//find limits</span>
00449         <span class="comment">//clear serial port buffer</span>
00450         <span class="keywordtype">char</span>* clear = <span class="keyword">new</span> <span class="keywordtype">char</span>[80];
00451         <span class="keywordflow">while</span>( !<a class="code" href="common_8c.html#a2" tppabs="http://dsacss.sourceforge.net/common_8c.html#a2">hear</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, clear, 79, 0, 10000, <span class="charliteral">'c'</span>));
00452         
00453         <span class="keywordtype">char</span>* ErrorString = <span class="keyword">new</span> <span class="keywordtype">char</span>[80];
00454         sprintf(ErrorString, <span class="stringliteral">"%cRBp\n\n"</span>, <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror9" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror9">m_LAAddress</a>);
00455         <a class="code" href="common_8c.html#a1" tppabs="http://dsacss.sourceforge.net/common_8c.html#a1">say</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, ErrorString);
00456         
00457         <a class="code" href="common_8c.html#a2" tppabs="http://dsacss.sourceforge.net/common_8c.html#a2">hear</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, ErrorString, 79, 0, 1000000, <span class="charliteral">'\n'</span>);
00458         
00459         <a class="code" href="common_8c.html#a2" tppabs="http://dsacss.sourceforge.net/common_8c.html#a2">hear</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, ErrorString, 79, 0, 1000000, <span class="charliteral">'\r'</span>);
00460         <span class="keywordtype">int</span> PosLimit = atoi(ErrorString);
00461         
00462         <span class="keywordflow">while</span>( !<a class="code" href="common_8c.html#a2" tppabs="http://dsacss.sourceforge.net/common_8c.html#a2">hear</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, clear, 79, 0, 10000, <span class="charliteral">'c'</span>));
00463         
00464         sprintf(ErrorString, <span class="stringliteral">"%cRBm\n\n"</span>, <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror9" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror9">m_LAAddress</a>);
00465         <a class="code" href="common_8c.html#a1" tppabs="http://dsacss.sourceforge.net/common_8c.html#a1">say</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, ErrorString);
00466         
00467         <a class="code" href="common_8c.html#a2" tppabs="http://dsacss.sourceforge.net/common_8c.html#a2">hear</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, ErrorString, 79, 0, 1000000, <span class="charliteral">'\n'</span>);
00468         <a class="code" href="common_8c.html#a2" tppabs="http://dsacss.sourceforge.net/common_8c.html#a2">hear</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, ErrorString, 79, 0, 1000000, <span class="charliteral">'\r'</span>);
00469         <span class="keywordtype">int</span> NegLimit = atoi(ErrorString);
00470 
00471         <span class="keywordflow">if</span> (PosLimit){
00472                 sprintf(testCommand, <span class="stringliteral">"%cP1000000\n"</span>, <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror9" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror9">m_LAAddress</a>);
00473                 <a class="code" href="common_8c.html#a1" tppabs="http://dsacss.sourceforge.net/common_8c.html#a1">say</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, testCommand);
00474                 <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrod0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrod0">GoCommand</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror9" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror9">m_LAAddress</a>);
00475                 sleep(5);
00476                 <span class="keywordflow">while</span>( !<a class="code" href="common_8c.html#a2" tppabs="http://dsacss.sourceforge.net/common_8c.html#a2">hear</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, clear, 79, 0, 10000, <span class="charliteral">'c'</span>));
00477                 sprintf(ErrorString, <span class="stringliteral">"%cRP\n\n"</span>, <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror9" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror9">m_LAAddress</a>);
00478                 <a class="code" href="common_8c.html#a1" tppabs="http://dsacss.sourceforge.net/common_8c.html#a1">say</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, ErrorString);
00479                 usleep(10000);
00480                 
00481                 <a class="code" href="common_8c.html#a2" tppabs="http://dsacss.sourceforge.net/common_8c.html#a2">hear</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, ErrorString, 79, 0, 1000000, <span class="charliteral">'\n'</span>);
00482                 
00483                 <a class="code" href="common_8c.html#a2" tppabs="http://dsacss.sourceforge.net/common_8c.html#a2">hear</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, ErrorString, 79, 0, 1000000, <span class="charliteral">'\r'</span>);
00484                 <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror5" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror5">m_LAMax</a> = atoi(ErrorString);
00485                 <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror6" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror6">m_LAMin</a> = 0;
00486                 
00487         } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(NegLimit){
00488                 sprintf(testCommand, <span class="stringliteral">"%cP-1000000\n"</span>, <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror9" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror9">m_LAAddress</a>);
00489                 <a class="code" href="common_8c.html#a1" tppabs="http://dsacss.sourceforge.net/common_8c.html#a1">say</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, testCommand);
00490                 <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrod0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrod0">GoCommand</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror9" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror9">m_LAAddress</a>);
00491                 sleep(5);
00492                 <span class="keywordflow">while</span>( !<a class="code" href="common_8c.html#a2" tppabs="http://dsacss.sourceforge.net/common_8c.html#a2">hear</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, clear, 79, 0, 10000, <span class="charliteral">'c'</span>));
00493                 sprintf(ErrorString, <span class="stringliteral">"%cRP\n\n"</span>, <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror9" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror9">m_LAAddress</a>);
00494                 <a class="code" href="common_8c.html#a1" tppabs="http://dsacss.sourceforge.net/common_8c.html#a1">say</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, ErrorString);
00495                 
00496                 usleep(10000);
00497                 <a class="code" href="common_8c.html#a2" tppabs="http://dsacss.sourceforge.net/common_8c.html#a2">hear</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, ErrorString, 79, 0, 1000000, <span class="charliteral">'\n'</span>);
00498                 
00499                 <a class="code" href="common_8c.html#a2" tppabs="http://dsacss.sourceforge.net/common_8c.html#a2">hear</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, ErrorString, 79, 0, 1000000, <span class="charliteral">'\r'</span>);
00500                 <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror6" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror6">m_LAMin</a> = atoi(ErrorString);
00501                 <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror5" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror5">m_LAMax</a> = 0;
00502         } <span class="keywordflow">else</span> {
00503                 sprintf(testCommand, <span class="stringliteral">"%cP1000000\n"</span>, <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror9" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror9">m_LAAddress</a>);
00504                 <a class="code" href="common_8c.html#a1" tppabs="http://dsacss.sourceforge.net/common_8c.html#a1">say</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, testCommand);
00505                 <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrod0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrod0">GoCommand</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror9" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror9">m_LAAddress</a>);
00506                 sleep(5);
00507                 <span class="keywordflow">while</span>( !<a class="code" href="common_8c.html#a2" tppabs="http://dsacss.sourceforge.net/common_8c.html#a2">hear</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, clear, 79, 0, 10000, <span class="charliteral">'c'</span>));
00508                 sprintf(ErrorString, <span class="stringliteral">"%cRP\n\n"</span>, <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror9" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror9">m_LAAddress</a>);
00509                 <a class="code" href="common_8c.html#a1" tppabs="http://dsacss.sourceforge.net/common_8c.html#a1">say</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, ErrorString);
00510                 usleep(10000);
00511                 
00512                 <a class="code" href="common_8c.html#a2" tppabs="http://dsacss.sourceforge.net/common_8c.html#a2">hear</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, ErrorString, 79, 0, 1000000, <span class="charliteral">'\n'</span>);
00513                 <a class="code" href="common_8c.html#a2" tppabs="http://dsacss.sourceforge.net/common_8c.html#a2">hear</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, ErrorString, 79, 0, 1000000, <span class="charliteral">'\r'</span>);
00514                 <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror5" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror5">m_LAMax</a> = atoi(ErrorString);
00515                 sprintf(testCommand, <span class="stringliteral">"%cP-1000000\n"</span>, <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror9" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror9">m_LAAddress</a>);
00516                 <a class="code" href="common_8c.html#a1" tppabs="http://dsacss.sourceforge.net/common_8c.html#a1">say</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, testCommand);
00517                 <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrod0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrod0">GoCommand</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror9" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror9">m_LAAddress</a>);
00518                 sleep(7);
00519                 <span class="keywordflow">while</span>( !<a class="code" href="common_8c.html#a2" tppabs="http://dsacss.sourceforge.net/common_8c.html#a2">hear</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, clear, 79, 0, 10000, <span class="charliteral">'c'</span>));
00520                 sprintf(ErrorString, <span class="stringliteral">"%cRP\n\n"</span>, <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror9" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror9">m_LAAddress</a>);
00521                 <a class="code" href="common_8c.html#a1" tppabs="http://dsacss.sourceforge.net/common_8c.html#a1">say</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, ErrorString);
00522                 usleep(10000);
00523                 
00524                 <a class="code" href="common_8c.html#a2" tppabs="http://dsacss.sourceforge.net/common_8c.html#a2">hear</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, ErrorString, 79, 0, 1000000, <span class="charliteral">'\n'</span>);
00525                 <a class="code" href="common_8c.html#a2" tppabs="http://dsacss.sourceforge.net/common_8c.html#a2">hear</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, ErrorString, 79, 0, 1000000, <span class="charliteral">'\r'</span>);
00526                 <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror6" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror6">m_LAMin</a> = atoi(ErrorString);
00527         }
00528         <span class="keywordtype">double</span> LAMid = ( <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror5" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror5">m_LAMax</a> + <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror6" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror6">m_LAMin</a>)/2.0;
00529         <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror7" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror7">m_LAMid</a> = (<span class="keywordtype">int</span>)LAMid;
00530         sprintf(testCommand, <span class="stringliteral">"%cP%d"</span>, <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror9" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror9">m_LAAddress</a>, <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror7" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror7">m_LAMid</a>);
00531         <a class="code" href="common_8c.html#a1" tppabs="http://dsacss.sourceforge.net/common_8c.html#a1">say</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrov0">m_fd</a>, testCommand);
00532         <a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrod0" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyrod0">GoCommand</a>(<a class="code" href="classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror9" tppabs="http://dsacss.sourceforge.net/classPhysicalControlMomentGyro.html#PhysicalControlMomentGyror9">m_LAAddress</a>);
00533 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Tue Jun 15 11:49:54 2004 for DSACSS Operational Code by
<a href="javascript:if(confirm('http://www.doxygen.org/index.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.doxygen.org/index.html'" tppabs="http://www.doxygen.org/index.html">
<img src="doxygen.png" tppabs="http://dsacss.sourceforge.net/doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.4 </small></address>
</body>
</html>
