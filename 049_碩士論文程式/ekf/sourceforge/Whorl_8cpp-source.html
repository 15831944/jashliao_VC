<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>DSACSS Operational Code: Whorl.cpp Source File</title>
<link href="doxygen.css" tppabs="http://dsacss.sourceforge.net/doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.4 -->
<h1>Whorl.cpp</h1><a href="Whorl_8cpp.html" tppabs="http://dsacss.sourceforge.net/Whorl_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 
00002 
00008 
00010 
00011 
00012 <span class="preprocessor">#include "<a class="code" href="Whorl_8h.html" tppabs="http://dsacss.sourceforge.net/Whorl_8h.html">Whorl.h</a>"</span>
00013 
<a name="l00014"></a><a class="code" href="classWhorl.html#Whorla2" tppabs="http://dsacss.sourceforge.net/classWhorl.html#Whorla2">00014</a> <span class="keywordtype">void</span> <a class="code" href="classWhorl.html#Whorla2" tppabs="http://dsacss.sourceforge.net/classWhorl.html#Whorla2">Whorl::Initialize</a>(<a class="code" href="structcfgBody.html" tppabs="http://dsacss.sourceforge.net/structcfgBody.html">cfgBody</a> *data) {
00015 
00016         
00017         Vector tempP(9);
00018         <a class="code" href="classWhorl.html#Whorlr2" tppabs="http://dsacss.sourceforge.net/classWhorl.html#Whorlr2">m_recentParameter</a> = tempP;
00019         Vector tempS(7);
00020         <a class="code" href="classWhorl.html#Whorlr0" tppabs="http://dsacss.sourceforge.net/classWhorl.html#Whorlr0">m_recentState</a> = tempS;
00021         
00022         <span class="keywordtype">int</span> ii, jj;
00023         Vector tempMOI(6);
00024         Vector tempCGV(3);
00025         <span class="keyword">const</span> <span class="keywordtype">char</span> *paramCommands[20]={<span class="stringliteral">"MOI"</span>,<span class="stringliteral">"CGVector"</span>};
00026         Vector tempQuat(4);
00027         Vector tempW(3);
00028         <span class="keyword">const</span> <span class="keywordtype">char</span> *stateCommands[20]={<span class="stringliteral">"Quaternion"</span>, <span class="stringliteral">"OmegaBL"</span>};
00029         
00030         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; data[i].<a class="code" href="structcfgBody.html#cfgBodyo0" tppabs="http://dsacss.sourceforge.net/structcfgBody.html#cfgBodyo0">devTy</a>[0]; i++) {
00031             <span class="keywordflow">switch</span>(data[i].<a class="code" href="structcfgBody.html#cfgBodyo1" tppabs="http://dsacss.sourceforge.net/structcfgBody.html#cfgBodyo1">devTyNum</a>) {
00032                         
00033                         <span class="keywordflow">case</span> <a class="code" href="DeviceNames_8h.html#a18a11" tppabs="http://dsacss.sourceforge.net/DeviceNames_8h.html#a18a11">DMURG</a>:
00034                     <a class="code" href="classWhorl.html#Whorlr5" tppabs="http://dsacss.sourceforge.net/classWhorl.html#Whorlr5">m_rateGyros</a>[string(data[i].devNm)] = <span class="keyword">new</span> <a class="code" href="classDMURateGyro.html" tppabs="http://dsacss.sourceforge.net/classDMURateGyro.html">DMURateGyro</a>(data[i]);
00035                     <span class="keywordflow">break</span>;
00036                         
00037                         <span class="keywordflow">case</span> <a class="code" href="DeviceNames_8h.html#a18a10" tppabs="http://dsacss.sourceforge.net/DeviceNames_8h.html#a18a10">DMUACC</a>:
00038                     <a class="code" href="classWhorl.html#Whorlr6" tppabs="http://dsacss.sourceforge.net/classWhorl.html#Whorlr6">m_accelerometers</a>[string(data[i].devNm)] = <span class="keyword">new</span> <a class="code" href="classDMUAccelerometer.html" tppabs="http://dsacss.sourceforge.net/classDMUAccelerometer.html">DMUAccelerometer</a>(data[i]);
00039                     <span class="keywordflow">break</span>;
00040                         
00041                         <span class="keywordflow">case</span> <a class="code" href="DeviceNames_8h.html#a18a1" tppabs="http://dsacss.sourceforge.net/DeviceNames_8h.html#a18a1">MW</a>:
00042                     <a class="code" href="classWhorl.html#Whorlr7" tppabs="http://dsacss.sourceforge.net/classWhorl.html#Whorlr7">m_momentumWheels</a>[string(data[i].devNm)] = <span class="keyword">new</span> <a class="code" href="classMomentumWheel.html" tppabs="http://dsacss.sourceforge.net/classMomentumWheel.html">MomentumWheel</a>(data[i]);
00043                     <span class="keywordflow">break</span>;
00044                                 
00045                         <span class="keywordflow">case</span> <a class="code" href="DeviceNames_8h.html#a18a14" tppabs="http://dsacss.sourceforge.net/DeviceNames_8h.html#a18a14">PARAM</a>:
00046                         <span class="keywordflow">for</span> (ii = 0; data[i].<a class="code" href="structcfgBody.html#cfgBodyo3" tppabs="http://dsacss.sourceforge.net/structcfgBody.html#cfgBodyo3">keys</a>[ii][0];ii++){
00047                             <span class="keywordflow">switch</span>(<a class="code" href="Misc_8cpp.html#a3" tppabs="http://dsacss.sourceforge.net/Misc_8cpp.html#a3">getCmdIndex</a>(paramCommands,data[i].keys[ii])){
00048                                 <span class="keywordflow">case</span> 0:
00049                                 <span class="keywordflow">for</span> (jj=0;jj&lt;6 &amp;&amp;data[i].<a class="code" href="structcfgBody.html#cfgBodyo4" tppabs="http://dsacss.sourceforge.net/structcfgBody.html#cfgBodyo4">vals</a>[ii][jj][0];jj++)
00050                                 {tempMOI(jj+1) = atof(data[i].vals[ii][jj]);}
00051                                 <a class="code" href="classWhorl.html#Whorlr2" tppabs="http://dsacss.sourceforge.net/classWhorl.html#Whorlr2">m_recentParameter</a>(_(1,6))=tempMOI;
00052                                 <span class="keywordflow">break</span>;
00053                                 <span class="keywordflow">case</span> 1:
00054                                 <span class="keywordflow">for</span> (jj=0;jj&lt;3 &amp;&amp; data[i].vals[ii][jj][0];jj++)
00055                                 {tempCGV(jj+1) = atof(data[i].vals[ii][jj]);}
00056                                 <a class="code" href="classWhorl.html#Whorlr2" tppabs="http://dsacss.sourceforge.net/classWhorl.html#Whorlr2">m_recentParameter</a>(_(7,9))=tempCGV;
00057                                 <span class="keywordflow">break</span>;
00058                                         
00059                                 <span class="keywordflow">default</span>:
00060                                 <span class="keywordflow">break</span>;
00061                             }
00062                     }
00063                     <span class="keywordflow">break</span>;
00064                      
00065                         <span class="keywordflow">case</span> <a class="code" href="DeviceNames_8h.html#a18a15" tppabs="http://dsacss.sourceforge.net/DeviceNames_8h.html#a18a15">STATE</a>:
00066                     <span class="keywordflow">for</span>(ii = 0; data[i].<a class="code" href="structcfgBody.html#cfgBodyo3" tppabs="http://dsacss.sourceforge.net/structcfgBody.html#cfgBodyo3">keys</a>[ii][0];ii++){
00067                             <span class="keywordflow">switch</span>(<a class="code" href="Misc_8cpp.html#a3" tppabs="http://dsacss.sourceforge.net/Misc_8cpp.html#a3">getCmdIndex</a>(stateCommands,data[i].keys[ii])){
00068                                 <span class="keywordflow">case</span> 0:
00069                                 <span class="keywordflow">for</span> (jj=0;jj&lt;4 &amp;&amp;data[i].<a class="code" href="structcfgBody.html#cfgBodyo4" tppabs="http://dsacss.sourceforge.net/structcfgBody.html#cfgBodyo4">vals</a>[ii][jj][0];jj++)
00070                                 {tempQuat(jj+1) = atof(data[i].vals[ii][jj]);}
00071                                 <a class="code" href="classWhorl.html#Whorlr0" tppabs="http://dsacss.sourceforge.net/classWhorl.html#Whorlr0">m_recentState</a>(_(1,4))=tempQuat;
00072                                 <span class="keywordflow">break</span>;
00073                                 <span class="keywordflow">case</span> 1:
00074                                 <span class="keywordflow">for</span> (jj=0;jj&lt;3 &amp;&amp; data[i].vals[ii][jj][0];jj++)
00075                                 {tempW(jj+1) = atof(data[i].vals[ii][jj]);}
00076                                 <a class="code" href="classWhorl.html#Whorlr0" tppabs="http://dsacss.sourceforge.net/classWhorl.html#Whorlr0">m_recentState</a>(_(5,7))=tempW;
00077                                 <span class="keywordflow">break</span>;
00078                                 }
00079                         }
00080                     <span class="keywordflow">break</span>;
00081                         
00082                     <span class="keywordflow">case</span> <a class="code" href="DeviceNames_8h.html#a18a16" tppabs="http://dsacss.sourceforge.net/DeviceNames_8h.html#a18a16">TILT</a>:
00083                         <span class="keyword">new</span> <a class="code" href="classTiltSensor.html" tppabs="http://dsacss.sourceforge.net/classTiltSensor.html">TiltSensor</a>(data[i]);
00084                     <span class="keywordflow">break</span>;                              
00085                         <span class="comment">/*</span>
00086 <span class="comment">                    case CMG:</span>
00087 <span class="comment">                    m_whorlControlMomentGyro[string(data[i].devNm)] = new ControlMomentGyro(data[i]);</span>
00088 <span class="comment">                    break;</span>
00089 <span class="comment"></span>
00090 <span class="comment">                    case THR:</span>
00091 <span class="comment">                    m_whorlThruster[string(data[i].devNm)] = new Thruster(data[i]);</span>
00092 <span class="comment">                    break;</span>
00093 <span class="comment"></span>
00094 <span class="comment">                    case MAG:</span>
00095 <span class="comment">                    m_whorlMagentometer[string(data[i].devNm)] = new Magnetometer(data[i]);</span>
00096 <span class="comment">                    break;</span>
00097 <span class="comment">                        */</span>
00098                     <span class="keywordflow">default</span>:
00099                         <span class="keywordflow">break</span>;
00100             }
00101         }
00102 };
00103 
<a name="l00112"></a><a class="code" href="classWhorl.html#Whorla4" tppabs="http://dsacss.sourceforge.net/classWhorl.html#Whorla4">00112</a> Matrix <a class="code" href="classWhorl.html#Whorla4" tppabs="http://dsacss.sourceforge.net/classWhorl.html#Whorla4">Whorl::GetMOI</a>() {
00113         Matrix temp(3,3);
00114         
00115         temp(1,1) = <a class="code" href="classWhorl.html#Whorlr2" tppabs="http://dsacss.sourceforge.net/classWhorl.html#Whorlr2">m_recentParameter</a>(1);       temp(1,2) = <a class="code" href="classWhorl.html#Whorlr2" tppabs="http://dsacss.sourceforge.net/classWhorl.html#Whorlr2">m_recentParameter</a>(2);       temp(1,3) = <a class="code" href="classWhorl.html#Whorlr2" tppabs="http://dsacss.sourceforge.net/classWhorl.html#Whorlr2">m_recentParameter</a>(3);
00116         temp(2,1) = <a class="code" href="classWhorl.html#Whorlr2" tppabs="http://dsacss.sourceforge.net/classWhorl.html#Whorlr2">m_recentParameter</a>(2);   temp(2,2) = <a class="code" href="classWhorl.html#Whorlr2" tppabs="http://dsacss.sourceforge.net/classWhorl.html#Whorlr2">m_recentParameter</a>(4);   temp(2,3) = <a class="code" href="classWhorl.html#Whorlr2" tppabs="http://dsacss.sourceforge.net/classWhorl.html#Whorlr2">m_recentParameter</a>(5);
00117         temp(3,1) = <a class="code" href="classWhorl.html#Whorlr2" tppabs="http://dsacss.sourceforge.net/classWhorl.html#Whorlr2">m_recentParameter</a>(3);       temp(3,2) = <a class="code" href="classWhorl.html#Whorlr2" tppabs="http://dsacss.sourceforge.net/classWhorl.html#Whorlr2">m_recentParameter</a>(5);       temp(3,3) = <a class="code" href="classWhorl.html#Whorlr2" tppabs="http://dsacss.sourceforge.net/classWhorl.html#Whorlr2">m_recentParameter</a>(6);
00118         
00119         <span class="keywordflow">return</span> temp;
00120         
00121 }               
00122         
<a name="l00131"></a><a class="code" href="classWhorl.html#Whorla5" tppabs="http://dsacss.sourceforge.net/classWhorl.html#Whorla5">00131</a> Vector <a class="code" href="classWhorl.html#Whorla5" tppabs="http://dsacss.sourceforge.net/classWhorl.html#Whorla5">Whorl::GetCGVector</a>() {
00132         Vector temp(3);
00133         
00134         temp(1) = <a class="code" href="classWhorl.html#Whorlr2" tppabs="http://dsacss.sourceforge.net/classWhorl.html#Whorlr2">m_recentParameter</a>(7);
00135         temp(2) = <a class="code" href="classWhorl.html#Whorlr2" tppabs="http://dsacss.sourceforge.net/classWhorl.html#Whorlr2">m_recentParameter</a>(8);
00136         temp(3) = <a class="code" href="classWhorl.html#Whorlr2" tppabs="http://dsacss.sourceforge.net/classWhorl.html#Whorlr2">m_recentParameter</a>(9);
00137         
00138         <span class="keywordflow">return</span> temp;
00139 }       
00140         
<a name="l00148"></a><a class="code" href="classWhorl.html#Whorla7" tppabs="http://dsacss.sourceforge.net/classWhorl.html#Whorla7">00148</a> Vector <a class="code" href="classWhorl.html#Whorla7" tppabs="http://dsacss.sourceforge.net/classWhorl.html#Whorla7">Whorl::GetQuaternion</a>() {
00149         Vector temp(4);
00150         
00151         temp = <a class="code" href="classWhorl.html#Whorlr0" tppabs="http://dsacss.sourceforge.net/classWhorl.html#Whorlr0">m_recentState</a>( _(1,4) );
00152         
00153         <span class="keywordflow">return</span> temp;
00154         
00155 }
00156         
<a name="l00164"></a><a class="code" href="classWhorl.html#Whorla8" tppabs="http://dsacss.sourceforge.net/classWhorl.html#Whorla8">00164</a>         Vector <a class="code" href="classWhorl.html#Whorla8" tppabs="http://dsacss.sourceforge.net/classWhorl.html#Whorla8">Whorl::GetOmegaBL</a>() {
00165                 Vector temp(3);
00166                 
00167                 temp = <a class="code" href="classWhorl.html#Whorlr0" tppabs="http://dsacss.sourceforge.net/classWhorl.html#Whorlr0">m_recentState</a>( _(5,7) );
00168                 
00169                 <span class="keywordflow">return</span> temp;
00170                 
00171         };
00172 
00173 <span class="comment">// Do not change the comments below - they will be added automatically by CVS</span>
00174 <span class="comment">/*****************************************************************************</span>
00175 <span class="comment">*       $Log: Whorl.cpp,v $</span>
00176 <span class="comment">*       Revision 1.12  2004/04/28 19:42:56  bstreetman</span>
00177 <span class="comment">*       Added Tilt Sensor</span>
00178 <span class="comment">*       </span>
00179 <span class="comment">*       Revision 1.11  2003/08/19 17:41:45  simpliciter</span>
00180 <span class="comment">*       Fixed bug in state parsing (omega).</span>
00181 <span class="comment">*       </span>
00182 <span class="comment">*       Revision 1.10  2003/08/18 19:03:15  mavandyk</span>
00183 <span class="comment">*       Added initial condition and parameter parsing and pulled out controller and observer stuff.</span>
00184 <span class="comment">*       </span>
00185 <span class="comment">*       Revision 1.9  2003/08/14 18:42:59  nicmcp</span>
00186 <span class="comment">*       Added config parsing for parameters and states, needs to be debugged</span>
00187 <span class="comment">*       </span>
00188 <span class="comment">*       Revision 1.8  2003/08/13 23:15:32  mavandyk</span>
00189 <span class="comment">*       Altered structure as outline in meeting.</span>
00190 <span class="comment">*       </span>
00191 <span class="comment">*       Revision 1.7  2003/08/06 21:44:21  mavandyk</span>
00192 <span class="comment">*       Altered to get config parsing to work.</span>
00193 <span class="comment">*       </span>
00194 <span class="comment">*       Revision 1.6  2003/07/25 14:25:20  mavandyk</span>
00195 <span class="comment">*       Fixed bugs, It compiles.</span>
00196 <span class="comment">*       </span>
00197 <span class="comment">*       Revision 1.5  2003/07/22 21:26:27  mavandyk</span>
00198 <span class="comment">*       Fixed bugs.</span>
00199 <span class="comment">*       </span>
00200 <span class="comment">*       Revision 1.4  2003/07/08 20:45:10  cakinli</span>
00201 <span class="comment">*       Updated Whorl::Initialize() to use new cfgBody struct and CfgParse class,</span>
00202 <span class="comment">*       and incorporated device type names, indices, and index member in cfgBody struct.</span>
00203 <span class="comment">*       </span>
00204 <span class="comment">*       Revision 1.3  2003/07/07 14:37:58  simpliciter</span>
00205 <span class="comment">*       Minor modifications.  Measurement stuff needs work.</span>
00206 <span class="comment">*       </span>
00207 <span class="comment">*       Revision 1.2  2003/07/04 16:12:18  simpliciter</span>
00208 <span class="comment">*       Fixed variable and function names.</span>
00209 <span class="comment">*       </span>
00210 <span class="comment">*       Revision 1.1  2003/07/04 14:08:05  simpliciter</span>
00211 <span class="comment">*       Rearranged directory tree.</span>
00212 <span class="comment">*       </span>
00213 <span class="comment">*       Revision 1.4  2003/07/03 21:18:12  simpliciter</span>
00214 <span class="comment">*       Added functions based on requirements of Observer and Controller classes.</span>
00215 <span class="comment">*       </span>
00216 <span class="comment">*       Revision 1.3  2003/07/02 16:36:32  nicmcp</span>
00217 <span class="comment">*       added some comments</span>
00218 <span class="comment">*       </span>
00219 <span class="comment">*       Revision 1.2  2003/06/17 23:32:28  simpliciter</span>
00220 <span class="comment">*       Updated based on comments from Andy.</span>
00221 <span class="comment">*       </span>
00222 <span class="comment">*       Revision 1.1.1.1  2003/06/06 18:44:15  simpliciter</span>
00223 <span class="comment">*       Initial submission.</span>
00224 <span class="comment">*       </span>
00225 <span class="comment">*       Revision 1.1.1.1  2003/06/06 14:44:15  simpliciter</span>
00226 <span class="comment">*       Initial import.</span>
00227 <span class="comment">*       </span>
00228 <span class="comment">*</span>
00229 <span class="comment">******************************************************************************/</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Tue Jun 15 11:49:55 2004 for DSACSS Operational Code by
<a href="javascript:if(confirm('http://www.doxygen.org/index.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.doxygen.org/index.html'" tppabs="http://www.doxygen.org/index.html">
<img src="doxygen.png" tppabs="http://dsacss.sourceforge.net/doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.4 </small></address>
</body>
</html>
