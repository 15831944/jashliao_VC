<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>DSACSS Operational Code: fakeDMU.cpp Source File</title>
<link href="doxygen.css" tppabs="http://dsacss.sourceforge.net/doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.4 -->
<h1>fakeDMU.cpp</h1><a href="fakeDMU_8cpp.html" tppabs="http://dsacss.sourceforge.net/fakeDMU_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="preprocessor">#include &lt;iostream&gt;</span>
00002 <span class="preprocessor">#include "<a class="code" href="DMU_8h.html" tppabs="http://dsacss.sourceforge.net/DMU_8h.html">DMU.h</a>"</span>
00003 <span class="preprocessor">#include "Matrix.h"</span>
00004 <span class="preprocessor">#include "Rotation.h"</span>
00005 
00006 <span class="keyword">using</span> <span class="keyword">namespace </span>O_SESSAME;
00007 <span class="keyword">using</span> <span class="keyword">namespace </span>std;
00008 
00009 <a class="code" href="classDMU.html" tppabs="http://dsacss.sourceforge.net/classDMU.html">DMU</a>* <a class="code" href="classDMU.html#DMUv0" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUv0">DMU::s_instance</a> = NULL;
00010 
00011 <a class="code" href="classDMU.html#DMUa0" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUa0">DMU::DMU</a>()
00012 {
00013         <a class="code" href="classDMU.html#DMUa6" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUa6">Initialize</a>();
00014 }
00015 
00016 <a class="code" href="classDMU.html#DMUa0" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUa0">DMU::DMU</a>(<span class="keyword">const</span> string&amp; _sInitString)
00017 {
00018         <a class="code" href="classDMU.html#DMUa6" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUa6">Initialize</a>(_sInitString);
00019 }
00020 
00021 <span class="keywordtype">int</span> <a class="code" href="classDMU.html#DMUa6" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUa6">DMU::Initialize</a>()
00022 {
00023         <span class="comment">// this is temporary, just used because the parsing code </span>
00024         <span class="comment">// is not ready yet</span>
00025         
00026         Vector tempVector3(3);
00027         Vector tempQuat4(4);
00028 
00029         tempVector3(1) = 0.0;
00030         tempVector3(2) = 0.0;
00031         tempVector3(3) = 0.0;
00032 
00033         tempQuat4(1) = 0.0;
00034         tempQuat4(2) = 0.0;
00035         tempQuat4(3) = 0.0;
00036         tempQuat4(4) = 1.0;
00037 
00038         <a class="code" href="classDMU.html#DMUa7" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUa7">SetLocation</a>(tempVector3);
00039         <a class="code" href="classDMU.html#DMUa8" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUa8">SetSensorToBodyQuaternions</a>(tempQuat4);
00040         
00041         <a class="code" href="classDMU.html#DMUr6" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUr6">m_prate</a> = 200;
00042         <a class="code" href="classDMU.html#DMUr7" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUr7">m_tempBuffSize</a> = 100;
00043          
00044         <span class="comment">// allocate the memory that holds the temporary read data buffer </span>
00045         <a class="code" href="classDMU.html#DMUr5" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUr5">m_ptrToReadData</a> = <span class="keyword">new</span> <a class="code" href="structadat__t.html" tppabs="http://dsacss.sourceforge.net/structadat__t.html">adat_t</a>[<a class="code" href="classDMU.html#DMUr7" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUr7">m_tempBuffSize</a>];
00046         
00047         <span class="comment">// OK, pretend to initialize the hardware DMU.</span>
00048         cout &lt;&lt; <span class="stringliteral">" Initializing the DMU... "</span> &lt;&lt; endl;
00049         
00050         <span class="comment">//if (dmuInit(1024, m_prate, 0))</span>
00051         <span class="comment">//{</span>
00052           <span class="comment">//  cout &lt;&lt; " oops, 'dmuInit()' failed " &lt;&lt; endl;         </span>
00053             <span class="comment">// some error return condition?</span>
00054             <span class="comment">//return 1;</span>
00055         <span class="comment">// }</span>
00056         cout &lt;&lt; <span class="stringliteral">" ok, 'dmuInit()' successfull "</span> &lt;&lt; endl;
00057         <span class="keywordflow">return</span> 0;
00058 }
00059 
00060 <span class="keywordtype">int</span> <a class="code" href="classDMU.html#DMUa6" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUa6">DMU::Initialize</a>(<span class="keyword">const</span> string&amp; _sInitString)
00061 {
00062         <span class="comment">// code to parse info from config file</span>
00063         <span class="comment">// ... here...</span>
00064         
00065     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> find = 0; 
00066     <span class="keywordtype">int</span> efind;
00067     string sParameter;
00068     string stringTemp; 
00069     <span class="comment">//stringstream sStream;//(_sInitString.rdbuf());</span>
00070     Vector tempVector3(3); <span class="comment">// temp location vector</span>
00071     Vector tempQuat4(4); <span class="comment">// temp quaternion vector</span>
00072     
00073     <span class="keywordflow">while</span>(find &lt; _sInitString.size())
00074     {
00075         efind = _sInitString.find(<span class="charliteral">':'</span>, find);
00076         sParameter = _sInitString.substr(find, efind-find);
00077             find = efind + 1;
00078 
00079         <span class="keywordflow">if</span>((sParameter == <span class="stringliteral">"Name"</span>) || (sParameter == <span class="stringliteral">"Number"</span>))
00080         {
00081             efind = _sInitString.find(<span class="charliteral">'\n'</span>, find);
00082                 find = efind + 1;           
00083         }
00084         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(sParameter == <span class="stringliteral">"Quaternion"</span>)
00085         {       
00086             efind = _sInitString.find(<span class="charliteral">','</span>, find);
00087             stringTemp = _sInitString.substr(find, efind-find);
00088                 find = efind + 1;     
00089             tempQuat4(1) = strtod(stringTemp.c_str(), (<span class="keywordtype">char</span> **)NULL);
00090         
00091             efind = _sInitString.find(<span class="charliteral">','</span>, find);
00092             stringTemp = _sInitString.substr(find, efind-find);
00093                 find = efind + 1;     
00094             tempQuat4(2) = strtod(stringTemp.c_str(), (<span class="keywordtype">char</span> **)NULL);
00095         
00096             efind = _sInitString.find(<span class="charliteral">','</span>, find);
00097             stringTemp = _sInitString.substr(find, efind-find);
00098                 find = efind + 1;     
00099             tempQuat4(3) = strtod(stringTemp.c_str(), (<span class="keywordtype">char</span> **)NULL);
00100             
00101             efind = _sInitString.find(<span class="charliteral">'\n'</span>, find);
00102             stringTemp = _sInitString.substr(find, efind-find);
00103                 find = efind + 1;     
00104             tempQuat4(4) = strtod(stringTemp.c_str(), (<span class="keywordtype">char</span> **)NULL);
00105     
00106             <a class="code" href="classDMU.html#DMUa8" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUa8">SetSensorToBodyQuaternions</a>(tempQuat4);
00107         }
00108         
00109         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(sParameter == <span class="stringliteral">"Location"</span>)
00110         {
00111             efind = _sInitString.find(<span class="charliteral">','</span>, find);
00112             stringTemp = _sInitString.substr(find, efind-find);
00113                 find = efind + 1;
00114             tempVector3(1) = strtod(stringTemp.c_str(), (<span class="keywordtype">char</span> **)NULL);
00115 
00116             efind = _sInitString.find(<span class="charliteral">','</span>, find);
00117             stringTemp = _sInitString.substr(find, efind-find);
00118                 find = efind + 1;
00119             tempVector3(2) = strtod(stringTemp.c_str(), (<span class="keywordtype">char</span> **)NULL);
00120 
00121             efind = _sInitString.find(<span class="charliteral">'\n'</span>, find);
00122             stringTemp = _sInitString.substr(find, efind-find);
00123                 find = efind + 1;
00124             tempVector3(3) = strtod(stringTemp.c_str(), (<span class="keywordtype">char</span> **)NULL);
00125 
00126             <a class="code" href="classDMU.html#DMUa7" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUa7">SetLocation</a>(tempVector3);
00127         }
00128     }
00129 
00130     <span class="comment">// could also parse out following info from config file.</span>
00131     <span class="comment">// for now it's hard-coded</span>
00132     <a class="code" href="classDMU.html#DMUr6" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUr6">m_prate</a> = 200;
00133     <a class="code" href="classDMU.html#DMUr7" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUr7">m_tempBuffSize</a> = 100;
00134     
00135 
00136     <span class="comment">// allocate the memory that holds the temporary read data buffer </span>
00137     <a class="code" href="classDMU.html#DMUr5" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUr5">m_ptrToReadData</a> = <span class="keyword">new</span> <a class="code" href="structadat__t.html" tppabs="http://dsacss.sourceforge.net/structadat__t.html">adat_t</a>[<a class="code" href="classDMU.html#DMUr7" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUr7">m_tempBuffSize</a>];
00138         
00139     <span class="comment">// OK, now pretend to initialize the hardware DMU.</span>
00140     cout &lt;&lt; <span class="stringliteral">" Initializing the DMU... "</span> &lt;&lt; endl;
00141     <span class="comment">//if (dmuInit(1024, m_prate, 0))</span>
00142     <span class="comment">//{</span>
00143 <span class="comment">//          cout &lt;&lt; " oops, 'dmuInit()' failed " &lt;&lt; endl;           </span>
00144             <span class="comment">// some error return condition?</span>
00145 <span class="comment">//          return 1;</span>
00146 <span class="comment">//    }</span>
00147     cout &lt;&lt; <span class="stringliteral">" ok, 'dmuInit()' successfull "</span> &lt;&lt; endl;
00148     <span class="keywordflow">return</span> 0;
00149 }
00150 
00151 <a class="code" href="classDMU.html" tppabs="http://dsacss.sourceforge.net/classDMU.html">DMU</a>* <a class="code" href="classDMU.html#DMUe0" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUe0">DMU::Instance</a>()
00152 {
00153         <span class="comment">/* If first time being called, return a pointer </span>
00154 <span class="comment">         to an instance of a new DMU.  Otherwise return</span>
00155 <span class="comment">         a pointer to an instance of a DMU which was made</span>
00156 <span class="comment">         earlier.  Essentially, there can be only one DMU. */</span>
00157         <span class="keywordflow">if</span> (<a class="code" href="classDMU.html#DMUv0" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUv0">s_instance</a>==NULL)
00158         {
00159                 cout &lt;&lt; <span class="stringliteral">" you have an instance of a new dmu "</span> &lt;&lt; endl;
00160                 <a class="code" href="classDMU.html#DMUv0" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUv0">s_instance</a> = <span class="keyword">new</span> <a class="code" href="classDMU.html#DMUa0" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUa0">DMU</a>();
00161         }
00162         <span class="keywordflow">return</span> <a class="code" href="classDMU.html#DMUv0" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUv0">s_instance</a>;
00163 }
00164 
00165 <a class="code" href="classDMU.html" tppabs="http://dsacss.sourceforge.net/classDMU.html">DMU</a>* <a class="code" href="classDMU.html#DMUe0" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUe0">DMU::Instance</a>(<span class="keyword">const</span> string&amp; _sInitString)
00166 {
00167         <span class="comment">/* If first time being called, return a pointer </span>
00168 <span class="comment">         to an instance of a new DMU.  Otherwise return</span>
00169 <span class="comment">         a pointer to an instance of a DMU which was made</span>
00170 <span class="comment">         earlier.  Essentially, there can be only one DMU. </span>
00171 <span class="comment">         </span>
00172 <span class="comment">         Takes the initialization string as its argument*/</span>
00173         <span class="keywordflow">if</span> (<a class="code" href="classDMU.html#DMUv0" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUv0">s_instance</a>==NULL) 
00174         {
00175                 cout &lt;&lt; <span class="stringliteral">" you have an instance of a new dmu "</span> &lt;&lt; endl;
00176                 <a class="code" href="classDMU.html#DMUv0" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUv0">s_instance</a> = <span class="keyword">new</span> <a class="code" href="classDMU.html#DMUa0" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUa0">DMU</a>(_sInitString);
00177         }
00178         <span class="keywordflow">return</span> <a class="code" href="classDMU.html#DMUv0" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUv0">s_instance</a>;
00179 }
00180 
<a name="l00181"></a><a class="code" href="classDMU.html#DMUa7" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUa7">00181</a> <span class="keywordtype">void</span> <a class="code" href="classDMU.html#DMUa7" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUa7">DMU::SetLocation</a>(<span class="keyword">const</span> Vector&amp; _newDeviceLocation)
00182 {
00183         <a class="code" href="classDMU.html#DMUr0" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUr0">m_location</a> = _newDeviceLocation;
00184 }
00185 
<a name="l00186"></a><a class="code" href="classDMU.html#DMUa4" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUa4">00186</a> Vector <a class="code" href="classDMU.html#DMUa4" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUa4">DMU::GetLocation</a>()
00187 {       
00188         <span class="keywordflow">return</span> <a class="code" href="classDMU.html#DMUr0" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUr0">m_location</a>;
00189 }
00190 
<a name="l00191"></a><a class="code" href="classDMU.html#DMUa8" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUa8">00191</a> <span class="keywordtype">void</span> <a class="code" href="classDMU.html#DMUa8" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUa8">DMU::SetSensorToBodyQuaternions</a>(<span class="keyword">const</span> Vector&amp; _newDeviceQuaternion)
00192 {
00193         <a class="code" href="classDMU.html#DMUr1" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUr1">m_sensorToBodyQuaternion</a> = _newDeviceQuaternion;
00194         
00195         <span class="comment">// m_sensorToBodyQuaternion is given in config file,</span>
00196         <span class="comment">// where the frame of the DMU, F_dmu, is defined on the DMU itself,</span>
00197         <span class="comment">// the body-fixed frame, F_b, is defined elsewhere.</span>
00198         
00199         <span class="comment">// let each rate gyro (RG) have its own frame,</span>
00200         <span class="comment">// where the RG is defined as being located on the 1-axis,</span>
00201         <span class="comment">// and the other two axis are taken from F_dmu,</span>
00202         <span class="comment">// keeping the right-handedness</span>
00203         <span class="comment">//</span>
00204         <span class="comment">// likewise let each linear accelerometer (LAmeter) have its own frame,</span>
00205         <span class="comment">// where the LAmeter is defined as measuring positve acceleration along</span>
00206         <span class="comment">// the frame's 1-axis, and the other axes same as above.</span>
00207         <span class="comment">// (note: just "LA" by itself might be confused with linear actuator)</span>
00208 
00209         
00210         
00211         <span class="comment">// quaternion that describes both the </span>
00212         <span class="comment">// orientation of "x" RG frame wrt F_dmu and the</span>
00213         <span class="comment">// orientation of "x" LAmeter frame wrt F_dmu</span>
00214         Quaternion q1( 0.0, 0.0, 0.0, 1.0);
00215         
00216         <span class="comment">// quaternion that describes both the</span>
00217         <span class="comment">// orientation of "y" RG frame wrt F_dmu and the</span>
00218         <span class="comment">// orientation of "y" LAmeter frame wrt F_dmu</span>
00219         Quaternion q2( 0.5, 0.5, 0.5, -0.5);
00220                 
00221         <span class="comment">// quaternion that describes both the</span>
00222         <span class="comment">// orientation of "z" RG frame wrt F_dmu and the</span>
00223         <span class="comment">// orientation of "z" LAmeter frame wrt F_dmu</span>
00224         Quaternion q3( 0.5, 0.5, 0.5, 0.5);
00225         
00226         <span class="comment">// convert q1 into R_rg1_to_dmu</span>
00227         Rotation R_rg1_to_dmu(q1);
00228 
00229         <span class="comment">// convert q2 into R_rg2_to_dmu</span>
00230         Rotation R_rg2_to_dmu(q2);
00231         
00232         <span class="comment">// convert q3 into R_rg3_to_dmu</span>
00233         Rotation R_rg3_to_dmu(q3);
00234 
00235         <span class="comment">// convert m_dmuToBodyQuaternion to R_dmu_to_b;</span>
00236         Quaternion q0(<a class="code" href="classDMU.html#DMUr1" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUr1">m_sensorToBodyQuaternion</a>);
00237         Rotation R_dmu_to_b(q0);
00238         
00239         <span class="comment">// calculate rotation from rg1 to body frame:</span>
00240         Rotation R_rg1_to_b;
00241         R_rg1_to_b = R_dmu_to_b * R_rg1_to_dmu;
00242         
00243         <span class="comment">// calculate rotation from rg2 to body frame:</span>
00244         Rotation R_rg2_to_b;
00245         R_rg2_to_b = R_dmu_to_b * R_rg2_to_dmu;
00246         
00247         <span class="comment">// calculate rotation from rg3 to body frame:</span>
00248         Rotation R_rg3_to_b;
00249         R_rg3_to_b = R_dmu_to_b * R_rg3_to_dmu;
00250         
00251         <span class="comment">// convert R_rg1_to_b into q_rg1_to_b</span>
00252         <span class="comment">// and set as m_dmuXToBodyQuaternion</span>
00253         Quaternion q_rg1_to_b;
00254         q_rg1_to_b = R_rg1_to_b.GetQuaternion();
00255         <a class="code" href="classDMU.html#DMUr2" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUr2">m_dmuXToBodyQuaternion</a> = q_rg1_to_b;
00256         
00257         <span class="comment">// convert R_rg2_to_b into q_rg2_to_b</span>
00258         <span class="comment">// and set as m_dYoBodyQuaternion</span>
00259         Quaternion q_rg2_to_b;
00260         q_rg2_to_b = R_rg2_to_b.GetQuaternion();
00261         <a class="code" href="classDMU.html#DMUr3" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUr3">m_dmuYToBodyQuaternion</a> = q_rg2_to_b;
00262         
00263         <span class="comment">// convert R_rg3to_b into q_rg3_to_b</span>
00264         <span class="comment">// and set as m_dmuXToBodyQuaternion</span>
00265         Quaternion q_rg3_to_b;
00266         q_rg3_to_b = R_rg3_to_b.GetQuaternion();
00267         <a class="code" href="classDMU.html#DMUr4" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUr4">m_dmuZToBodyQuaternion</a> = q_rg3_to_b;
00268         
00269 }
00270         
<a name="l00271"></a><a class="code" href="classDMU.html#DMUa5" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUa5">00271</a> Vector <a class="code" href="classDMU.html#DMUa5" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUa5">DMU::GetSensorToBodyQuaternion</a>( <span class="keywordtype">int</span> id )
00272 {
00273         
00274         <span class="keywordflow">if</span> ( id == 1 | id == 4 )
00275         {
00276                 <span class="comment">// xRG or xLAmeter</span>
00277                 <span class="keywordflow">return</span> <a class="code" href="classDMU.html#DMUr2" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUr2">m_dmuXToBodyQuaternion</a>;
00278         }
00279         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( id == 2 | id == 5 )
00280         {
00281                 <span class="comment">// yRG or yLAmeter</span>
00282                 <span class="keywordflow">return</span> <a class="code" href="classDMU.html#DMUr3" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUr3">m_dmuYToBodyQuaternion</a>;
00283         }
00284         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( id == 3 | id == 6 )
00285         {
00286                 <span class="comment">// zRG or zLAmeter</span>
00287                 <span class="keywordflow">return</span> <a class="code" href="classDMU.html#DMUr4" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUr4">m_dmuZToBodyQuaternion</a>;
00288         }
00289         <span class="comment">// no default case?</span>
00290         <span class="comment">// what about error?</span>
00291         <span class="comment">//</span>
00292         <span class="comment">// do something more elegant and logical in future</span>
00293         Vector errorQuat4;
00294         errorQuat4(1) = 0.0;
00295         errorQuat4(2) = 0.0;
00296         errorQuat4(3) = 0.0;
00297         errorQuat4(4) = 1.0;
00298         cout &lt;&lt; <span class="stringliteral">" you gave bad channel, here's a dummy quaternion "</span> &lt;&lt; endl;
00299         <span class="keywordflow">return</span> errorQuat4;
00300 }
00301                         
00302 <span class="keywordtype">void</span> DMU::GetReading( <span class="keywordtype">int</span> _channelID, timeval&amp; _timeStamp, <span class="keywordtype">double</span>&amp; _rateData )
00303 {
00304         cout &lt;&lt; <span class="stringliteral">" you just called DMU::GetReading(...) "</span> &lt;&lt; endl;
00305         
00306         <span class="keywordtype">int</span> numread = 0;
00307         <span class="comment">//numread = dmuReadData(&amp;m_ptrToReadData, m_tempBuffSize);</span>
00308         
00309         <span class="keyword">static</span> <span class="keywordtype">int</span> numberOfTimesCalled = 0;
00310         
00311         <span class="comment">// pretend dmuReadData reads no more than 10 from polled data</span>
00312         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;10; i++)
00313         {
00314                 <a class="code" href="classDMU.html#DMUr5" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUr5">m_ptrToReadData</a>[i].<a class="code" href="structadat__t.html#adat__to0" tppabs="http://dsacss.sourceforge.net/structadat__t.html#adat__to0">xrate</a> = 0.0 + 0.1*numberOfTimesCalled + (<span class="keywordtype">float</span>)i*0.01;
00315                 <a class="code" href="classDMU.html#DMUr5" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUr5">m_ptrToReadData</a>[i].<a class="code" href="structadat__t.html#adat__to1" tppabs="http://dsacss.sourceforge.net/structadat__t.html#adat__to1">yrate</a> = 0.0 + 0.5*numberOfTimesCalled + (<span class="keywordtype">float</span>)i*0.01;
00316                 <a class="code" href="classDMU.html#DMUr5" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUr5">m_ptrToReadData</a>[i].<a class="code" href="structadat__t.html#adat__to2" tppabs="http://dsacss.sourceforge.net/structadat__t.html#adat__to2">zrate</a> = 0.0 + 2.0*numberOfTimesCalled + (<span class="keywordtype">float</span>)i*0.01;
00317                 <a class="code" href="classDMU.html#DMUr5" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUr5">m_ptrToReadData</a>[i].<a class="code" href="structadat__t.html#adat__to3" tppabs="http://dsacss.sourceforge.net/structadat__t.html#adat__to3">xaccel</a> = 0.0 + numberOfTimesCalled + (<span class="keywordtype">float</span>)i*0.01;
00318                 <a class="code" href="classDMU.html#DMUr5" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUr5">m_ptrToReadData</a>[i].<a class="code" href="structadat__t.html#adat__to4" tppabs="http://dsacss.sourceforge.net/structadat__t.html#adat__to4">yaccel</a> = 0.0 + numberOfTimesCalled + (<span class="keywordtype">float</span>)i*0.01;
00319                 <a class="code" href="classDMU.html#DMUr5" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUr5">m_ptrToReadData</a>[i].<a class="code" href="structadat__t.html#adat__to5" tppabs="http://dsacss.sourceforge.net/structadat__t.html#adat__to5">zaccel</a> = 0.0 + numberOfTimesCalled + (<span class="keywordtype">float</span>)i*0.01;
00320                 <a class="code" href="classDMU.html#DMUr5" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUr5">m_ptrToReadData</a>[i].<a class="code" href="structadat__t.html#adat__to6" tppabs="http://dsacss.sourceforge.net/structadat__t.html#adat__to6">temp</a> = 0.0 + numberOfTimesCalled + (<span class="keywordtype">float</span>)i*0.01;
00321                 numread++;
00322                 i++;
00323         }
00324         numberOfTimesCalled++;
00325         
00326         cout &lt;&lt; <span class="stringliteral">" you read "</span> &lt;&lt; numread &lt;&lt; <span class="stringliteral">" sets of data "</span> &lt;&lt; endl;
00327         <span class="comment">// will give the first set</span>
00328         <span class="keywordflow">switch</span> (_channelID)
00329         {
00330                 <span class="keywordflow">case</span> 1:         
00331                         _rateData = <a class="code" href="classDMU.html#DMUr5" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUr5">m_ptrToReadData</a>[0].<a class="code" href="structadat__t.html#adat__to0" tppabs="http://dsacss.sourceforge.net/structadat__t.html#adat__to0">xrate</a>;
00332                         <span class="keywordflow">break</span>;
00333                 <span class="keywordflow">case</span> 2:
00334                         _rateData = m_ptrToReadData[0].yrate;
00335                         <span class="keywordflow">break</span>;
00336                 <span class="keywordflow">case</span> 3:
00337                         _rateData = m_ptrToReadData[0].zrate;
00338                         <span class="keywordflow">break</span>;
00339                 <span class="keywordflow">case</span> 4:
00340                         _rateData = m_ptrToReadData[0].xaccel;
00341                         <span class="keywordflow">break</span>;
00342                 <span class="keywordflow">case</span> 5:
00343                         _rateData = m_ptrToReadData[0].yaccel;
00344                         <span class="keywordflow">break</span>;
00345                 <span class="keywordflow">case</span> 6:
00346                         _rateData = m_ptrToReadData[0].zaccel;
00347                         <span class="keywordflow">break</span>;
00348                 <span class="keywordflow">case</span> 7:
00349                         _rateData = m_ptrToReadData[0].temp;
00350                         <span class="keywordflow">break</span>;
00351                 <span class="keywordflow">default</span>:
00352                         cout &lt;&lt; <span class="stringliteral">" illegal channel value! "</span> &lt;&lt; endl;
00353         }
00354         <span class="comment">// for now just give deltat as timestamp</span>
00355         <span class="comment">//_timeStamp = m_ptrToReadData[0].deltat;</span>
00356         gettimeofday(&amp;_timeStamp, 0);
00357         
00358 }
00359 
<a name="l00360"></a><a class="code" href="classDMU.html#DMUa1" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUa1">00360</a> <a class="code" href="classDMU.html#DMUa1" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUa1">DMU::~DMU</a>()
00361 {
00362         <span class="comment">// Deconstructor</span>
00363         <span class="keyword">delete</span>[] <a class="code" href="classDMU.html#DMUr5" tppabs="http://dsacss.sourceforge.net/classDMU.html#DMUr5">m_ptrToReadData</a>; <span class="comment">/* release the memory used for the temporary read data buffer */</span>
00364 }
00365 
00366                         
00367         
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Tue Jun 15 11:49:54 2004 for DSACSS Operational Code by
<a href="javascript:if(confirm('http://www.doxygen.org/index.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.doxygen.org/index.html'" tppabs="http://www.doxygen.org/index.html">
<img src="doxygen.png" tppabs="http://dsacss.sourceforge.net/doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.4 </small></address>
</body>
</html>
