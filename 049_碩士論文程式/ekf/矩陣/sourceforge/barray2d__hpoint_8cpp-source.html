<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>barray2d_hpoint.cpp Source File</title>
<link href="doxygen.css" tppabs="http://libnurbs.sourceforge.net/docs/doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.14 -->
<center>
<a class="qindex" href="index.html" tppabs="http://libnurbs.sourceforge.net/docs/index.html">Main Page</a> &nbsp; <a class="qindex" href="hierarchy.html" tppabs="http://libnurbs.sourceforge.net/docs/hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="annotated.html" tppabs="http://libnurbs.sourceforge.net/docs/annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html" tppabs="http://libnurbs.sourceforge.net/docs/files.html">File List</a> &nbsp; <a class="qindex" href="functions.html" tppabs="http://libnurbs.sourceforge.net/docs/functions.html">Compound Members</a> &nbsp; </center>
<hr><h1>barray2d_hpoint.cpp</h1><div class="fragment"><pre>00001 <font class="comment">/*=============================================================================</font>
00002 <font class="comment">        File: barray2d.cpp</font>
00003 <font class="comment">     Purpose:</font>
00004 <font class="comment">    Revision: $Id: barray2d_hpoint.cpp,v 1.3 2003/01/13 19:41:13 philosophil Exp $</font>
00005 <font class="comment">  Created by: Philippe Lavoie          (3 Oct, 1996)</font>
00006 <font class="comment"> Modified by: </font>
00007 <font class="comment"></font>
00008 <font class="comment"> Copyright notice:</font>
00009 <font class="comment">          Copyright (C) 1996-2002 Philippe Lavoie</font>
00010 <font class="comment"> </font>
00011 <font class="comment">          This library is free software; you can redistribute it and/or</font>
00012 <font class="comment">          modify it under the terms of the GNU Library General Public</font>
00013 <font class="comment">          License as published by the Free Software Foundation; either</font>
00014 <font class="comment">          version 2 of the License, or (at your option) any later version.</font>
00015 <font class="comment"> </font>
00016 <font class="comment">          This library is distributed in the hope that it will be useful,</font>
00017 <font class="comment">          but WITHOUT ANY WARRANTY; without even the implied warranty of</font>
00018 <font class="comment">          MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</font>
00019 <font class="comment">          Library General Public License for more details.</font>
00020 <font class="comment"> </font>
00021 <font class="comment">          You should have received a copy of the GNU Library General Public</font>
00022 <font class="comment">          License along with this library; if not, write to the Free</font>
00023 <font class="comment">          Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.</font>
00024 <font class="comment">=============================================================================*/</font>
00025 
00026 <font class="preprocessor">#ifndef PLIB_BARRAY2D_SOURCE</font>
00027 <font class="preprocessor"></font><font class="preprocessor">#define PLIB_BARRAY2D_SOURCE</font>
00028 <font class="preprocessor"></font>
00029 <font class="preprocessor">#include "barray2d.cpp"</font>
00030 
00031 <font class="keyword">namespace </font>PLib {
00032 
00033 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T, const <font class="keywordtype">int</font> D&gt;
00034 <font class="keywordtype">void</font> initBasic2DArrayHPoint(Basic2DArray&lt;HPoint_nD&lt;T,D&gt; &gt;&amp; a, <font class="keyword">const</font> <font class="keywordtype">int</font> r,<font class="keyword">const</font> <font class="keywordtype">int</font> c)
00035 {
00036   <font class="keywordflow">if</font> ( r &lt;= 0  || c &lt;= 0 )
00037     {
00038       <font class="keywordflow">if</font>(a.m)
00039         <font class="keyword">delete</font> []a.m ;
00040       <font class="keywordflow">if</font>(a.vm)
00041         <font class="keyword">delete</font> []a.vm ;
00042       a.rz = r ;
00043       a.cz = c ;
00044       <font class="keywordflow">return</font> ;
00045     }
00046         
00047   a.rz = r;     a.cz = c;
00048 
00049   a.created = 1 ;
00050 <font class="preprocessor">#ifdef COLUMN_ORDER</font>
00051 <font class="preprocessor"></font>  a.vm = <font class="keyword">new</font> HPoint_nD&lt;T,D&gt;* [a.cz] ;
00052 <font class="preprocessor">#else</font>
00053 <font class="preprocessor"></font>  a.vm = <font class="keyword">new</font> HPoint_nD&lt;T,D&gt;* [a.rz] ;
00054 <font class="preprocessor">#endif</font>
00055 <font class="preprocessor"></font>
00056   T* dn ;
00057   dn = <font class="keyword">new</font> T[a.rz*a.cz*(D+1)] ;
00058   <font class="keywordtype">int</font> i ;
00059 
00060   a.m = <font class="keyword">new</font> NoInitHPoint_nD&lt;T,D&gt;[a.rz*a.cz] ;
00061   <font class="comment">// At this point the elements data pointer points to null</font>
00062   <font class="comment">// and their created status is 0.</font>
00063   <font class="comment">// The following is done so that the data point to </font>
00064   <font class="comment">// their proper place inside the consecutive memory</font>
00065   <font class="comment">// array allocated inside dn.</font>
00066 
00067 <font class="preprocessor">#ifdef COLUMN_ORDER</font>
00068 <font class="preprocessor"></font>  <font class="keyword">const</font> <font class="keywordtype">int</font> sze = a.rz*a.cz ;
00069   <font class="keywordflow">for</font>(i=sze-1;i&gt;=0;--i){
00070     a.m[i].data = dn+i*(D+1) ;  
00071   }
00072 <font class="preprocessor">#else</font>
00073 <font class="preprocessor"></font>  <font class="keywordflow">for</font>(i=a.rz-1;i&gt;=0;--i){
00074     <font class="keywordflow">for</font>(<font class="keywordtype">int</font> j=a.cz-1;j&gt;=0;--j){
00075       a.m[i*a.cz+j].data = dn+(a.rz*j+i)*(D+1) ; 
00076     }
00077   }
00078 <font class="preprocessor">#endif </font>
00079 <font class="preprocessor"></font>
00080   memset((<font class="keywordtype">void</font>*)dn,0,(a.cz*a.rz*(D+1))*<font class="keyword">sizeof</font>(T)) ;
00081 
00082   <font class="comment">// Ok so everyone points to the consecutive array</font>
00083   <font class="comment">// but someone needs to delete it when the times</font>
00084   <font class="comment">// come. That's the job of the first HPoint.</font>
00085   <font class="keywordflow">if</font>((a.rz*a.cz)&gt;0)
00086     a.m[0].created = 1;
00087 
00088 <font class="preprocessor">#ifdef COLUMN_ORDER</font>
00089 <font class="preprocessor"></font>  <font class="keywordflow">for</font>(i=a.cz-1;i&gt;=0;--i)
00090     a.vm[i] = &amp;a.m[i*a.rz] ;
00091 <font class="preprocessor">#else</font>
00092 <font class="preprocessor"></font>  <font class="keywordflow">for</font>(i=a.rz-1;i&gt;=0;--i)
00093     a.vm[i] = &amp;a.m[i*a.cz] ;
00094 <font class="preprocessor">#endif</font>
00095 <font class="preprocessor"></font>}
00096 
00097 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T, const <font class="keywordtype">int</font> D&gt;
00098 <font class="keywordtype">void</font> resizeKeepBasic2DArrayHPoint(Basic2DArray&lt;HPoint_nD&lt;T,D&gt; &gt; &amp;a, <font class="keyword">const</font> <font class="keywordtype">int</font> nr,<font class="keyword">const</font> <font class="keywordtype">int</font> nc)
00099 {
00100   <font class="keywordflow">if</font>(nr==a.rz &amp;&amp; nc==a.cz){
00101     <font class="keywordflow">return</font> ;
00102   }
00103 
00104   HPoint_nD&lt;T,D&gt; *mn ;
00105   HPoint_nD&lt;T,D&gt; *p,*pn ;
00106 
00107   pn = 0 ;
00108 
00109   mn = <font class="keyword">new</font> NoInitHPoint_nD&lt;T,D&gt;[nr*nc] ;
00110   <font class="comment">// At this point the elements data pointer points to null</font>
00111   <font class="comment">// and their created status is 0.</font>
00112   <font class="comment">// The following is done so that the data point to </font>
00113   <font class="comment">// their proper place inside the consecutive memory</font>
00114   <font class="comment">// array allocated inside dn.</font>
00115 
00116   T* dn ;
00117   dn = <font class="keyword">new</font> T[nr*nc*(D+1)] ;
00118   memset((<font class="keywordtype">void</font>*)dn,0,(nr*nc*(D+1))*<font class="keyword">sizeof</font>(T)) ;
00119 
00120   <font class="keywordtype">int</font> i,j ;
00121 <font class="preprocessor">#ifdef COLUMN_ORDER</font>
00122 <font class="preprocessor"></font>  <font class="keywordflow">for</font>(i=0;i&lt;nr*nc;++i){
00123     mn[i].created = 0 ; 
00124     mn[i].data = &amp;dn[i*(D+1)] ;
00125   }
00126   <font class="keywordflow">for</font>(j=0;j&lt;minimum(nc,a.cz);j++){
00127     p = &amp;a.m[j*a.rz] -1;
00128     pn = &amp;mn[j*nr] -1 ;
00129     <font class="keywordflow">for</font>(i=0;i&lt;minimum(nr,a.rz);i++){
00130       *(++pn) = *(++p) ;
00131     }
00132   }
00133 
00134   <font class="keywordflow">for</font>(j=a.cz;j&lt;nc;j++)
00135     pn = &amp;mn[j*nr+a.rz]-1 ;
00136     <font class="keywordflow">for</font>(i=a.rz;i&lt;nr;i++){
00137       *(pn++) = HPoint_nD&lt;T,D&gt;(0) ;
00138   }
00139 
00140 <font class="preprocessor">#else</font>
00141 <font class="preprocessor"></font>  <font class="keywordflow">for</font>(i=0;i&lt;nr;++i){
00142     <font class="keywordflow">for</font>(j=0;j&lt;nc;++j){
00143       mn[i*nc+j].created = 0 ; 
00144       mn[i*nc+j].data = &amp;dn[(nr*j+i)*(D+1)] ;
00145     }
00146   }
00147   <font class="keywordflow">for</font>(i=0;i&lt;minimum(nr,a.rz);i++){
00148     p = &amp;a.m[i*a.cz] -1;
00149     pn = &amp;mn[i*nc] -1 ;
00150     <font class="keywordflow">for</font>(j=0;j&lt;minimum(nc,a.cz);j++){
00151       *(++pn) = *(++p) ;
00152     }
00153   }
00154 
00155   <font class="keywordflow">for</font>(i=a.rz;i&lt;nr;i++){
00156     pn = &amp;mn[i*nc+a.cz]-1 ;
00157     <font class="keywordflow">for</font>(j=a.cz;j&lt;nc;j++)
00158       *(pn++) = HPoint_nD&lt;T,D&gt;(0) ;
00159   }
00160 
00161 <font class="preprocessor">#endif</font>
00162 <font class="preprocessor"></font>
00163   a.rz = nr ;
00164   a.cz = nc ;
00165 
00166   <font class="keywordflow">if</font>(a.m &amp;&amp; a.created){
00167     <font class="keyword">delete</font> []a.m ;
00168   }
00169   a.created = 1 ;
00170   a.m = mn ;
00171   <font class="comment">// Ok so everyone points to the consecutive array</font>
00172   <font class="comment">// but someone needs to delete it when the times</font>
00173   <font class="comment">// come. That's the job of the first HPoint.</font>
00174   <font class="keywordflow">if</font>((nr*nc)&gt;0)
00175     a.m[0].created = 1 ;
00176   <font class="keywordflow">if</font>(a.vm)
00177     <font class="keyword">delete</font> []a.vm ;
00178 <font class="preprocessor">#ifdef COLUMN_ORDER</font>
00179 <font class="preprocessor"></font>  a.vm = <font class="keyword">new</font> HPoint_nD&lt;T,D&gt;* [a.cz] ;
00180   <font class="keywordflow">for</font>(i=0;i&lt;a.cz;++i)
00181     a.vm[i] = &amp;a.m[i*a.rz] ;
00182 <font class="preprocessor">#else</font>
00183 <font class="preprocessor"></font>  a.vm = <font class="keyword">new</font> HPoint_nD&lt;T,D&gt;* [a.rz] ;
00184   <font class="keywordflow">for</font>(i=0;i&lt;a.rz;++i)
00185     a.vm[i] = &amp;a.m[i*a.cz] ;
00186 <font class="preprocessor">#endif</font>
00187 <font class="preprocessor"></font>}
00188 
00189 <font class="keyword">template</font>&lt;&gt;
00190 <font class="keywordtype">void</font> initBasic2DArray(Basic2DArray&lt;HPoint_nD&lt;float,2&gt; &gt;&amp; a, <font class="keyword">const</font> <font class="keywordtype">int</font> nr, <font class="keyword">const</font> <font class="keywordtype">int</font> nc){
00191   initBasic2DArrayHPoint(a,nr,nc) ;
00192 }
00193 
00194 <font class="keyword">template</font>&lt;&gt;
00195 <font class="keywordtype">void</font> initBasic2DArray(Basic2DArray&lt;HPoint_nD&lt;float,3&gt; &gt;&amp; a, <font class="keyword">const</font> <font class="keywordtype">int</font> nr, <font class="keyword">const</font> <font class="keywordtype">int</font> nc){
00196   initBasic2DArrayHPoint(a,nr,nc) ;
00197 }
00198 
00199 <font class="keyword">template</font>&lt;&gt;
00200 <font class="keywordtype">void</font> initBasic2DArray(Basic2DArray&lt;HPoint_nD&lt;double,2&gt; &gt;&amp; a, <font class="keyword">const</font> <font class="keywordtype">int</font> nr, <font class="keyword">const</font> <font class="keywordtype">int</font> nc){
00201   initBasic2DArrayHPoint(a,nr,nc) ;
00202 }
00203 
00204 <font class="keyword">template</font>&lt;&gt;
00205 <font class="keywordtype">void</font> initBasic2DArray(Basic2DArray&lt;HPoint_nD&lt;double,3&gt; &gt;&amp; a, <font class="keyword">const</font> <font class="keywordtype">int</font> nr, <font class="keyword">const</font> <font class="keywordtype">int</font> nc){
00206   initBasic2DArrayHPoint(a,nr,nc) ;
00207 }
00208 
00209 <font class="keyword">template</font>&lt;&gt;
00210 <font class="keywordtype">void</font> resizeKeepBasic2DArray(Basic2DArray&lt;HPoint_nD&lt;float,2&gt; &gt;&amp; a, <font class="keyword">const</font> <font class="keywordtype">int</font> nr, <font class="keyword">const</font> <font class="keywordtype">int</font> nc){
00211   resizeKeepBasic2DArrayHPoint(a,nr,nc) ;
00212 }
00213 
00214 <font class="keyword">template</font>&lt;&gt;
00215 <font class="keywordtype">void</font> resizeKeepBasic2DArray(Basic2DArray&lt;HPoint_nD&lt;float,3&gt; &gt;&amp; a, <font class="keyword">const</font> <font class="keywordtype">int</font> nr, <font class="keyword">const</font> <font class="keywordtype">int</font> nc){
00216   resizeKeepBasic2DArrayHPoint(a,nr,nc) ;
00217 }
00218 
00219 <font class="keyword">template</font>&lt;&gt;
00220 <font class="keywordtype">void</font> resizeKeepBasic2DArray(Basic2DArray&lt;HPoint_nD&lt;double,2&gt; &gt;&amp; a, <font class="keyword">const</font> <font class="keywordtype">int</font> nr, <font class="keyword">const</font> <font class="keywordtype">int</font> nc){
00221   resizeKeepBasic2DArrayHPoint(a,nr,nc) ;
00222 }
00223 
00224 <font class="keyword">template</font>&lt;&gt;
00225 <font class="keywordtype">void</font> resizeKeepBasic2DArray(Basic2DArray&lt;HPoint_nD&lt;double,3&gt; &gt;&amp; a, <font class="keyword">const</font> <font class="keywordtype">int</font> nr, <font class="keyword">const</font> <font class="keywordtype">int</font> nc){
00226   resizeKeepBasic2DArrayHPoint(a,nr,nc) ;
00227 }
00228 
00229 <font class="preprocessor">#ifdef NO_IMPLICIT_TEMPLATES</font>
00230 <font class="preprocessor"></font>
00231 <font class="keyword">template</font> <font class="keyword">class </font>Basic2DArray&lt;HPoint3Df&gt; ;
00232 <font class="keyword">template</font> <font class="keywordtype">void</font> initBasic2DArrayHPoint(Basic2DArray&lt;HPoint3Df&gt;&amp;,<font class="keyword">const</font> <font class="keywordtype">int</font>,<font class="keyword">const</font> <font class="keywordtype">int</font>) ;
00233 <font class="keyword">template</font> <font class="keywordtype">void</font> resizeKeepBasic2DArrayHPoint(Basic2DArray&lt;HPoint3Df&gt;&amp;,<font class="keyword">const</font> <font class="keywordtype">int</font>,<font class="keyword">const</font> <font class="keywordtype">int</font>) ;
00234 <font class="keyword">template</font> istream&amp; operator&gt;&gt;(istream&amp; is, Basic2DArray&lt;HPoint3Df&gt;&amp; ary);
00235 <font class="keyword">template</font> ostream&amp; operator&lt;&lt;(ostream&amp; os, const Basic2DArray&lt;HPoint3Df&gt;&amp; ary);
00236 
00237 <font class="keyword">template</font> <font class="keyword">class </font>Basic2DArray&lt;HPoint2Df&gt; ;
00238 <font class="keyword">template</font> <font class="keywordtype">void</font> initBasic2DArrayHPoint(Basic2DArray&lt;HPoint2Df&gt;&amp;,<font class="keyword">const</font> <font class="keywordtype">int</font>,<font class="keyword">const</font> <font class="keywordtype">int</font>) ;
00239 <font class="keyword">template</font> <font class="keywordtype">void</font> resizeKeepBasic2DArrayHPoint(Basic2DArray&lt;HPoint2Df&gt;&amp;,<font class="keyword">const</font> <font class="keywordtype">int</font>,<font class="keyword">const</font> <font class="keywordtype">int</font>) ;
00240 <font class="keyword">template</font> istream&amp; operator&gt;&gt;(istream&amp; is, Basic2DArray&lt;HPoint2Df&gt;&amp; ary);
00241 <font class="keyword">template</font> ostream&amp; operator&lt;&lt;(ostream&amp; os, const Basic2DArray&lt;HPoint2Df&gt;&amp; ary);
00242 
00243 <font class="keyword">template</font> <font class="keyword">class </font>Basic2DArray&lt;HPoint3Dd&gt; ;
00244 <font class="keyword">template</font> <font class="keywordtype">void</font> initBasic2DArrayHPoint(Basic2DArray&lt;HPoint3Dd&gt;&amp;,<font class="keyword">const</font> <font class="keywordtype">int</font>,<font class="keyword">const</font> <font class="keywordtype">int</font>) ;
00245 <font class="keyword">template</font> <font class="keywordtype">void</font> resizeKeepBasic2DArrayHPoint(Basic2DArray&lt;HPoint3Dd&gt;&amp;,<font class="keyword">const</font> <font class="keywordtype">int</font>,<font class="keyword">const</font> <font class="keywordtype">int</font>) ;
00246 <font class="keyword">template</font> istream&amp; operator&gt;&gt;(istream&amp; is, Basic2DArray&lt;HPoint3Dd&gt;&amp; ary);
00247 <font class="keyword">template</font> ostream&amp; operator&lt;&lt;(ostream&amp; os, const Basic2DArray&lt;HPoint3Dd&gt;&amp; ary);
00248 
00249 <font class="keyword">template</font> <font class="keyword">class </font>Basic2DArray&lt;HPoint2Dd&gt; ;
00250 <font class="keyword">template</font> <font class="keywordtype">void</font> initBasic2DArrayHPoint(Basic2DArray&lt;HPoint2Dd&gt;&amp;,<font class="keyword">const</font> <font class="keywordtype">int</font>,<font class="keyword">const</font> <font class="keywordtype">int</font>) ;
00251 <font class="keyword">template</font> <font class="keywordtype">void</font> resizeKeepBasic2DArrayHPoint(Basic2DArray&lt;HPoint2Dd&gt;&amp;,<font class="keyword">const</font> <font class="keywordtype">int</font>,<font class="keyword">const</font> <font class="keywordtype">int</font>) ;
00252 <font class="keyword">template</font> istream&amp; operator&gt;&gt;(istream&amp; is, Basic2DArray&lt;HPoint2Dd&gt;&amp; ary);
00253 <font class="keyword">template</font> ostream&amp; operator&lt;&lt;(ostream&amp; os, const Basic2DArray&lt;HPoint2Dd&gt;&amp; ary);
00254 
00255 <font class="preprocessor">#endif</font>
00256 <font class="preprocessor"></font>
00257 }
00258 
00259 <font class="preprocessor">#endif //  PLIB_BARRAY2D_SOURCE</font>
</pre></div><hr><address><small>Generated on Tue Jun 24 13:26:54 2003 for NURBS++ by
<a href="javascript:if(confirm('http://www.doxygen.org/index.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.doxygen.org/index.html'" tppabs="http://www.doxygen.org/index.html">
<img src="doxygen.gif" tppabs="http://libnurbs.sourceforge.net/docs/doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.14 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2002</small></address>
</body>
</html>
