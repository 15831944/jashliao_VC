<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>curve.cpp Source File</title>
<link href="doxygen.css" tppabs="http://libnurbs.sourceforge.net/docs/doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.14 -->
<center>
<a class="qindex" href="index.html" tppabs="http://libnurbs.sourceforge.net/docs/index.html">Main Page</a> &nbsp; <a class="qindex" href="hierarchy.html" tppabs="http://libnurbs.sourceforge.net/docs/hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="annotated.html" tppabs="http://libnurbs.sourceforge.net/docs/annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html" tppabs="http://libnurbs.sourceforge.net/docs/files.html">File List</a> &nbsp; <a class="qindex" href="functions.html" tppabs="http://libnurbs.sourceforge.net/docs/functions.html">Compound Members</a> &nbsp; </center>
<hr><h1>curve.cpp</h1><div class="fragment"><pre>00001 <font class="comment">/*=============================================================================</font>
00002 <font class="comment">        File: curve.cpp</font>
00003 <font class="comment">     Purpose:       </font>
00004 <font class="comment">    Revision: $Id: curve.cpp,v 1.3 2003/01/13 19:41:21 philosophil Exp $</font>
00005 <font class="comment">  Created by: Philippe Lavoie          (3 Oct, 1996)</font>
00006 <font class="comment"> Modified by: </font>
00007 <font class="comment"></font>
00008 <font class="comment"> Copyright notice:</font>
00009 <font class="comment">          Copyright (C) 1996-1997 Philippe Lavoie</font>
00010 <font class="comment"> </font>
00011 <font class="comment">          This library is free software; you can redistribute it and/or</font>
00012 <font class="comment">          modify it under the terms of the GNU Library General Public</font>
00013 <font class="comment">          License as published by the Free Software Foundation; either</font>
00014 <font class="comment">          version 2 of the License, or (at your option) any later version.</font>
00015 <font class="comment"> </font>
00016 <font class="comment">          This library is distributed in the hope that it will be useful,</font>
00017 <font class="comment">          but WITHOUT ANY WARRANTY; without even the implied warranty of</font>
00018 <font class="comment">          MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</font>
00019 <font class="comment">          Library General Public License for more details.</font>
00020 <font class="comment"> </font>
00021 <font class="comment">          You should have received a copy of the GNU Library General Public</font>
00022 <font class="comment">          License along with this library; if not, write to the Free</font>
00023 <font class="comment">          Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.</font>
00024 <font class="comment">=============================================================================*/</font>
00025 
00026 <font class="preprocessor">#ifndef PLIB_NURBS_CURVE_SOURCE</font>
00027 <font class="preprocessor"></font><font class="preprocessor">#define PLIB_NURBS_CURVE_SOURCE</font>
00028 <font class="preprocessor"></font>
00029 
00030 <font class="preprocessor">#include &lt;curve.h&gt;</font>
00031 
00034 <font class="keyword">namespace </font>PLib {
00035 
00063 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T, <font class="keywordtype">int</font> N&gt;
<a name="l00064"></a><a class="code" href="classPLib_1_1ParaCurve.html#a10" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1ParaCurve.html#a10">00064</a> T ParaCurve&lt;T,N&gt;::minDist2(<font class="keyword">const</font> Point_nD&lt;T,N&gt;&amp; p, T&amp; guess,T error,T s,<font class="keywordtype">int</font> sep,<font class="keywordtype">int</font> maxIter, T um, T uM)<font class="keyword"> const </font>{
00065   <font class="keywordflow">if</font>(um&lt;0)
00066     um = <a class="code" href="classPLib_1_1ParaCurve.html#a8" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1ParaCurve.html#a8">minKnot</a>() ;
00067   <font class="keywordflow">if</font>(uM&lt;0)
00068     uM = <a class="code" href="classPLib_1_1ParaCurve.html#a9" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1ParaCurve.html#a9">maxKnot</a>() ;
00069   <font class="keywordflow">if</font>(s&lt;0)
00070     s = uM-um ;
00071   T d,d1,d2 ;
00072   Point_nD&lt;T,N&gt; p2 ;
00073   p2 = <a class="code" href="classPLib_1_1ParaCurve.html#a3" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1ParaCurve.html#a3">pointAt</a>(guess) ;
00074   d = norm2(p-p2) ;
00075   d2 = d1 = 0 ;
00076   <font class="keywordtype">int</font> niter = 0 ;
00077   T u1,u2 ;
00078   T step ;
00079   step = s/(T)sep ;
00080   u1 = guess-s ;
00081   u2 = guess+s ;
00082   <font class="keywordflow">while</font>(d&gt;error &amp;&amp; niter&lt;maxIter) {
00083     <font class="keywordflow">if</font>(u1&lt;um)
00084       u1=um;
00085     <font class="keywordflow">if</font>(u2&gt;uM)
00086       u2 = uM ;
00087     T u = u1 ;
00088     d2 = d1 ;
00089     <font class="keywordflow">for</font>(;u&lt;u2;u+=step){
00090       p2 = <a class="code" href="classPLib_1_1ParaCurve.html#a3" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1ParaCurve.html#a3">pointAt</a>(u) ;
00091       d1 = norm2(p-p2) ;
00092       <font class="keywordflow">if</font>(d1&lt;d){
00093         d = d1 ;
00094         guess = u ;
00095       }
00096     }
00097     s /= 2.0 ;
00098     u1 = guess - s ;
00099     u2 = guess + s ;
00100     step = 2.0*s/(T)sep ;
00101     <font class="keywordflow">if</font>(d-d2==0) niter = maxIter ;
00102     <font class="keywordflow">if</font>(step&lt;error) niter = maxIter ;
00103     niter++;
00104   }
00105   <font class="keywordflow">return</font> d ;
00106 }
00107 
00108 
00137 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T, <font class="keywordtype">int</font> N&gt;
<a name="l00138"></a><a class="code" href="classPLib_1_1ParaCurve.html#a11" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1ParaCurve.html#a11">00138</a> Point_nD&lt;T,N&gt; ParaCurve&lt;T,N&gt;::minDistY(T y, T&amp; guessU, T error, T s, <font class="keywordtype">int</font> sep, <font class="keywordtype">int</font> maxIter, T um, T uM)<font class="keyword"> const </font>{
00139   <font class="keywordflow">if</font>(um&lt;0)
00140     um = <a class="code" href="classPLib_1_1ParaCurve.html#a8" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1ParaCurve.html#a8">minKnot</a>() ;
00141   <font class="keywordflow">if</font>(uM&lt;0)
00142     uM = <a class="code" href="classPLib_1_1ParaCurve.html#a9" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1ParaCurve.html#a9">maxKnot</a>() ;
00143   <font class="keywordflow">if</font>(s&lt;0)
00144     s = uM-um ;
00145   T d,d1,d2 ;
00146   Point_nD&lt;T,N&gt; p2,result ;
00147   p2 = <a class="code" href="classPLib_1_1ParaCurve.html#a3" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1ParaCurve.html#a3">pointAt</a>(guessU) ;
00148   result = p2 ;
00149   d = to2power(y-p2.y()) ;
00150   d2 = d1 = 0 ;
00151   <font class="keywordtype">int</font> niter = 0 ;
00152   T u1,u2 ;
00153   T step ;
00154   step = s/(T)sep ;
00155   u1 = guessU-s ;
00156   u2 = guessU+s ;
00157   <font class="keywordflow">while</font>(d&gt;error &amp;&amp; niter&lt;maxIter) {
00158     <font class="keywordflow">if</font>(u1&lt;um)
00159       u1=um;
00160     <font class="keywordflow">if</font>(u2&gt;uM)
00161       u2 = uM ;
00162     T u = u1 ;
00163     d2 = d1 ;
00164     <font class="keywordflow">for</font>(;u&lt;u2;u+=step){
00165       p2 = <a class="code" href="classPLib_1_1ParaCurve.html#a3" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1ParaCurve.html#a3">pointAt</a>(u) ;
00166       d1 = to2power(y-p2.y()) ;
00167       <font class="keywordflow">if</font>(d1&lt;d){
00168         d = d1 ;
00169         guessU = u ;
00170         result = p2 ;
00171       }
00172     }
00173     s /= 2.0 ;
00174     u1 = guessU - s ;
00175     u2 = guessU + s ;
00176     step = 2.0*s/(T)sep ;
00177     <font class="keywordflow">if</font>(d-d2==0) niter = maxIter ;
00178     <font class="keywordflow">if</font>(step&lt;error) niter = maxIter ;
00179     niter++;
00180   }
00181   <font class="keywordflow">return</font> result ;
00182 }
00183 
00184 
00213 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T, <font class="keywordtype">int</font> N&gt;
<a name="l00214"></a><a class="code" href="classPLib_1_1ParaCurve.html#a12" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1ParaCurve.html#a12">00214</a> Point_nD&lt;T,N&gt; ParaCurve&lt;T,N&gt;::minDistX(T x, T&amp; guessU, T error, T s, <font class="keywordtype">int</font> sep, <font class="keywordtype">int</font> maxIter, T um, T uM)<font class="keyword"> const </font>{
00215   <font class="keywordflow">if</font>(um&lt;0)
00216     um = <a class="code" href="classPLib_1_1ParaCurve.html#a8" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1ParaCurve.html#a8">minKnot</a>() ;
00217   <font class="keywordflow">if</font>(uM&lt;0)
00218     uM = <a class="code" href="classPLib_1_1ParaCurve.html#a9" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1ParaCurve.html#a9">maxKnot</a>() ;
00219   <font class="keywordflow">if</font>(s&lt;0)
00220     s = uM-um ;
00221   T d,d1,d2 ;
00222   Point_nD&lt;T,N&gt; p2,result ;
00223   p2 = <a class="code" href="classPLib_1_1ParaCurve.html#a3" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1ParaCurve.html#a3">pointAt</a>(guessU) ;
00224   result = p2 ;
00225   d = to2power(x-p2.x()) ;
00226   d2 = d1 = 0 ;
00227   <font class="keywordtype">int</font> niter = 0 ;
00228   T u1,u2 ;
00229   T step ;
00230   step = s/(T)sep ;
00231   u1 = guessU-s ;
00232   u2 = guessU+s ;
00233   <font class="keywordflow">while</font>(d&gt;error &amp;&amp; niter&lt;maxIter) {
00234     <font class="keywordflow">if</font>(u1&lt;um)
00235       u1=um;
00236     <font class="keywordflow">if</font>(u2&gt;uM)
00237       u2 = uM ;
00238     T u = u1 ;
00239     d2 = d1 ;
00240     <font class="keywordflow">for</font>(;u&lt;u2;u+=step){
00241       p2 = <a class="code" href="classPLib_1_1ParaCurve.html#a3" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1ParaCurve.html#a3">pointAt</a>(u) ;
00242       d1 = to2power(x-p2.x()) ;
00243       <font class="keywordflow">if</font>(d1&lt;d){
00244         d = d1 ;
00245         guessU = u ;
00246         result = p2 ;
00247       }
00248     }
00249     s /= 2.0 ;
00250     u1 = guessU - s ;
00251     u2 = guessU + s ;
00252     step = 2.0*s/(T)sep ;
00253     <font class="keywordflow">if</font>(d-d2==0) niter = maxIter ;
00254     <font class="keywordflow">if</font>(step&lt;error) niter = maxIter ;
00255     niter++;
00256   }
00257   <font class="keywordflow">return</font> result ;
00258 }
00259 
00260 
00289 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T, <font class="keywordtype">int</font> N&gt;
<a name="l00290"></a><a class="code" href="classPLib_1_1ParaCurve.html#a13" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1ParaCurve.html#a13">00290</a> Point_nD&lt;T,N&gt; ParaCurve&lt;T,N&gt;::minDistZ(T z, T&amp; guessU, T error, T s, <font class="keywordtype">int</font> sep, <font class="keywordtype">int</font> maxIter, T um, T uM)<font class="keyword"> const </font>{
00291   <font class="keywordflow">if</font>(um&lt;0)
00292     um = <a class="code" href="classPLib_1_1ParaCurve.html#a8" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1ParaCurve.html#a8">minKnot</a>() ;
00293   <font class="keywordflow">if</font>(uM&lt;0)
00294     uM = <a class="code" href="classPLib_1_1ParaCurve.html#a9" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1ParaCurve.html#a9">maxKnot</a>() ;
00295   <font class="keywordflow">if</font>(s&lt;0)
00296     s = uM-um ;
00297   T d,d1,d2 ;
00298   Point_nD&lt;T,N&gt; p2,result ;
00299   p2 = <a class="code" href="classPLib_1_1ParaCurve.html#a3" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1ParaCurve.html#a3">pointAt</a>(guessU) ;
00300   result = p2 ;
00301   d = to2power(z-p2.z()) ;
00302   d2 = d1 = 0 ;
00303   <font class="keywordtype">int</font> niter = 0 ;
00304   T u1,u2 ;
00305   T step ;
00306   step = s/(T)sep ;
00307   u1 = guessU-s ;
00308   u2 = guessU+s ;
00309   <font class="keywordflow">while</font>(d&gt;error &amp;&amp; niter&lt;maxIter) {
00310     <font class="keywordflow">if</font>(u1&lt;um)
00311       u1=um;
00312     <font class="keywordflow">if</font>(u2&gt;uM)
00313       u2 = uM ;
00314     T u = u1 ;
00315     d2 = d1 ;
00316     <font class="keywordflow">for</font>(;u&lt;u2;u+=step){
00317       p2 = <a class="code" href="classPLib_1_1ParaCurve.html#a3" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1ParaCurve.html#a3">pointAt</a>(u) ;
00318       d1 = to2power(z-p2.z()) ;
00319       <font class="keywordflow">if</font>(d1&lt;d){
00320         d = d1 ;
00321         guessU = u ;
00322         result = p2 ;
00323       }
00324     }
00325     s /= 2.0 ;
00326     u1 = guessU - s ;
00327     u2 = guessU + s ;
00328     step = 2.0*s/(T)sep ;
00329     <font class="keywordflow">if</font>(d-d2==0) niter = maxIter ;
00330     <font class="keywordflow">if</font>(step&lt;error) niter = maxIter ;
00331     niter++;
00332   }
00333   <font class="keywordflow">return</font> result ;
00334 }
00335 
00336 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T, <font class="keywordtype">int</font> N&gt;
00337 <font class="keyword">inline</font> T coordValue(CoordinateType coord, <font class="keyword">const</font> Point_nD&lt;T,N&gt;&amp; p){
00338   <font class="keywordflow">switch</font>(coord){
00339   <font class="keywordflow">case</font> coordX: <font class="keywordflow">return</font> p.x() ; <font class="keywordflow">break</font> ;
00340   <font class="keywordflow">case</font> coordY: <font class="keywordflow">return</font> p.y() ; <font class="keywordflow">break</font> ;
00341   <font class="keywordflow">case</font> coordZ: <font class="keywordflow">return</font> p.z() ; <font class="keywordflow">break</font> ;
00342   }
00343   <font class="keywordflow">return</font> 0.0 ; <font class="comment">// elliminates warning messages</font>
00344 }
00345 
00370 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T, <font class="keywordtype">int</font> N&gt;
<a name="l00371"></a><a class="code" href="classPLib_1_1ParaCurve.html#a14" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1ParaCurve.html#a14">00371</a> T ParaCurve&lt;T,N&gt;::extremum(<font class="keywordtype">int</font> findMin, CoordinateType coord, T minDu, <font class="keywordtype">int</font> sep, <font class="keywordtype">int</font> maxIter, T um, T uM)<font class="keyword"> const </font>{
00372   <font class="keywordflow">if</font>(um&lt;0)
00373     um = <a class="code" href="classPLib_1_1ParaCurve.html#a8" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1ParaCurve.html#a8">minKnot</a>() ;
00374   <font class="keywordflow">if</font>(uM&lt;0)
00375     uM = <a class="code" href="classPLib_1_1ParaCurve.html#a9" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1ParaCurve.html#a9">maxKnot</a>() ;
00376 
00377   T c,d,d1,d2,result,guessU ;
00378   Point_nD&lt;T,N&gt; p2 ;
00379   p2 = <a class="code" href="classPLib_1_1ParaCurve.html#a3" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1ParaCurve.html#a3">pointAt</a>(um) ;
00380   c = coordValue(coord,p2) ;
00381   p2 = <a class="code" href="classPLib_1_1ParaCurve.html#a3" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1ParaCurve.html#a3">pointAt</a>(uM) ;
00382   <font class="keywordflow">if</font>(findMin)
00383     c = minimum(c,coordValue(coord,p2)) ;
00384   <font class="keywordflow">else</font>
00385     c = maximum(c,coordValue(coord,p2)) ;
00386   result = c ;
00387   d = minDu*10.0 ;
00388   d2 = d1 = 0 ;
00389   <font class="keywordtype">int</font> niter = 0 ;
00390   T u1,u2 ;
00391   T step ;
00392   T s ;
00393   s = uM - um ;
00394   step = s/(T)(sep+1) ;
00395   u1 = um ;
00396   u2 = uM ;
00397   guessU = um ;
00398   <font class="keywordflow">while</font>(d&gt;minDu &amp;&amp; niter&lt;maxIter) {
00399     <font class="keywordflow">if</font>(u1&lt;um)
00400       u1=um;
00401     <font class="keywordflow">if</font>(u2&gt;uM)
00402       u2 = uM ;
00403     T u = u1 ;
00404     d2 = c ;
00405     d = guessU ;
00406     <font class="keywordflow">for</font>(;u&lt;=u2;u+=step){
00407       p2 = <a class="code" href="classPLib_1_1ParaCurve.html#a3" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1ParaCurve.html#a3">pointAt</a>(u) ;
00408       <font class="keywordflow">if</font>(findMin){
00409         d1 = minimum(c,coordValue(coord,p2)) ;
00410         <font class="keywordflow">if</font>(d1&lt;c){
00411           c = d1 ;
00412           guessU = u ;
00413           result = d1 ;
00414         }
00415       }
00416       <font class="keywordflow">else</font>{
00417         d1 = maximum(c,coordValue(coord,p2)) ;
00418         <font class="keywordflow">if</font>(d1&gt;c){
00419           c = d1 ;
00420           guessU = u ;
00421           result = d1 ;
00422         }
00423       }
00424     }
00425     s /= 2.0 ;
00426     u1 = guessU - s ;
00427     u2 = guessU + s ;
00428     step = 2.0*s/(T)sep ;
00429     <font class="keywordflow">if</font>((c-d2)==0.0) niter = maxIter ;
00430     <font class="keywordflow">if</font>(step&lt;minDu) niter = maxIter ;
00431     d = absolute(guessU-d) ;
00432     niter++;
00433   }
00434   <font class="keywordflow">return</font> result ;
00435 }
00436 
00437 } <font class="comment">// end namespace</font>
00438 
00439 <font class="preprocessor">#endif // #define PLIB_NURBS_CURVE_SOURCE</font>
</pre></div><hr><address><small>Generated on Tue Jun 24 13:26:54 2003 for NURBS++ by
<a href="javascript:if(confirm('http://www.doxygen.org/index.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.doxygen.org/index.html'" tppabs="http://www.doxygen.org/index.html">
<img src="doxygen.gif" tppabs="http://libnurbs.sourceforge.net/docs/doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.14 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2002</small></address>
</body>
</html>
