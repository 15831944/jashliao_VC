<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>hnurbsS.cpp Source File</title>
<link href="doxygen.css" tppabs="http://libnurbs.sourceforge.net/docs/doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.14 -->
<center>
<a class="qindex" href="index.html" tppabs="http://libnurbs.sourceforge.net/docs/index.html">Main Page</a> &nbsp; <a class="qindex" href="hierarchy.html" tppabs="http://libnurbs.sourceforge.net/docs/hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="annotated.html" tppabs="http://libnurbs.sourceforge.net/docs/annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html" tppabs="http://libnurbs.sourceforge.net/docs/files.html">File List</a> &nbsp; <a class="qindex" href="functions.html" tppabs="http://libnurbs.sourceforge.net/docs/functions.html">Compound Members</a> &nbsp; </center>
<hr><h1>hnurbsS.cpp</h1><div class="fragment"><pre>00001 <font class="comment">/*=============================================================================</font>
00002 <font class="comment">        File: hnurbsS.cpp</font>
00003 <font class="comment">     Purpose:       </font>
00004 <font class="comment">    Revision: $Id: hnurbsS.cpp,v 1.3 2002/05/17 18:24:21 philosophil Exp $</font>
00005 <font class="comment">  Created by: Philippe Lavoie    (7 October 1997)</font>
00006 <font class="comment"> Modified by: </font>
00007 <font class="comment"></font>
00008 <font class="comment"> Copyright notice:</font>
00009 <font class="comment">          Copyright (C) 1996-1998 Philippe Lavoie</font>
00010 <font class="comment"> </font>
00011 <font class="comment">          This library is free software; you can redistribute it and/or</font>
00012 <font class="comment">          modify it under the terms of the GNU Library General Public</font>
00013 <font class="comment">          License as published by the Free Software Foundation; either</font>
00014 <font class="comment">          version 2 of the License, or (at your option) any later version.</font>
00015 <font class="comment"> </font>
00016 <font class="comment">          This library is distributed in the hope that it will be useful,</font>
00017 <font class="comment">          but WITHOUT ANY WARRANTY; without even the implied warranty of</font>
00018 <font class="comment">          MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</font>
00019 <font class="comment">          Library General Public License for more details.</font>
00020 <font class="comment"> </font>
00021 <font class="comment">          You should have received a copy of the GNU Library General Public</font>
00022 <font class="comment">          License along with this library; if not, write to the Free</font>
00023 <font class="comment">          Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.</font>
00024 <font class="comment">=============================================================================*/</font>
00025 <font class="preprocessor">#include &lt;hnurbsS.h&gt;</font>
00026 <font class="preprocessor">#include &lt;string.h&gt;</font>
00027 
00030 <font class="keyword">namespace </font>PLib {
00031 
00038 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T, <font class="keywordtype">int</font> N&gt;
<a name="l00039"></a><a class="code" href="classPLib_1_1HNurbsSurface.html#a0" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a0">00039</a> HNurbsSurface&lt;T,N&gt;::HNurbsSurface():NurbsSurface&lt;T,N&gt;(), fixedOffset(0){
00040 
00041   baseLevel_ = 0 ;
00042   nextLevel_ = 0 ;
00043   firstLevel_ = lastLevel_ = <font class="keyword">this</font> ;
00044 
00045   rU.resize(0) ;
00046   rV.resize(0) ;
00047   updateN = 0 ;
00048   baseUpdateN = 0 ;
00049 
00050   level_ = 0 ;
00051 }
00052 
00065 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T, <font class="keywordtype">int</font> N&gt;
<a name="l00066"></a><a class="code" href="classPLib_1_1HNurbsSurface.html#a4" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a4">00066</a> HNurbsSurface&lt;T,N&gt;::HNurbsSurface(HNurbsSurface&lt;T,N&gt;* base, <font class="keyword">const</font> Vector&lt;T&gt;&amp; xU, <font class="keyword">const</font> Vector&lt;T&gt;&amp; xV):NurbsSurface&lt;T,N&gt;(),fixedOffset(0){
00067 
00068   <font class="keywordflow">if</font>(!base){
00069     Error error(<font class="stringliteral">"HNurbsSurface&lt;T,N&gt; constructor"</font>) ;
00070     error &lt;&lt; <font class="stringliteral">"Initializing a HNurbsSurface&lt;T,N&gt; with a null base pointer!"</font> ;
00071     error.fatal() ;
00072   }
00073   <font class="keywordflow">if</font>(base-&gt;nextLevel_){
00074     Error error(<font class="stringliteral">"HNurbsSurface&lt;T,N&gt; constructor"</font>) ;
00075     error &lt;&lt; <font class="stringliteral">"You're trying to replace an existing level, this is not allowed."</font> ;
00076     error.fatal() ;
00077   }
00078 
00079 
00080   nextLevel_ = 0 ;
00081   firstLevel_ = base-&gt;firstLevel_ ;
00082   lastLevel_ = <font class="keyword">this</font> ;
00083   baseLevel_ = (HNurbsSurface&lt;T,N&gt;*)base ;
00084 
00085   <font class="comment">// update the information in the previous levels</font>
00086   baseLevel_-&gt;nextLevel_ = <font class="keyword">this</font> ;
00087   HNurbsSurface&lt;T,N&gt;* l ;
00088   l = baseLevel_ ;
00089   <font class="keywordflow">while</font>(l){
00090     l-&gt;lastLevel_ = <font class="keyword">this</font> ;
00091     l = l-&gt;baseLevel_ ;
00092   }
00093 
00094 
00095   level_ = base-&gt;level_ + 1 ;
00096 
00097   rU = xU ;
00098   rV = xV ;
00099 
00100   updateN = 0 ;
00101   baseUpdateN = baseLevel_-&gt;modifiedN()-1 ; <font class="comment">// Set it so that initBaseLevel will run</font>
00102 
00103   <a class="code" href="classPLib_1_1HNurbsSurface.html#a23" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a23">initBase</a>() ;
00104   offset.resize(baseSurf.ctrlPnts()) ;
00105 
00106   <a class="code" href="classPLib_1_1NurbsSurface.html#n2" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n2">P</a> = baseSurf.ctrlPnts() ;
00107   <a class="code" href="classPLib_1_1NurbsSurface.html#n0" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n0">U</a> = baseSurf.knotU() ;
00108   <a class="code" href="classPLib_1_1NurbsSurface.html#n1" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n1">V</a> = baseSurf.knotV() ;
00109   <a class="code" href="classPLib_1_1NurbsSurface.html#n3" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n3">degU</a> = baseSurf.degreeU() ;
00110   <a class="code" href="classPLib_1_1NurbsSurface.html#n4" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n4">degV</a> = baseSurf.degreeV() ;
00111 
00112   <font class="comment">//updateSurface() ;</font>
00113 
00114 }
00115 
00128 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T, <font class="keywordtype">int</font> N&gt;
<a name="l00129"></a><a class="code" href="classPLib_1_1HNurbsSurface.html#a3" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a3">00129</a> HNurbsSurface&lt;T,N&gt;::HNurbsSurface(HNurbsSurface&lt;T,N&gt;* base):NurbsSurface&lt;T,N&gt;(),fixedOffset(0){
00130 
00131   <font class="keywordflow">if</font>(!base){
00132     Error error(<font class="stringliteral">"HNurbsSurface&lt;T,N&gt; constructor"</font>) ;
00133     error &lt;&lt; <font class="stringliteral">"Initializing a HNurbsSurface&lt;T,N&gt; with a null base pointer!"</font> ;
00134     error.fatal() ;
00135   }
00136   <font class="keywordflow">if</font>(base-&gt;nextLevel_){
00137     Error error(<font class="stringliteral">"HNurbsSurface&lt;T,N&gt; constructor"</font>) ;
00138     error &lt;&lt; <font class="stringliteral">"You're trying to replace an existing level, this is not allowed."</font> ;
00139     error.fatal() ;
00140   }
00141 
00142   nextLevel_ = 0 ;
00143   firstLevel_ = base-&gt;firstLevel_ ;
00144   lastLevel_ = <font class="keyword">this</font> ;
00145   baseLevel_ = (HNurbsSurface&lt;T,N&gt;*)base ;
00146 
00147   <font class="comment">// update the information in the previous levels</font>
00148   baseLevel_-&gt;nextLevel_ = <font class="keyword">this</font> ;
00149   HNurbsSurface&lt;T,N&gt;* l ;
00150   l = baseLevel_ ;
00151   <font class="keywordflow">while</font>(l){
00152     l-&gt;lastLevel_ = <font class="keyword">this</font> ;
00153     l = l-&gt;baseLevel_ ;
00154   }
00155 
00156   level_ = base-&gt;level_ + 1 ;
00157 
00158   updateN = 0 ;
00159   rU.resize(0) ;
00160   rV.resize(0) ;
00161 
00162   baseUpdateN = baseLevel_-&gt;modifiedN()-1 ; <font class="comment">// Set it so that initBase will run</font>
00163   <a class="code" href="classPLib_1_1HNurbsSurface.html#a23" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a23">initBase</a>() ;
00164   offset.resize(baseSurf.ctrlPnts()) ;
00165   <a class="code" href="classPLib_1_1NurbsSurface.html#n2" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n2">P</a> = baseSurf.ctrlPnts() ;
00166   <a class="code" href="classPLib_1_1NurbsSurface.html#n0" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n0">U</a> = baseSurf.knotU() ;
00167   <a class="code" href="classPLib_1_1NurbsSurface.html#n1" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n1">V</a> = baseSurf.knotV() ;
00168   <a class="code" href="classPLib_1_1NurbsSurface.html#n3" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n3">degU</a> = baseSurf.degreeU() ;
00169   <a class="code" href="classPLib_1_1NurbsSurface.html#n4" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n4">degV</a> = baseSurf.degreeV() ;
00170   <font class="comment">//updateSurface() ;</font>
00171 
00172 }
00173 
00189 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T, <font class="keywordtype">int</font> N&gt;
<a name="l00190"></a><a class="code" href="classPLib_1_1HNurbsSurface.html#a1" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a1">00190</a> HNurbsSurface&lt;T,N&gt;::HNurbsSurface(<font class="keyword">const</font> NurbsSurface&lt;T,N&gt;&amp; S):NurbsSurface&lt;T,N&gt;(S),fixedOffset(0){
00191 
00192   baseLevel_ = 0 ;
00193   nextLevel_ = 0 ; 
00194   firstLevel_ = lastLevel_ = <font class="keyword">this</font> ;
00195 
00196   level_ = 0 ;
00197   updateN = 0 ;
00198   baseUpdateN = 0 ;
00199 
00200   rU.resize(0) ;
00201   rV.resize(0) ;
00202 
00203   offset = <a class="code" href="classPLib_1_1NurbsSurface.html#n2" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n2">P</a> ;
00204 }
00205 
00214 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T, <font class="keywordtype">int</font> N&gt;
<a name="l00215"></a><a class="code" href="classPLib_1_1HNurbsSurface.html#a2" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a2">00215</a> HNurbsSurface&lt;T,N&gt;::HNurbsSurface(<font class="keyword">const</font> HNurbsSurface&lt;T,N&gt;&amp; S):NurbsSurface&lt;T,N&gt;(S),fixedOffset(0) {
00216 
00217   baseLevel_ = nextLevel_ = 0 ;
00218   firstLevel_ = lastLevel_ = <font class="keyword">this</font> ;
00219 
00220   level_ = 0 ;
00221   updateN = 0 ;
00222   baseUpdateN = 0 ;
00223 
00224   rU = S.rU ; 
00225   rV = S.rV ; 
00226 
00227   offset = S.offset ;
00228 
00229   this-&gt;<a class="code" href="classPLib_1_1HNurbsSurface.html#a15" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a15">copy</a>(S) ;
00230 
00231 }
00232 
00244 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T, <font class="keywordtype">int</font> N&gt;
<a name="l00245"></a><a class="code" href="classPLib_1_1HNurbsSurface.html#a5" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a5">00245</a> HNurbsSurface&lt;T,N&gt;::HNurbsSurface(HNurbsSurface&lt;T,N&gt; *base, <font class="keyword">const</font> HNurbsSurface&lt;T,N&gt; &amp;surf):NurbsSurface&lt;T,N&gt;(surf),fixedOffset(0) {
00246 
00247   <font class="keywordflow">if</font>(!base){
00248     Error error(<font class="stringliteral">"HNurbsSurface&lt;T,N&gt; constructor"</font>) ;
00249     error &lt;&lt; <font class="stringliteral">"Initializing a HNurbsSurface&lt;T,N&gt; with a null base pointer!"</font> ;
00250     error.fatal() ;
00251   }
00252   <font class="keywordflow">if</font>(base-&gt;nextLevel_){
00253     Error error(<font class="stringliteral">"HNurbsSurface&lt;T,N&gt; constructor"</font>) ;
00254     error &lt;&lt; <font class="stringliteral">"You're trying to replace an existing level, this is not allowed."</font> ;
00255     error.fatal() ;
00256   }
00257 
00258   baseLevel_ = (HNurbsSurface&lt;T,N&gt;*)base ;
00259   nextLevel_ = 0 ;
00260   lastLevel_ = <font class="keyword">this</font> ;
00261 
00262   <font class="comment">// update the information in the previous levels</font>
00263   baseLevel_-&gt;nextLevel_ = <font class="keyword">this</font> ;
00264   HNurbsSurface&lt;T,N&gt;* l ;
00265   l = baseLevel_ ;
00266   <font class="keywordflow">while</font>(l){
00267     l-&gt;lastLevel_ = <font class="keyword">this</font> ;
00268     l = l-&gt;baseLevel_ ;
00269   }
00270 
00271   firstLevel_ = base-&gt;firstLevel_ ;
00272   level_ = base-&gt;level_+1 ;
00273   baseUpdateN = base-&gt;modifiedN()-1 ;
00274 
00275   <a class="code" href="classPLib_1_1HNurbsSurface.html#a23" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a23">initBase</a>() ; 
00276 
00277   updateN = 0 ;
00278 
00279   this-&gt;<a class="code" href="classPLib_1_1HNurbsSurface.html#a15" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a15">copy</a>(surf) ;
00280 
00281 }
00282 
00291 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T, <font class="keywordtype">int</font> N&gt;
<a name="l00292"></a><a class="code" href="classPLib_1_1HNurbsSurface.html#a15" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a15">00292</a> <font class="keywordtype">void</font> HNurbsSurface&lt;T,N&gt;::copy(<font class="keyword">const</font> HNurbsSurface&lt;T,N&gt;&amp; nS){
00293   HNurbsSurface&lt;T,N&gt; *levelP ;
00294   levelP = nS.nextLevel() ;
00295 
00296   NurbsSurface&lt;T,N&gt;::operator=(nS) ;
00297   rU = nS.rU ;
00298   rV = nS.rV ;
00299   offset = nS.offset ;
00300   fixedOffset= nS.fixedOffset ;
00301 
00302   firstLevel_ = <font class="keyword">this</font> ;
00303 
00304   <font class="keywordflow">if</font>(levelP){
00305     HNurbsSurface&lt;T,N&gt; *newLevel = <font class="keyword">new</font> <a class="code" href="classPLib_1_1HNurbsSurface.html#a0" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a0">HNurbsSurface</a>(<font class="keyword">this</font>,*levelP) ;
00306     nextLevel_ = newLevel ;
00307     lastLevel_ = nextLevel_-&gt;lastLevel() ;
00308   }
00309   <font class="keywordflow">else</font>{
00310     lastLevel_ = <font class="keyword">this</font> ;
00311   }
00312 
00313 }
00314 
00329 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T, <font class="keywordtype">int</font> N&gt;
<a name="l00330"></a><a class="code" href="classPLib_1_1HNurbsSurface.html#a24" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a24">00330</a> <font class="keywordtype">void</font> HNurbsSurface&lt;T,N&gt;::updateSurface(<font class="keywordtype">int</font> i0, <font class="keywordtype">int</font> j0){
00331   <font class="keywordflow">if</font>(i0&gt;=0 &amp;&amp; j0&gt;=0){
00332     <font class="keywordflow">if</font>(offset(i0,j0).x()==0.0 &amp;&amp; offset(i0,j0).y()==0.0 &amp;&amp; offset(i0,j0).z()==0.0)
00333       <font class="keywordflow">return</font> ;
00334   }
00335   <font class="keywordflow">if</font>(baseLevel_){
00336     <font class="keywordflow">if</font>(<a class="code" href="classPLib_1_1HNurbsSurface.html#a23" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a23">initBase</a>()){
00337       <a class="code" href="classPLib_1_1NurbsSurface.html#n2" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n2">P</a> = baseSurf.ctrlPnts() ;
00338       <a class="code" href="classPLib_1_1NurbsSurface.html#n0" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n0">U</a> = baseSurf.knotU() ;
00339       <a class="code" href="classPLib_1_1NurbsSurface.html#n1" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n1">V</a> = baseSurf.knotV() ;
00340       <a class="code" href="classPLib_1_1NurbsSurface.html#n3" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n3">degU</a> = baseSurf.degreeU() ;
00341       <a class="code" href="classPLib_1_1NurbsSurface.html#n4" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n4">degV</a> = baseSurf.degreeV() ;
00342     }
00343     <font class="keywordflow">if</font>(i0&gt;=0 &amp;&amp; j0&gt;=0){
00344       Point_nD&lt;T,N&gt; vecOffset ;
00345       <font class="keywordflow">if</font>(fixedOffset){
00346         vecOffset = offset(i0,j0).x()*ivec(0,0) +
00347           offset(i0,j0).y()*jvec(0,0) +
00348           offset(i0,j0).z()*kvec(0,0) ;
00349       }
00350       <font class="keywordflow">else</font>{
00351         vecOffset = offset(i0,j0).x()*ivec(i0,j0) +
00352           offset(i0,j0).y()*jvec(i0,j0) +
00353           offset(i0,j0).z()*kvec(i0,j0) ;
00354       }
00355       <a class="code" href="classPLib_1_1NurbsSurface.html#n2" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n2">P</a>(i0,j0).x() = baseSurf.ctrlPnts()(i0,j0).x()+vecOffset.x() ;
00356       <a class="code" href="classPLib_1_1NurbsSurface.html#n2" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n2">P</a>(i0,j0).y() = baseSurf.ctrlPnts()(i0,j0).y()+vecOffset.y() ;
00357       <a class="code" href="classPLib_1_1NurbsSurface.html#n2" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n2">P</a>(i0,j0).z() = baseSurf.ctrlPnts()(i0,j0).z()+vecOffset.z() ;
00358     }
00359     <font class="keywordflow">else</font>{
00360       <font class="keywordflow">for</font>(<font class="keywordtype">int</font> i=0;i&lt;<a class="code" href="classPLib_1_1NurbsSurface.html#n2" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n2">P</a>.rows();++i)
00361         <font class="keywordflow">for</font>(<font class="keywordtype">int</font> j=0;j&lt;<a class="code" href="classPLib_1_1NurbsSurface.html#n2" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n2">P</a>.cols();++j){
00362           <font class="keywordflow">if</font>(offset(i,j).x() != 0 || 
00363              offset(i,j).y() != 0 || offset(i,j).z() || 0){
00364             Point_nD&lt;T,N&gt; vecOffset ;
00365             <font class="keywordflow">if</font>(fixedOffset){
00366               vecOffset = offset(i,j).x()*ivec(0,0) +
00367                 offset(i,j).y()*jvec(0,0) +
00368                 offset(i,j).z()*kvec(0,0) ;
00369             }
00370             <font class="keywordflow">else</font>{
00371               vecOffset = offset(i,j).x()*ivec(i,j) +
00372                 offset(i,j).y()*jvec(i,j) +
00373                 offset(i,j).z()*kvec(i,j) ;
00374             }
00375             <a class="code" href="classPLib_1_1NurbsSurface.html#n2" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n2">P</a>(i,j).x() = baseSurf.ctrlPnts()(i,j).x()+vecOffset.x() ;
00376             <a class="code" href="classPLib_1_1NurbsSurface.html#n2" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n2">P</a>(i,j).y() = baseSurf.ctrlPnts()(i,j).y()+vecOffset.y() ;
00377             <a class="code" href="classPLib_1_1NurbsSurface.html#n2" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n2">P</a>(i,j).z() = baseSurf.ctrlPnts()(i,j).z()+vecOffset.z() ;
00378           }
00379         }
00380     }
00381   }
00382   <font class="keywordflow">else</font>{
00383     <font class="keywordflow">if</font>(i0&gt;=0 &amp;&amp; j0&gt;=0)
00384       <a class="code" href="classPLib_1_1NurbsSurface.html#n2" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n2">P</a>(i0,j0) = offset(i0,j0) ;
00385     <font class="keywordflow">else</font>{
00386       <font class="keywordflow">for</font>(<font class="keywordtype">int</font> i=0;i&lt;<a class="code" href="classPLib_1_1NurbsSurface.html#n2" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n2">P</a>.rows();++i)
00387         <font class="keywordflow">for</font>(<font class="keywordtype">int</font> j=0;j&lt;<a class="code" href="classPLib_1_1NurbsSurface.html#n2" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n2">P</a>.cols();++j){
00388           <a class="code" href="classPLib_1_1NurbsSurface.html#n2" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n2">P</a>(i,j) = offset(i,j) ;
00389         }
00390     }
00391   }
00392 
00393   ++updateN ;
00394 }
00395 
00396 
00410 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T, <font class="keywordtype">int</font> N&gt;
<a name="l00411"></a><a class="code" href="classPLib_1_1HNurbsSurface.html#a23" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a23">00411</a> <font class="keywordtype">int</font> HNurbsSurface&lt;T,N&gt;::initBase(<font class="keywordtype">int</font> force){
00412   <font class="keywordflow">if</font>(!baseLevel_){
00413     <font class="keywordflow">return</font> 0; <font class="comment">// this means that the surface is the base level</font>
00414   }
00415 
00416   <font class="comment">// make sure none of the base level need updating</font>
00417   <font class="keywordflow">if</font>(baseLevel_-&gt;initBase())
00418     force = 1 ;
00419   
00420 
00421   <font class="comment">// Only initialize the base level if it isn't up to date</font>
00422   <font class="keywordflow">if</font>(baseLevel_-&gt;modifiedN() == baseUpdateN &amp;&amp; !force){
00423     <font class="keywordflow">return</font> 0;
00424   }
00425 
00426   baseUpdateN = baseLevel_-&gt;modifiedN() ;
00427 
00428   baseSurf = *baseLevel_ ;
00429 
00430   <font class="keywordflow">if</font>(rU.n()&gt;0)
00431     baseSurf.refineKnotU(rU) ;
00432   <font class="keywordflow">if</font>(rV.n()&gt;0)
00433     baseSurf.refineKnotV(rV) ;
00434 
00435   Vector&lt;T&gt; maxU,maxV ;
00436   <font class="keywordtype">int</font> i,j ;
00437   
00438   <font class="keywordflow">if</font>(baseSurf.degreeU()&gt;3)
00439     averagingKnots(baseSurf.knotU(),baseSurf.degreeU(),maxU) ;
00440   <font class="keywordflow">else</font>{
00441     maxU.resize(baseSurf.ctrlPnts().rows()) ;
00442     <font class="keywordflow">for</font>(i=0;i&lt;baseSurf.ctrlPnts().rows();++i)
00443       <font class="keywordflow">if</font>(!maxInfluence(i,baseSurf.knotU(),baseSurf.degreeU(),maxU[i]))
00444         cerr &lt;&lt; <font class="stringliteral">"Problem in maxInfluence U!\n"</font> ;
00445   }
00446 
00447   <font class="keywordflow">if</font>(baseSurf.degreeV()&gt;3)
00448     averagingKnots(baseSurf.knotV(),baseSurf.degreeV(),maxV) ;
00449   <font class="keywordflow">else</font>{
00450     maxV.resize(baseSurf.ctrlPnts().cols()) ;
00451     <font class="keywordflow">for</font>(i=0;i&lt;baseSurf.ctrlPnts().cols();++i)
00452       <font class="keywordflow">if</font>(!maxInfluence(i,baseSurf.knotV(),baseSurf.degreeV(),maxV[i]))
00453         cerr &lt;&lt; <font class="stringliteral">"Problem in maxInfluence V!\n"</font> ;
00454   }
00455 
00456   <font class="keywordflow">if</font>(fixedOffset){
00457     <font class="keywordflow">if</font>(ivec.rows() != 1 || ivec.cols()!=1){
00458       ivec.resize(1,1);
00459       jvec.resize(1,1);
00460       kvec.resize(1,1);
00461     }
00462   }
00463   <font class="keywordflow">else</font>{
00464     ivec.resize(maxU.n(),maxV.n()) ;
00465     jvec.resize(maxU.n(),maxV.n()) ;
00466     kvec.resize(maxU.n(),maxV.n()) ;
00467 
00468     Matrix&lt; Point_nD&lt;T,N&gt; &gt; ders ;
00469     
00470     <font class="keywordflow">for</font>(i=0;i&lt;maxU.n();++i)
00471       <font class="keywordflow">for</font>(j=0;j&lt;maxV.n();++j){
00472         baseSurf.deriveAt(maxU[i],maxV[j],1,ders) ;
00473         <font class="comment">// It is possible that there are no valid derivative at that point</font>
00474         <font class="comment">// we then move to a nearby point to get a valid value</font>
00475         Point_nD&lt;T,N&gt; norm = crossProduct(ders(0,1),ders(1,0)) ;
00476         <font class="keywordflow">if</font>(norm.x() == T(0) &amp;&amp;
00477            norm.y() == T(0) &amp;&amp;
00478            norm.z() == T(0)){
00479           <font class="keyword">const</font> T delta = 0.00001 ;
00480           T nt = 1.0 ; 
00481           Matrix&lt; Point_nD&lt;T,N&gt; &gt; dersT(ders) ;
00482           <font class="keywordflow">while</font>(norm.x() == T(0) &amp;&amp; 
00483                 norm.y() == T(0) &amp;&amp;
00484                 norm.z() == T(0)){
00485             <font class="keywordflow">if</font>( nt*delta &gt;(baseSurf.knotU()[baseSurf.knotU().n()-1]-baseSurf.knotU()[0])){
00486               Error error(<font class="stringliteral">"initBase"</font>);
00487               error &lt;&lt; <font class="stringliteral">"Can't compute the derivative.\n"</font> ;
00488               error.fatal() ;
00489             }
00490             T nd ;
00491             
00492             ders.reset(0) ;
00493             
00494             nd = 0 ;
00495             <font class="keywordflow">if</font>(i != 0){
00496               baseSurf.deriveAt(maxU[i] - nt*delta, maxV[j],1, dersT) ;
00497               ders += dersT ;
00498               ++nd ;
00499             }
00500             <font class="keywordflow">if</font>(i != maxU.n()-1){
00501               baseSurf.deriveAt(maxU[i] + nt*delta, maxV[j],1, dersT) ;
00502               ders += dersT ;
00503               ++nd ;
00504             }
00505             <font class="keywordflow">if</font>(j != 0){
00506               baseSurf.deriveAt(maxU[i], maxV[j] - nt*delta,1, dersT) ;
00507               ders += dersT ;
00508               ++nd ;
00509             }
00510             <font class="keywordflow">if</font>(j != maxV.n()-1){
00511               baseSurf.deriveAt(maxU[i], maxV[j] + nt*delta,1, dersT) ;
00512               ders += dersT ;
00513               ++nd ;
00514             }
00515             
00516             <font class="keywordflow">if</font>(nd==0){
00517               Error error(<font class="stringliteral">"initBase"</font>);
00518               error &lt;&lt; <font class="stringliteral">"Can't compute the derivative.\n"</font> ;
00519               error.fatal() ;
00520             }
00521             
00522             ders /= nd ;
00523             
00524             norm = crossProduct(ders(0,1),ders(1,0)) ;
00525             nt *= 10.0 ; 
00526           }
00527         }       
00528         
00529         ivec(i,j) = ders(0,1).unitLength() ;
00530         kvec(i,j) = crossProduct(ders(0,1),ders(1,0)).unitLength() ;
00531         jvec(i,j) = crossProduct(kvec(i,j),ivec(i,j)).unitLength() ;
00532       }
00533   }
00534     
00535   <font class="keywordflow">return</font> 1 ;
00536 }
00537 
00549 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T, <font class="keywordtype">int</font> N&gt;
<a name="l00550"></a><a class="code" href="classPLib_1_1HNurbsSurface.html#a16" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a16">00550</a> <font class="keywordtype">int</font> HNurbsSurface&lt;T,N&gt;::modifies(T u, T v){
00551   <font class="keywordflow">if</font>(nextLevel_){
00552     <font class="keywordtype">int</font> mod = nextLevel_-&gt;modifies(u,v) ;
00553     <font class="keywordflow">if</font>(mod&gt;=0)
00554       <font class="keywordflow">return</font> mod ;
00555   }
00556 
00557   <font class="keywordflow">if</font>(u&lt;knotU()[0] || u&gt;<a class="code" href="classPLib_1_1NurbsSurface.html#a5" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#a5">knotU</a>()[<a class="code" href="classPLib_1_1NurbsSurface.html#a5" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#a5">knotU</a>().n()-1])
00558     <font class="keywordflow">return</font> -1 ;
00559   <font class="keywordflow">if</font>(v&lt;knotV()[0] || v&gt;<a class="code" href="classPLib_1_1NurbsSurface.html#a5" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#a5">knotU</a>()[<a class="code" href="classPLib_1_1NurbsSurface.html#a6" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#a6">knotV</a>().n()-1])
00560     <font class="keywordflow">return</font> -1 ;
00561 
00562   <font class="keywordtype">int</font> su = <a class="code" href="classPLib_1_1NurbsSurface.html#a46" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#a46">findSpanU</a>(u) ;
00563   <font class="keywordtype">int</font> sv = <a class="code" href="classPLib_1_1NurbsSurface.html#a47" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#a47">findSpanV</a>(v) ;
00564 
00565   <font class="keywordflow">for</font>(<font class="keywordtype">int</font> i=0;i&lt;=<a class="code" href="classPLib_1_1NurbsSurface.html#n3" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n3">degU</a>;++i)
00566     <font class="keywordflow">for</font>(<font class="keywordtype">int</font> j=0;j&lt;=<a class="code" href="classPLib_1_1NurbsSurface.html#n4" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n4">degV</a>;++j){
00567       <font class="keywordflow">if</font>(offset(su-<a class="code" href="classPLib_1_1NurbsSurface.html#n3" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n3">degU</a>+i,sv+<a class="code" href="classPLib_1_1NurbsSurface.html#n4" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n4">degV</a>+j) != HPoint_nD&lt;T,N&gt;(0,0,0,0))
00568         <font class="keywordflow">return</font> level_ ;
00569     }
00570 
00571   <font class="keywordflow">return</font> -1 ;
00572 }
00573 
00587 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T, <font class="keywordtype">int</font> N&gt;
<a name="l00588"></a><a class="code" href="classPLib_1_1HNurbsSurface.html#a18" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a18">00588</a> HPoint_nD&lt;T,N&gt; HNurbsSurface&lt;T,N&gt;::hpointAt(T u, T v, <font class="keywordtype">int</font> lod)<font class="keyword"> const </font>{
00589   <font class="keywordflow">if</font>(level_==lod)
00590     <font class="keywordflow">return</font> NurbsSurface&lt;T,N&gt;::operator()(u,v) ;
00591 
00592   <font class="keywordflow">if</font>(nextLevel_)
00593     <font class="keywordflow">return</font> nextLevel_-&gt;hpointAt(u,v,lod) ; 
00594   
00595   <font class="keywordflow">return</font> NurbsSurface&lt;T,N&gt;::operator()(u,v) ;
00596 }
00597 
00609 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T, <font class="keywordtype">int</font> N&gt;
<a name="l00610"></a><a class="code" href="classPLib_1_1HNurbsSurface.html#a33" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a33">00610</a> <font class="keywordtype">int</font> HNurbsSurface&lt;T,N&gt;::maxLevel()<font class="keyword"> const</font>{
00611   <font class="keywordflow">if</font>(lastLevel_)
00612     <font class="keywordflow">return</font> lastLevel_-&gt;level_ ;
00613   <font class="keywordflow">return</font> level_ ; 
00614 }
00615 
00631 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T, <font class="keywordtype">int</font> N&gt;
<a name="l00632"></a><a class="code" href="classPLib_1_1HNurbsSurface.html#a19" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a19">00632</a> <font class="keywordtype">void</font> HNurbsSurface&lt;T,N&gt;::deriveAtH(T u, T v, <font class="keywordtype">int</font> d, Matrix&lt; HPoint_nD&lt;T,N&gt; &gt;&amp; ders,<font class="keywordtype">int</font> lod)<font class="keyword"> const </font>{
00633   <font class="keywordflow">if</font>(level_==lod){
00634     NurbsSurface&lt;T,N&gt;::deriveAtH(u,v,d,ders) ;
00635     <font class="keywordflow">return</font> ;
00636   }
00637 
00638   <font class="keywordflow">if</font>(nextLevel_){
00639     nextLevel_-&gt;deriveAtH(u,v,d,ders,lod) ; 
00640     <font class="keywordflow">return</font> ;
00641   }
00642   
00643   NurbsSurface&lt;T,N&gt;::deriveAtH(u,v,d,ders) ;
00644 }
00645 
00661 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T, <font class="keywordtype">int</font> N&gt;
<a name="l00662"></a><a class="code" href="classPLib_1_1HNurbsSurface.html#a20" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a20">00662</a> <font class="keywordtype">void</font> HNurbsSurface&lt;T,N&gt;::deriveAt(T u, T v, <font class="keywordtype">int</font> d, Matrix&lt; Point_nD&lt;T,N&gt; &gt;&amp; ders, <font class="keywordtype">int</font> lod)<font class="keyword"> const </font>{
00663   <font class="keywordflow">if</font>(level_==lod){
00664     NurbsSurface&lt;T,N&gt;::deriveAt(u,v,d,ders) ;
00665     <font class="keywordflow">return</font> ;
00666   }
00667 
00668   <font class="keywordflow">if</font>(nextLevel_){
00669     nextLevel_-&gt;deriveAt(u,v,d,ders,lod) ; 
00670     <font class="keywordflow">return</font> ;
00671 
00672   NurbsSurface&lt;T,N&gt;::deriveAt(u,v,d,ders) ;
00673   }
00674 }
00675 
00684 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T, <font class="keywordtype">int</font> N&gt;
<a name="l00685"></a><a class="code" href="classPLib_1_1HNurbsSurface.html#a6" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a6">00685</a> HNurbsSurface&lt;T,N&gt;::~HNurbsSurface(){
00686   <font class="keywordflow">if</font>(nextLevel_)
00687     <font class="keyword">delete</font> nextLevel_ ;
00688   lastLevel_ = 0 ;
00689   <font class="keywordflow">if</font>(baseLevel_){
00690     baseLevel_-&gt;nextLevel_ = 0 ;
00691     baseLevel_-&gt;lastLevel_ = baseLevel_ ;
00692   }
00693   baseLevel_ = 0 ;
00694   nextLevel_ = 0 ;
00695   firstLevel_ = 0 ;
00696 }
00697 
00706 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T, <font class="keywordtype">int</font> N&gt;
<a name="l00707"></a><a class="code" href="classPLib_1_1HNurbsSurface.html#a25" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a25">00707</a> <font class="keywordtype">void</font> HNurbsSurface&lt;T,N&gt;::updateLevels(<font class="keywordtype">int</font> upLevel){
00708   <font class="keywordflow">if</font>(upLevel&gt;=0){
00709     <font class="keywordflow">if</font>(level_ &lt;= upLevel){
00710       this-&gt;<a class="code" href="classPLib_1_1HNurbsSurface.html#a24" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a24">updateSurface</a>() ;
00711     }
00712   }
00713   <font class="keywordflow">else</font>{
00714     this-&gt;<a class="code" href="classPLib_1_1HNurbsSurface.html#a24" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a24">updateSurface</a>() ;
00715   }
00716 
00717   <font class="keywordflow">if</font>(upLevel&gt;level() || upLevel&lt;0){
00718     <font class="keywordflow">if</font>(nextLevel_)
00719       nextLevel_-&gt;updateLevels(upLevel) ;
00720   }
00721 }
00722 
00742 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T, <font class="keywordtype">int</font> N&gt;
<a name="l00743"></a><a class="code" href="classPLib_1_1HNurbsSurface.html#a11" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a11">00743</a> <font class="keywordtype">void</font> HNurbsSurface&lt;T,N&gt;::splitUV(<font class="keywordtype">int</font> nu, <font class="keywordtype">int</font> nv, Vector&lt;T&gt; &amp;nU, Vector&lt;T&gt; &amp;nV){
00744 
00745   nU.resize(<a class="code" href="classPLib_1_1NurbsSurface.html#a5" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#a5">knotU</a>().n()*nu) ;
00746   nV.resize(<a class="code" href="classPLib_1_1NurbsSurface.html#a6" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#a6">knotV</a>().n()*nv) ;
00747   
00748   <font class="keywordtype">int</font> i,j,n ;
00749 
00750   n = 0 ; 
00751   <font class="keywordflow">for</font>(i=1;i&lt;<a class="code" href="classPLib_1_1NurbsSurface.html#a5" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#a5">knotU</a>().n();++i){
00752     <font class="keywordflow">if</font>(<a class="code" href="classPLib_1_1NurbsSurface.html#a5" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#a5">knotU</a>()[i] &gt;<a class="code" href="classPLib_1_1NurbsSurface.html#a5" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#a5">knotU</a>()[i-1]){
00753       T a = <a class="code" href="classPLib_1_1NurbsSurface.html#a5" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#a5">knotU</a>()[i-1] ;
00754       T b = <a class="code" href="classPLib_1_1NurbsSurface.html#a5" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#a5">knotU</a>()[i] ;
00755 
00756 
00757       <font class="keywordflow">for</font>(j=0;j&lt;nu;++j){
00758         nU[n] = a + (b-a)*T(j+1)/T(nu+1) ;
00759         ++n ;
00760       }
00761     }
00762   }  
00763   nU.resize(n) ;
00764 
00765   n = 0 ;
00766   <font class="keywordflow">for</font>(i=1;i&lt;<a class="code" href="classPLib_1_1NurbsSurface.html#a6" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#a6">knotV</a>().n();++i){
00767     <font class="keywordflow">if</font>(<a class="code" href="classPLib_1_1NurbsSurface.html#a6" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#a6">knotV</a>()[i] &gt; <a class="code" href="classPLib_1_1NurbsSurface.html#a6" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#a6">knotV</a>()[i-1]){
00768       T a = <a class="code" href="classPLib_1_1NurbsSurface.html#a6" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#a6">knotV</a>()[i-1] ;
00769       T b = <a class="code" href="classPLib_1_1NurbsSurface.html#a6" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#a6">knotV</a>()[i] ;
00770 
00771       <font class="keywordflow">for</font>(j=0;j&lt;nv;++j){
00772         nV[n] = a + (b-a)*T(j+1)/T(nv+1) ;
00773         ++n ;
00774       }
00775     }
00776   }  
00777   nV.resize(n) ;
00778 
00779 }
00780  
00802 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T, <font class="keywordtype">int</font> N&gt;
<a name="l00803"></a><a class="code" href="classPLib_1_1HNurbsSurface.html#a12" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a12">00803</a> <font class="keywordtype">void</font> HNurbsSurface&lt;T,N&gt;::splitUV(<font class="keywordtype">int</font> nu, <font class="keywordtype">int</font> su, <font class="keywordtype">int</font> nv, <font class="keywordtype">int</font> sv, Vector&lt;T&gt; &amp;nU, Vector&lt;T&gt; &amp;nV){
00804 
00805   <font class="keywordtype">int</font> i,j,n ;
00806 
00807   <font class="keywordflow">if</font>(su&lt;=0)
00808     su = <a class="code" href="classPLib_1_1NurbsSurface.html#n3" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n3">degU</a>  ;
00809   <font class="keywordflow">if</font>(sv&lt;=0)
00810     sv = <a class="code" href="classPLib_1_1NurbsSurface.html#n4" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n4">degV</a>  ;
00811   <font class="keywordflow">if</font>(su&gt;<a class="code" href="classPLib_1_1NurbsSurface.html#n3" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n3">degU</a>+1)
00812     su = <a class="code" href="classPLib_1_1NurbsSurface.html#n3" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n3">degU</a>+1 ;
00813   <font class="keywordflow">if</font>(sv&gt;<a class="code" href="classPLib_1_1NurbsSurface.html#n4" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n4">degV</a>+1)
00814     sv = <a class="code" href="classPLib_1_1NurbsSurface.html#n4" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n4">degV</a>+1 ;
00815 
00816   nU.resize(<a class="code" href="classPLib_1_1NurbsSurface.html#a5" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#a5">knotU</a>().n()*nu*su) ;
00817   nV.resize(<a class="code" href="classPLib_1_1NurbsSurface.html#a6" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#a6">knotV</a>().n()*nv*sv) ;
00818   
00819   n = 0 ; 
00820   <font class="keywordflow">for</font>(i=1;i&lt;<a class="code" href="classPLib_1_1NurbsSurface.html#a5" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#a5">knotU</a>().n();++i){
00821     <font class="keywordflow">if</font>(<a class="code" href="classPLib_1_1NurbsSurface.html#a5" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#a5">knotU</a>()[i] &gt;<a class="code" href="classPLib_1_1NurbsSurface.html#a5" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#a5">knotU</a>()[i-1]){
00822       T a = <a class="code" href="classPLib_1_1NurbsSurface.html#a5" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#a5">knotU</a>()[i-1] ;
00823       T b = <a class="code" href="classPLib_1_1NurbsSurface.html#a5" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#a5">knotU</a>()[i] ;
00824 
00825 
00826       <font class="keywordflow">for</font>(j=0;j&lt;nu;++j){
00827         T u = a + (b-a)*T(j+1)/T(nu+1) ;
00828         <font class="keywordflow">for</font>(<font class="keywordtype">int</font> l=0;l&lt;su;++l){
00829           nU[n] = u ;
00830           ++n ;
00831         }
00832       }
00833     }
00834   }  
00835   nU.resize(n) ;
00836 
00837   n = 0 ;
00838   <font class="keywordflow">for</font>(i=1;i&lt;<a class="code" href="classPLib_1_1NurbsSurface.html#a6" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#a6">knotV</a>().n();++i){
00839     <font class="keywordflow">if</font>(<a class="code" href="classPLib_1_1NurbsSurface.html#a6" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#a6">knotV</a>()[i] &gt; <a class="code" href="classPLib_1_1NurbsSurface.html#a6" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#a6">knotV</a>()[i-1]){
00840       T a = <a class="code" href="classPLib_1_1NurbsSurface.html#a6" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#a6">knotV</a>()[i-1] ;
00841       T b = <a class="code" href="classPLib_1_1NurbsSurface.html#a6" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#a6">knotV</a>()[i] ;
00842 
00843       <font class="keywordflow">for</font>(j=0;j&lt;nv;++j){
00844         T v = a + (b-a)*T(j+1)/T(nv+1) ;
00845         <font class="keywordflow">for</font>(<font class="keywordtype">int</font> l=0;l&lt;sv;++l){
00846           nV[n] = v ;
00847           ++n ;
00848         }
00849       }
00850     }
00851   }  
00852   nV.resize(n) ;
00853 
00854 }
00855  
00868 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T, <font class="keywordtype">int</font> N&gt;
<a name="l00869"></a><a class="code" href="classPLib_1_1HNurbsSurface.html#a13" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a13">00869</a> HNurbsSurface&lt;T,N&gt;* HNurbsSurface&lt;T,N&gt;::addLevel(<font class="keywordtype">int</font> n) {
00870   HNurbsSurface&lt;T,N&gt; *newLevel ;
00871 
00872   <font class="keywordflow">if</font>(nextLevel_)
00873     <font class="keywordflow">return</font> 0 ;
00874 
00875   Vector&lt;T&gt; newU,newV ;
00876   
00877   <a class="code" href="classPLib_1_1HNurbsSurface.html#a11" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a11">splitUV</a>(n,n,newU,newV) ;
00878 
00879   newLevel = <font class="keyword">new</font> <a class="code" href="classPLib_1_1HNurbsSurface.html#a0" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a0">HNurbsSurface</a>(<font class="keyword">this</font>,newU,newV) ;
00880 
00881   <font class="keywordflow">return</font> newLevel ;
00882 }
00883 
00896 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T, <font class="keywordtype">int</font> N&gt;
<a name="l00897"></a><a class="code" href="classPLib_1_1HNurbsSurface.html#a14" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a14">00897</a> HNurbsSurface&lt;T,N&gt;* HNurbsSurface&lt;T,N&gt;::addLevel() {
00898   HNurbsSurface&lt;T,N&gt; *newLevel ;
00899 
00900   <font class="keywordflow">if</font>(nextLevel_)
00901     <font class="keywordflow">return</font> 0 ;
00902 
00903   newLevel = <font class="keyword">new</font> <a class="code" href="classPLib_1_1HNurbsSurface.html#a0" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a0">HNurbsSurface</a>(<font class="keyword">this</font>) ;
00904 
00905   <font class="keywordflow">return</font> newLevel ;
00906 }
00907 
00925 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T, <font class="keywordtype">int</font> N&gt;
<a name="l00926"></a><a class="code" href="classPLib_1_1HNurbsSurface.html#a26" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a26">00926</a> <font class="keywordtype">int</font> HNurbsSurface&lt;T,N&gt;::isoCurveU(T u, NurbsCurve&lt;T,N&gt;&amp; c,<font class="keywordtype">int</font> lod)<font class="keyword"> const </font>{
00927   <font class="keywordflow">if</font>(lod&gt;=0 &amp;&amp; level_&gt;lod)
00928     <font class="keywordflow">return</font> 0;
00929 
00930   <font class="keywordflow">if</font>(lod==level_ || lod&lt;0){
00931     NurbsSurface&lt;T,N&gt;::isoCurveU(u,c) ; 
00932     <font class="keywordflow">return</font> 1 ;
00933   }
00934   
00935   <font class="keywordflow">if</font>(nextLevel_){
00936     <font class="keywordflow">return</font> nextLevel_-&gt;isoCurveU(u,c,lod) ;
00937   }
00938 
00939   <font class="keywordflow">return</font> 0 ;
00940 }
00941 
00958 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T, <font class="keywordtype">int</font> N&gt;
<a name="l00959"></a><a class="code" href="classPLib_1_1HNurbsSurface.html#a27" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a27">00959</a> <font class="keywordtype">int</font> HNurbsSurface&lt;T,N&gt;::isoCurveV(T v, NurbsCurve&lt;T,N&gt;&amp; c,<font class="keywordtype">int</font> lod)<font class="keyword"> const </font>{
00960   <font class="keywordflow">if</font>(lod&gt;=0 &amp;&amp; level_&gt;lod)
00961     <font class="keywordflow">return</font> 0;
00962 
00963   <font class="keywordflow">if</font>(lod==level_ || lod&lt;0){
00964     NurbsSurface&lt;T,N&gt;::isoCurveV(v,c) ; 
00965     <font class="keywordflow">return</font> 1 ;
00966   }
00967   
00968   <font class="keywordflow">if</font>(nextLevel_){
00969     <font class="keywordflow">return</font> nextLevel_-&gt;isoCurveV(v,c,lod) ;
00970   }
00971 
00972   <font class="keywordflow">return</font> 0 ;
00973 }
00974 
00975 
00976 
00987 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T, <font class="keywordtype">int</font> N&gt;
<a name="l00988"></a><a class="code" href="classPLib_1_1HNurbsSurface.html#a30" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a30">00988</a> <font class="keywordtype">int</font> HNurbsSurface&lt;T,N&gt;::read(ifstream &amp;fin){
00989   <font class="keywordflow">if</font>(!fin) {
00990     <font class="keywordflow">return</font> 0 ;
00991   }
00992   <font class="keywordtype">int</font> nu,nv,du,dv;
00993   <font class="keywordtype">char</font> *type ;
00994   type = <font class="keyword">new</font> <font class="keywordtype">char</font>[4] ;
00995   <font class="keywordflow">if</font>(!fin.read(type,<font class="keyword">sizeof</font>(<font class="keywordtype">char</font>)*4)) { <font class="keyword">delete</font> []type ; <font class="keywordflow">return</font> 0 ;}
00996   <font class="keywordtype">int</font> r1 = strncmp(type,<font class="stringliteral">"hns3"</font>,4) ;
00997   <font class="keywordtype">int</font> r2 = strncmp(type,<font class="stringliteral">"hns4"</font>,4) ;
00998   <font class="keywordtype">int</font> r3 = strncmp(type,<font class="stringliteral">"hnso"</font>,4) ;
00999   <font class="keywordflow">if</font>(!(r1 || r2 || r3)) 
01000     <font class="keywordflow">return</font> 0 ;
01001   T *p,*p2 ;
01002   <font class="keywordtype">char</font> stc ; 
01003   <font class="keywordflow">if</font>(!r1 || !r2){
01004     <font class="keywordflow">if</font>(!fin.read((<font class="keywordtype">char</font>*)&amp;stc,<font class="keyword">sizeof</font>(<font class="keywordtype">char</font>))) { <font class="keyword">delete</font> []type ; <font class="keywordflow">return</font> 0 ;}
01005 
01006     <font class="keywordtype">int</font> st = stc - <font class="charliteral">'0'</font> ; 
01007     <font class="keywordflow">if</font>(st != <font class="keyword">sizeof</font>(T)){ <font class="comment">// does not have the same data size</font>
01008       <font class="keyword">delete</font> []type ;
01009       <font class="keywordflow">return</font> 0 ; 
01010     }
01011 
01012     <font class="keywordflow">if</font>(!fin.read((<font class="keywordtype">char</font>*)&amp;nu,<font class="keyword">sizeof</font>(<font class="keywordtype">int</font>))) { <font class="keyword">delete</font> []type ; <font class="keywordflow">return</font> 0 ;}
01013     <font class="keywordflow">if</font>(!fin.read((<font class="keywordtype">char</font>*)&amp;nv,<font class="keyword">sizeof</font>(<font class="keywordtype">int</font>))) { <font class="keyword">delete</font> []type ; <font class="keywordflow">return</font> 0 ;}
01014     <font class="keywordflow">if</font>(!fin.read((<font class="keywordtype">char</font>*)&amp;du,<font class="keyword">sizeof</font>(<font class="keywordtype">int</font>))) { <font class="keyword">delete</font> []type ; <font class="keywordflow">return</font> 0 ;}
01015     <font class="keywordflow">if</font>(!fin.read((<font class="keywordtype">char</font>*)&amp;dv,<font class="keyword">sizeof</font>(<font class="keywordtype">int</font>))) { <font class="keyword">delete</font> []type ; <font class="keywordflow">return</font> 0 ;}
01016     
01017     <a class="code" href="classPLib_1_1NurbsSurface.html#a15" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#a15">resize</a>(nu,nv,du,dv) ;
01018     
01019     <font class="keywordflow">if</font>(!fin.read((<font class="keywordtype">char</font>*)<a class="code" href="classPLib_1_1NurbsSurface.html#n0" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n0">U</a>.memory(),<font class="keyword">sizeof</font>(T)*<a class="code" href="classPLib_1_1NurbsSurface.html#n0" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n0">U</a>.n())) { <font class="keyword">delete</font> []type ; <font class="keywordflow">return</font> 0 ;}
01020     <font class="keywordflow">if</font>(!fin.read((<font class="keywordtype">char</font>*)<a class="code" href="classPLib_1_1NurbsSurface.html#n1" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n1">V</a>.memory(),<font class="keyword">sizeof</font>(T)*<a class="code" href="classPLib_1_1NurbsSurface.html#n1" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n1">V</a>.n())) { <font class="keyword">delete</font> []type ; <font class="keywordflow">return</font> 0 ;}
01021     
01022     <font class="keywordflow">if</font>(!r1){
01023       p = <font class="keyword">new</font> T[3*nu*nv] ;
01024       <font class="keywordflow">if</font>(!fin.read((<font class="keywordtype">char</font>*)p,<font class="keyword">sizeof</font>(T)*3*nu*nv)) { <font class="keyword">delete</font> []type ; <font class="keywordflow">return</font> 0 ;}
01025       p2 = p ;
01026       <font class="keywordflow">for</font>(<font class="keywordtype">int</font> i=0;i&lt;nu;i++)
01027         <font class="keywordflow">for</font>(<font class="keywordtype">int</font> j=0;j&lt;nv;j++){
01028           <a class="code" href="classPLib_1_1NurbsSurface.html#n2" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n2">P</a>(i,j).x() = *(p++) ;
01029           <a class="code" href="classPLib_1_1NurbsSurface.html#n2" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n2">P</a>(i,j).y() = *(p++) ;
01030           <a class="code" href="classPLib_1_1NurbsSurface.html#n2" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n2">P</a>(i,j).z() = *(p++) ;
01031           <a class="code" href="classPLib_1_1NurbsSurface.html#n2" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n2">P</a>(i,j).w() = 1.0 ;
01032         }
01033       <font class="keyword">delete</font> []p2 ;
01034     }
01035     <font class="keywordflow">else</font>{
01036       p = <font class="keyword">new</font> T[4*nu*nv] ;
01037       <font class="keywordflow">if</font>(!fin.read((<font class="keywordtype">char</font>*)p,<font class="keyword">sizeof</font>(T)*4*nu*nv)) { <font class="keyword">delete</font> []type ; <font class="keywordflow">return</font> 0 ;}
01038       p2 = p ;
01039       <font class="keywordflow">for</font>(<font class="keywordtype">int</font> i=0;i&lt;nu;i++)
01040         <font class="keywordflow">for</font>(<font class="keywordtype">int</font> j=0;j&lt;nv;j++){
01041           <a class="code" href="classPLib_1_1NurbsSurface.html#n2" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n2">P</a>(i,j).x() = *(p++) ;
01042           <a class="code" href="classPLib_1_1NurbsSurface.html#n2" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n2">P</a>(i,j).y() = *(p++) ;
01043           <a class="code" href="classPLib_1_1NurbsSurface.html#n2" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n2">P</a>(i,j).z() = *(p++) ;
01044           <a class="code" href="classPLib_1_1NurbsSurface.html#n2" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n2">P</a>(i,j).w() = *(p++) ;
01045         }
01046       <font class="keyword">delete</font> []p2 ;
01047     }
01048     offset = <a class="code" href="classPLib_1_1NurbsSurface.html#n2" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n2">P</a> ;
01049     this-&gt;<a class="code" href="classPLib_1_1HNurbsSurface.html#a24" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a24">updateSurface</a>() ;
01050   }
01051   <font class="keywordflow">else</font> { <font class="comment">// reading the offset information</font>
01052     <font class="keywordtype">int</font> ru,rv ;
01053     <font class="keywordflow">if</font>(!fin.read((<font class="keywordtype">char</font>*)&amp;ru,<font class="keyword">sizeof</font>(<font class="keywordtype">int</font>))) { <font class="keyword">delete</font> []type ; <font class="keywordflow">return</font> 0 ;}
01054     <font class="keywordflow">if</font>(!fin.read((<font class="keywordtype">char</font>*)&amp;rv,<font class="keyword">sizeof</font>(<font class="keywordtype">int</font>))) { <font class="keyword">delete</font> []type ; <font class="keywordflow">return</font> 0 ;}
01055     rU.resize(ru) ;
01056     rV.resize(rv) ;
01057     <font class="keywordflow">if</font>(rU.n()&gt;0)
01058       <font class="keywordflow">if</font>(!fin.read((<font class="keywordtype">char</font>*)rU.memory(),<font class="keyword">sizeof</font>(T)*rU.n())) { <font class="keyword">delete</font> []type ; <font class="keywordflow">return</font> 0 ;}
01059     <font class="keywordflow">if</font>(rV.n()&gt;0)
01060       <font class="keywordflow">if</font>(!fin.read((<font class="keywordtype">char</font>*)rV.memory(),<font class="keyword">sizeof</font>(T)*rV.n())) { <font class="keyword">delete</font> []type ; <font class="keywordflow">return</font> 0 ;}
01061     
01062     <font class="keywordflow">if</font>(!fin.read((<font class="keywordtype">char</font>*)&amp;nu,<font class="keyword">sizeof</font>(<font class="keywordtype">int</font>))) { <font class="keyword">delete</font> []type ; <font class="keywordflow">return</font> 0 ;}
01063     <font class="keywordflow">if</font>(!fin.read((<font class="keywordtype">char</font>*)&amp;nv,<font class="keyword">sizeof</font>(<font class="keywordtype">int</font>))) { <font class="keyword">delete</font> []type ; <font class="keywordflow">return</font> 0 ;}
01064 
01065     p = <font class="keyword">new</font> T[4*nu*nv] ;
01066     <font class="keywordflow">if</font>(!fin.read((<font class="keywordtype">char</font>*)p,<font class="keyword">sizeof</font>(T)*4*nu*nv)) { <font class="keyword">delete</font> []type ; <font class="keywordflow">return</font> 0 ;}
01067     p2 = p ;
01068     offset.resize(nu,nv) ;
01069     <font class="keywordflow">for</font>(<font class="keywordtype">int</font> i=0;i&lt;nu;i++)
01070       <font class="keywordflow">for</font>(<font class="keywordtype">int</font> j=0;j&lt;nv;j++){
01071         offset(i,j).x() = *(p++) ;
01072         offset(i,j).y() = *(p++) ;
01073         offset(i,j).z() = *(p++) ;
01074         offset(i,j).w() = *(p++) ;
01075       }
01076     <font class="keyword">delete</font> []p2 ;    
01077     --baseUpdateN ;
01078     this-&gt;<a class="code" href="classPLib_1_1HNurbsSurface.html#a24" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a24">updateSurface</a>() ;
01079   }
01080 
01081   <font class="comment">// now we must read all the level information (if any)</font>
01082   <font class="keywordtype">char</font> *ptxt ;
01083   ptxt = <font class="keyword">new</font> <font class="keywordtype">char</font>[7] ;
01084   <font class="comment">// the following line is used so that purify doesn't give a warning</font>
01085   ptxt[0] = ptxt[1] = ptxt[2] = ptxt[3] = ptxt[4] = ptxt[5] = ptxt[6] = 0 ;
01086   <font class="keywordtype">int</font> mark  = fin.tellg() ;
01087   <font class="keywordflow">if</font>(!fin.read(ptxt,<font class="keyword">sizeof</font>(<font class="keywordtype">char</font>)*5))
01088     { <font class="keyword">delete</font> []ptxt ; <font class="keyword">delete</font> []type ; <font class="keywordflow">return</font> 1 ; }
01089   <font class="keywordtype">char</font> *pat ;
01090   pat = strstr(ptxt,<font class="stringliteral">"level"</font>) ;
01091   <font class="keywordflow">if</font>(pat){
01092     <font class="comment">// insert a new level</font>
01093     HNurbsSurface&lt;T,N&gt; *newPatch = this-&gt;<a class="code" href="classPLib_1_1HNurbsSurface.html#a14" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a14">addLevel</a>() ;
01094     <font class="keywordflow">if</font>(newPatch){
01095       <font class="keywordflow">if</font>(!newPatch-&gt;read(fin)) 
01096         <font class="keywordflow">return</font> 0 ;      
01097     }
01098     <font class="keywordflow">else</font>
01099       <font class="keywordflow">return</font> 0 ;
01100   }
01101   <font class="keywordflow">else</font>{ 
01102     <font class="comment">// something else is after the HNurbs</font>
01103     <font class="comment">// restore were the file was before the read</font>
01104     fin.seekg(mark);
01105   }
01106 
01107   <font class="keyword">delete</font> []ptxt ;
01108   <font class="keyword">delete</font> []type ;
01109   <font class="keywordflow">return</font> 1 ;
01110 }
01111 
01122 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T, <font class="keywordtype">int</font> N&gt;
<a name="l01123"></a><a class="code" href="classPLib_1_1HNurbsSurface.html#a28" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a28">01123</a> <font class="keywordtype">int</font> HNurbsSurface&lt;T,N&gt;::read(<font class="keyword">const</font> <font class="keywordtype">char</font>* filename){
01124   ifstream fin(filename) ;
01125   <font class="keywordflow">if</font>(!fin) {
01126     <font class="keywordflow">return</font> 0 ;
01127   }
01128 
01129   <font class="keywordflow">return</font> this-&gt;<a class="code" href="classPLib_1_1HNurbsSurface.html#a28" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a28">read</a>(fin) ;
01130 }
01131 
01142 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T, <font class="keywordtype">int</font> N&gt;
<a name="l01143"></a><a class="code" href="classPLib_1_1HNurbsSurface.html#a31" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a31">01143</a> <font class="keywordtype">int</font> HNurbsSurface&lt;T,N&gt;::write(ofstream &amp;fout)<font class="keyword"> const </font>{
01144   <font class="keywordflow">if</font>(!fout)
01145     <font class="keywordflow">return</font> 0 ;
01146   <font class="keywordflow">if</font>(!baseLevel_){
01147     <font class="keywordtype">int</font> prows = <a class="code" href="classPLib_1_1NurbsSurface.html#n2" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n2">P</a>.rows();
01148     <font class="keywordtype">int</font> pcols = <a class="code" href="classPLib_1_1NurbsSurface.html#n2" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n2">P</a>.cols();
01149     <font class="keywordtype">char</font> st = <font class="charliteral">'0'</font> + <font class="keyword">sizeof</font>(T) ; 
01150     <font class="keywordflow">if</font>(!fout.write((<font class="keywordtype">char</font>*)&amp;<font class="stringliteral">"hns4"</font>,<font class="keyword">sizeof</font>(<font class="keywordtype">char</font>)*4)) <font class="keywordflow">return</font> 0 ;
01151     <font class="keywordflow">if</font>(!fout.write((<font class="keywordtype">char</font>*)&amp;st,<font class="keyword">sizeof</font>(<font class="keywordtype">char</font>))) <font class="keywordflow">return</font> 0 ; 
01152     <font class="keywordflow">if</font>(!fout.write((<font class="keywordtype">char</font>*)&amp;prows,<font class="keyword">sizeof</font>(<font class="keywordtype">int</font>))) <font class="keywordflow">return</font> 0 ;
01153     <font class="keywordflow">if</font>(!fout.write((<font class="keywordtype">char</font>*)&amp;pcols,<font class="keyword">sizeof</font>(<font class="keywordtype">int</font>))) <font class="keywordflow">return</font> 0 ;
01154     <font class="keywordflow">if</font>(!fout.write((<font class="keywordtype">char</font>*)&amp;<a class="code" href="classPLib_1_1NurbsSurface.html#n3" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n3">degU</a>,<font class="keyword">sizeof</font>(<font class="keywordtype">int</font>))) <font class="keywordflow">return</font> 0 ;
01155     <font class="keywordflow">if</font>(!fout.write((<font class="keywordtype">char</font>*)&amp;<a class="code" href="classPLib_1_1NurbsSurface.html#n4" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n4">degV</a>,<font class="keyword">sizeof</font>(<font class="keywordtype">int</font>))) <font class="keywordflow">return</font> 0 ;
01156     <font class="keywordflow">if</font>(!fout.write((<font class="keywordtype">char</font>*)<a class="code" href="classPLib_1_1NurbsSurface.html#n0" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n0">U</a>.memory(),<font class="keyword">sizeof</font>(T)*<a class="code" href="classPLib_1_1NurbsSurface.html#n0" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n0">U</a>.n())) <font class="keywordflow">return</font> 0 ;
01157     <font class="keywordflow">if</font>(!fout.write((<font class="keywordtype">char</font>*)<a class="code" href="classPLib_1_1NurbsSurface.html#n1" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n1">V</a>.memory(),<font class="keyword">sizeof</font>(T)*<a class="code" href="classPLib_1_1NurbsSurface.html#n1" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n1">V</a>.n())) <font class="keywordflow">return</font> 0 ;
01158     
01159     T *p,*p2 ;
01160     p = <font class="keyword">new</font> T[<a class="code" href="classPLib_1_1NurbsSurface.html#n2" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n2">P</a>.rows()*<a class="code" href="classPLib_1_1NurbsSurface.html#n2" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n2">P</a>.cols()*4] ;
01161     p2 = p ;
01162     <font class="keywordflow">for</font>(<font class="keywordtype">int</font> i=0;i&lt;<a class="code" href="classPLib_1_1NurbsSurface.html#n2" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n2">P</a>.rows();i++) 
01163       <font class="keywordflow">for</font>(<font class="keywordtype">int</font> j=0;j&lt;<a class="code" href="classPLib_1_1NurbsSurface.html#n2" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n2">P</a>.cols();j++){
01164         *p = offset(i,j).x() ; p++ ;
01165         *p = offset(i,j).y() ; p++ ;
01166         *p = offset(i,j).z() ; p++ ;
01167         *p = offset(i,j).w() ; p++ ;
01168       }
01169     <font class="keywordflow">if</font>(!fout.write((<font class="keywordtype">char</font>*)p2,<font class="keyword">sizeof</font>(T)*<a class="code" href="classPLib_1_1NurbsSurface.html#n2" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n2">P</a>.rows()*<a class="code" href="classPLib_1_1NurbsSurface.html#n2" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n2">P</a>.cols()*4)) <font class="keywordflow">return</font> 0 ;
01170     <font class="keyword">delete</font> []p2 ;
01171   }
01172   <font class="keywordflow">else</font>{
01173     <font class="keywordflow">if</font>(!fout.write((<font class="keywordtype">char</font>*)&amp;<font class="stringliteral">"hnso"</font>,<font class="keyword">sizeof</font>(<font class="keywordtype">char</font>)*4)) <font class="keywordflow">return</font> 0 ;
01174     <font class="keywordtype">int</font> run = rU.n();
01175     <font class="keywordtype">int</font> rvn = rV.n();
01176     <font class="keywordflow">if</font>(!fout.write((<font class="keywordtype">char</font>*)&amp;run,<font class="keyword">sizeof</font>(<font class="keywordtype">int</font>))) <font class="keywordflow">return</font> 0 ;
01177     <font class="keywordflow">if</font>(!fout.write((<font class="keywordtype">char</font>*)&amp;rvn,<font class="keyword">sizeof</font>(<font class="keywordtype">int</font>))) <font class="keywordflow">return</font> 0 ;
01178     <font class="keywordflow">if</font>(rU.n()&gt;0)
01179       <font class="keywordflow">if</font>(!fout.write((<font class="keywordtype">char</font>*)rU.memory(),<font class="keyword">sizeof</font>(T)*rU.n())) <font class="keywordflow">return</font> 0 ;
01180     <font class="keywordflow">if</font>(rV.n()&gt;0)
01181       <font class="keywordflow">if</font>(!fout.write((<font class="keywordtype">char</font>*)rV.memory(),<font class="keyword">sizeof</font>(T)*rV.n())) <font class="keywordflow">return</font> 0 ;
01182     <font class="keywordtype">int</font> orows = offset.rows();
01183     <font class="keywordtype">int</font> ocols = offset.cols() ;
01184     <font class="keywordflow">if</font>(!fout.write((<font class="keywordtype">char</font>*)&amp;orows,<font class="keyword">sizeof</font>(<font class="keywordtype">int</font>))) <font class="keywordflow">return</font> 0 ;
01185     <font class="keywordflow">if</font>(!fout.write((<font class="keywordtype">char</font>*)&amp;ocols,<font class="keyword">sizeof</font>(<font class="keywordtype">int</font>))) <font class="keywordflow">return</font> 0 ;
01186     T *p,*p2 ;
01187 
01188     p = <font class="keyword">new</font> T[offset.rows()*offset.cols()*4] ;
01189     p2 = p ;
01190     <font class="keywordflow">for</font>(<font class="keywordtype">int</font> i=0;i&lt;offset.rows();i++) 
01191       <font class="keywordflow">for</font>(<font class="keywordtype">int</font> j=0;j&lt;offset.cols();j++){
01192         *p = offset(i,j).x() ; p++ ;
01193         *p = offset(i,j).y() ; p++ ;
01194         *p = offset(i,j).z() ; p++ ;
01195         *p = offset(i,j).w() ; p++ ;
01196       }
01197     <font class="keywordflow">if</font>(!fout.write((<font class="keywordtype">char</font>*)p2,<font class="keyword">sizeof</font>(T)*offset.rows()*offset.cols()*4)) 
01198       <font class="keywordflow">return</font> 0 ;
01199     <font class="keyword">delete</font> []p2 ;    
01200   }
01201   <font class="keywordflow">if</font>(nextLevel_){
01202     <font class="keywordflow">if</font>(!fout.write((<font class="keywordtype">char</font>*)&amp;<font class="stringliteral">"level"</font>,<font class="keyword">sizeof</font>(<font class="keywordtype">char</font>)*5)) <font class="keywordflow">return</font> 0 ;
01203     <font class="keywordflow">if</font>(!nextLevel_-&gt;write(fout)) <font class="keywordflow">return</font> 0 ;
01204   }
01205   <font class="keywordflow">return</font> 1 ;
01206 }
01207 
01218 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T, <font class="keywordtype">int</font> N&gt;
<a name="l01219"></a><a class="code" href="classPLib_1_1HNurbsSurface.html#a29" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a29">01219</a> <font class="keywordtype">int</font> HNurbsSurface&lt;T,N&gt;::write(<font class="keyword">const</font> <font class="keywordtype">char</font>* filename)<font class="keyword"> const </font>{
01220   ofstream fout(filename) ;    
01221   <font class="keywordflow">if</font>(!fout)
01222     <font class="keywordflow">return</font> 0 ;
01223   <font class="keywordflow">return</font> <a class="code" href="classPLib_1_1HNurbsSurface.html#a29" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a29">write</a>(fout);
01224 }
01225 
01235 <font class="comment">//template &lt;class T, int N&gt;</font>
01236 <font class="comment">//void HNurbsSurface&lt;T,N&gt;::toNurbs(NurbsSurface&lt;T,N&gt;&amp; surf) const {</font>
01237   
01238 <font class="comment">//}</font>
01239 
01240 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T&gt;
01241 <font class="keyword">inline</font> <font class="keywordtype">void</font> mergeInto(<font class="keyword">const</font> Vector&lt;T&gt; &amp;a, Vector&lt;T&gt; &amp;b) {
01242   <font class="comment">// merge a in b ;</font>
01243   <font class="keywordtype">int</font> n = b.n() ;
01244   b.resize(b.n()+a.n()) ;  
01245   <font class="keywordflow">for</font>(<font class="keywordtype">int</font> i=0;i&lt;a.n();++i)
01246     b[n+i] = a[i] ;
01247   b.qSort() ;
01248 }
01249 
01259 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T, <font class="keywordtype">int</font> N&gt;
<a name="l01260"></a><a class="code" href="classPLib_1_1HNurbsSurface.html#a35" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a35">01260</a> <font class="keywordtype">void</font> HNurbsSurface&lt;T,N&gt;::refineKnots(<font class="keyword">const</font> Vector&lt;T&gt;&amp; nU, <font class="keyword">const</font> Vector&lt;T&gt;&amp; nV){
01261   <a class="code" href="classPLib_1_1HNurbsSurface.html#a36" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a36">refineKnotU</a>(nU) ;
01262   mergeInto(nU,rU) ;
01263 
01264   <a class="code" href="classPLib_1_1HNurbsSurface.html#a23" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a23">initBase</a>(1) ;
01265 
01266   <a class="code" href="classPLib_1_1HNurbsSurface.html#a37" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a37">refineKnotV</a>(nV) ;  
01267   mergeInto(nV,rV) ;
01268 }
01269 
01278 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T, <font class="keywordtype">int</font> N&gt;
<a name="l01279"></a><a class="code" href="classPLib_1_1HNurbsSurface.html#a36" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a36">01279</a> <font class="keywordtype">void</font> HNurbsSurface&lt;T,N&gt;::refineKnotU(<font class="keyword">const</font> Vector&lt;T&gt;&amp; X) {
01280   <a class="code" href="classPLib_1_1HNurbsSurface.html#a24" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a24">updateSurface</a>() ;
01281   Vector&lt;T&gt; Xu(X) ;
01282   <font class="keywordtype">int</font> i,j ;
01283   j = 0 ;
01284   <font class="keywordflow">for</font>(i=0;i&lt;X.n();++i){
01285     <font class="keywordflow">if</font>(X[i]&gt;=<a class="code" href="classPLib_1_1NurbsSurface.html#n0" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n0">U</a>[0] &amp;&amp; X[i]&lt;=<a class="code" href="classPLib_1_1NurbsSurface.html#n0" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n0">U</a>[<a class="code" href="classPLib_1_1NurbsSurface.html#n0" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n0">U</a>.n()-1]){
01286       Xu[j] = X[i] ;
01287       ++j ;
01288     }
01289   }
01290   Xu.resize(j) ;
01291 
01292   <font class="keywordflow">if</font>(Xu.n()&gt;0){
01293     <font class="keywordflow">if</font>(nextLevel_){
01294       nextLevel_-&gt;refineKnotU(Xu) ;
01295     }
01296     
01297     NurbsSurface&lt;T,N&gt; osurf(<a class="code" href="classPLib_1_1NurbsSurface.html#n3" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n3">degU</a>,<a class="code" href="classPLib_1_1NurbsSurface.html#n4" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n4">degV</a>,<a class="code" href="classPLib_1_1NurbsSurface.html#n0" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n0">U</a>,<a class="code" href="classPLib_1_1NurbsSurface.html#n1" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n1">V</a>,offset) ;
01298     
01299     osurf.refineKnotU(Xu) ;
01300     
01301     offset.resize(osurf.ctrlPnts().rows(),osurf.ctrlPnts().cols()) ;
01302     <font class="keywordflow">for</font>(i=0;i&lt;offset.rows();++i)
01303       <font class="keywordflow">for</font>(j=0;j&lt;offset.cols();++j)
01304         offset(i,j) = osurf.ctrlPnts()(i,j) ;
01305 
01306     <font class="keywordflow">if</font>(!baseLevel_){
01307       NurbsSurface&lt;T,N&gt;::refineKnotU(Xu) ;
01308     }
01309   }
01310 }
01311 
01320 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T, <font class="keywordtype">int</font> N&gt;
<a name="l01321"></a><a class="code" href="classPLib_1_1HNurbsSurface.html#a37" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a37">01321</a> <font class="keywordtype">void</font> HNurbsSurface&lt;T,N&gt;::refineKnotV(<font class="keyword">const</font> Vector&lt;T&gt;&amp; X) {
01322   <a class="code" href="classPLib_1_1HNurbsSurface.html#a24" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a24">updateSurface</a>() ;
01323   Vector&lt;T&gt; Xv(X) ;
01324   <font class="keywordtype">int</font> i,j ;
01325   j = 0 ;
01326   <font class="keywordflow">for</font>(i=0;i&lt;X.n();++i){
01327     <font class="keywordflow">if</font>(X[i]&gt;=<a class="code" href="classPLib_1_1NurbsSurface.html#n1" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n1">V</a>[0] &amp;&amp; X[i]&lt;=<a class="code" href="classPLib_1_1NurbsSurface.html#n1" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n1">V</a>[<a class="code" href="classPLib_1_1NurbsSurface.html#n1" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n1">V</a>.n()-1]){
01328       Xv[j] = X[i] ;
01329       ++j ;
01330     }
01331   }
01332   Xv.resize(j) ;
01333 
01334   <font class="keywordflow">if</font>(Xv.n()&gt;0){
01335     <font class="keywordflow">if</font>(nextLevel_){
01336       nextLevel_-&gt;refineKnotV(Xv) ;
01337     }
01338     
01339     NurbsSurface&lt;T,N&gt; osurf(<a class="code" href="classPLib_1_1NurbsSurface.html#n3" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n3">degU</a>,<a class="code" href="classPLib_1_1NurbsSurface.html#n4" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n4">degV</a>,<a class="code" href="classPLib_1_1NurbsSurface.html#n0" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n0">U</a>,<a class="code" href="classPLib_1_1NurbsSurface.html#n1" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n1">V</a>,offset) ;
01340     
01341     osurf.refineKnotV(Xv) ;
01342     
01343     offset.resize(osurf.ctrlPnts().rows(),osurf.ctrlPnts().cols()) ;
01344     <font class="keywordflow">for</font>(i=0;i&lt;offset.rows();++i)
01345       <font class="keywordflow">for</font>(j=0;j&lt;offset.cols();++j)
01346         offset(i,j) = osurf.ctrlPnts()(i,j) ;
01347     <font class="keywordflow">if</font>(!baseLevel_){
01348       NurbsSurface&lt;T,N&gt;::refineKnotV(Xv) ;
01349     }
01350   }
01351 }
01352 
01371 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T, <font class="keywordtype">int</font> N&gt;
<a name="l01372"></a><a class="code" href="classPLib_1_1HNurbsSurface.html#a21" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a21">01372</a> <font class="keywordtype">int</font> HNurbsSurface&lt;T,N&gt;::movePointOffset(T u, T v, <font class="keyword">const</font> Point_nD&lt;T,N&gt;&amp; delta){
01373   <a class="code" href="classPLib_1_1NurbsSurface.html#n2" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n2">P</a> = offset ; 
01374 
01375   <font class="comment">// by definition the offset has w = 0 , but this isn't valid for</font>
01376   <font class="comment">// the control points, increasing the w by 1, will generate a valid surface</font>
01377   <font class="keywordflow">if</font>(baseLevel_)
01378     <font class="keywordflow">for</font>(<font class="keywordtype">int</font> i=0;i&lt;<a class="code" href="classPLib_1_1NurbsSurface.html#n2" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n2">P</a>.rows();++i)
01379       <font class="keywordflow">for</font>(<font class="keywordtype">int</font> j=0;j&lt;<a class="code" href="classPLib_1_1NurbsSurface.html#n2" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n2">P</a>.cols();++j){
01380         <a class="code" href="classPLib_1_1NurbsSurface.html#n2" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n2">P</a>(i,j).w() += T(1) ; 
01381       }
01382 
01383   <font class="keywordflow">if</font>(NurbsSurface&lt;T,N&gt;::movePoint(u,v,delta)){
01384     offset = <a class="code" href="classPLib_1_1NurbsSurface.html#n2" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n2">P</a> ;
01385     <font class="comment">// need to reset the offset weights</font>
01386     <font class="keywordflow">if</font>(baseLevel_)
01387       <font class="keywordflow">for</font>(<font class="keywordtype">int</font> i=0;i&lt;<a class="code" href="classPLib_1_1NurbsSurface.html#n2" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n2">P</a>.rows();++i)
01388         <font class="keywordflow">for</font>(<font class="keywordtype">int</font> j=0;j&lt;<a class="code" href="classPLib_1_1NurbsSurface.html#n2" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n2">P</a>.cols();++j){
01389           <a class="code" href="classPLib_1_1NurbsSurface.html#n2" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n2">P</a>(i,j).w() -= T(1) ; 
01390       }
01391     
01392     <a class="code" href="classPLib_1_1NurbsSurface.html#n2" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1NurbsSurface.html#n2">P</a> = baseSurf.ctrlPnts() ; 
01393     <a class="code" href="classPLib_1_1HNurbsSurface.html#a24" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a24">updateSurface</a>() ; 
01394     <font class="keywordflow">return</font> 1 ;
01395   }
01396   <a class="code" href="classPLib_1_1HNurbsSurface.html#a24" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a24">updateSurface</a>() ; 
01397   <font class="keywordflow">return</font> 0 ;
01398 }
01399 
01408 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T, <font class="keywordtype">int</font> N&gt;
<a name="l01409"></a><a class="code" href="classPLib_1_1HNurbsSurface.html#a22" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a22">01409</a> <font class="keywordtype">void</font> HNurbsSurface&lt;T,N&gt;::scale(<font class="keyword">const</font> Point_nD&lt;T,N&gt;&amp; s){
01410   <font class="keywordflow">for</font>(<font class="keywordtype">int</font> i=0;i&lt;offset.rows();++i)
01411     <font class="keywordflow">for</font>(<font class="keywordtype">int</font> j=0;j&lt;offset.cols();++j){
01412       offset(i,j).x() *= s.x() ; 
01413       offset(i,j).y() *= s.y() ; 
01414       offset(i,j).z() *= s.z() ; 
01415     }
01416 
01417   <font class="keywordflow">if</font>(nextLevel_){
01418     nextLevel_-&gt;scale(s) ; 
01419   }
01420 }
01421 
01422 
01436 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T, <font class="keywordtype">int</font> N&gt;
<a name="l01437"></a><a class="code" href="classPLib_1_1HNurbsSurface.html#a39" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a39">01437</a> <font class="keywordtype">void</font> HNurbsSurface&lt;T,N&gt;::setFixedOffsetVector(<font class="keyword">const</font> Point_nD&lt;T,N&gt; &amp;I, <font class="keyword">const</font> Point_nD&lt;T,N&gt; &amp;J, <font class="keyword">const</font> Point_nD&lt;T,N&gt;&amp; K){
01438   fixedOffset = 1;
01439   <a class="code" href="classPLib_1_1HNurbsSurface.html#a23" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a23">initBase</a>();
01440   ivec(0,0) = I;
01441   jvec(0,0) = J;
01442   kvec(0,0) = K;
01443   <a class="code" href="classPLib_1_1HNurbsSurface.html#a24" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a24">updateSurface</a>();
01444 }
01445 
01456 <font class="keyword">template</font> &lt;<font class="keyword">class</font> T, <font class="keywordtype">int</font> N&gt;
<a name="l01457"></a><a class="code" href="classPLib_1_1HNurbsSurface.html#a40" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a40">01457</a> <font class="keywordtype">void</font> HNurbsSurface&lt;T,N&gt;::setVariableOffsetVector(){
01458   fixedOffset = 0 ; 
01459   <a class="code" href="classPLib_1_1HNurbsSurface.html#a23" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a23">initBase</a>();
01460   <a class="code" href="classPLib_1_1HNurbsSurface.html#a24" tppabs="http://libnurbs.sourceforge.net/docs/classPLib_1_1HNurbsSurface.html#a24">updateSurface</a>();
01461 }
01462 
01463 } <font class="comment">//end namespace</font>
</pre></div><hr><address><small>Generated on Tue Jun 24 13:26:55 2003 for NURBS++ by
<a href="javascript:if(confirm('http://www.doxygen.org/index.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.doxygen.org/index.html'" tppabs="http://www.doxygen.org/index.html">
<img src="doxygen.gif" tppabs="http://libnurbs.sourceforge.net/docs/doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.14 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2002</small></address>
</body>
</html>
