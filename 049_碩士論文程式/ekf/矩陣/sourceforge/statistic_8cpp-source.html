<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>statistic.cpp Source File</title>
<link href="doxygen.css" tppabs="http://libnurbs.sourceforge.net/docs/doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.14 -->
<center>
<a class="qindex" href="index.html" tppabs="http://libnurbs.sourceforge.net/docs/index.html">Main Page</a> &nbsp; <a class="qindex" href="hierarchy.html" tppabs="http://libnurbs.sourceforge.net/docs/hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="annotated.html" tppabs="http://libnurbs.sourceforge.net/docs/annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html" tppabs="http://libnurbs.sourceforge.net/docs/files.html">File List</a> &nbsp; <a class="qindex" href="functions.html" tppabs="http://libnurbs.sourceforge.net/docs/functions.html">Compound Members</a> &nbsp; </center>
<hr><h1>statistic.cpp</h1><div class="fragment"><pre>00001 
00002 <font class="preprocessor">#ifndef Statistic_SOURCE</font>
00003 <font class="preprocessor"></font><font class="preprocessor">#define Statistic_SOURCE</font>
00004 <font class="preprocessor"></font>
00005 <font class="preprocessor">#include "statistic.h"</font>
00006 <font class="preprocessor">#include &lt;cmath&gt;</font>
00007 
00010 <font class="keyword">namespace </font>PLib {
00011 
00012   <font class="keywordtype">void</font> initStatistic(){
00013     MaximumIterations = 100 ; 
00014   }
00015 
00021   <font class="keyword">template</font> &lt;<font class="keyword">class</font> T&gt;
00022     T lnOfGamma(T xx)
00023     {
00024       <font class="keywordtype">double</font> x,y,tmp,ser;
00025       <font class="keyword">static</font> <font class="keywordtype">double</font> cof[6] = { 76.18009172947146, -86.50532032941677,
00026                                24.01409824083091, -1.231739572450155,
00027                                0.1208650973866179e-2,-0.5395239384953e-5};
00028       <font class="keywordtype">int</font> j;
00029       y=x=xx;
00030       tmp=x+5.5 ;
00031       tmp -= (x+0.5)*log(tmp);
00032       ser=1.000000000190015;
00033       <font class="keywordflow">for</font>(j=0;j&lt;=5;++j) ser += cof[j]/++y ;
00034       <font class="keywordflow">return</font> T(-tmp+log(2.5066282746310005*ser/x));
00035     }
00036  
00037   <font class="keyword">template</font> &lt;<font class="keyword">class</font> T&gt;
00038     T factorial(<font class="keywordtype">int</font> n)
00039     {
00040       <font class="keyword">static</font> <font class="keywordtype">int</font> ntop=4;
00041       <font class="keyword">static</font> T a[33] = {1.0,1.0,2.0,6.0,24.0} ;
00042       <font class="keywordflow">if</font>(n&lt;0){
00043 <font class="preprocessor">#ifdef USE_EXCEPTION       </font>
00044 <font class="preprocessor"></font>        <font class="keywordflow">throw</font> MatrixInputError();
00045 <font class="preprocessor">#else</font>
00046 <font class="preprocessor"></font>        Error error(<font class="stringliteral">"factorial"</font>);
00047         error &lt;&lt; <font class="stringliteral">"The input value was lower than 0.\n"</font> ;
00048         error.fatal();
00049 <font class="preprocessor">#endif</font>
00050 <font class="preprocessor"></font>      }
00051       <font class="keywordflow">if</font>(n&gt;32)
00052         <font class="keywordflow">return</font> exp(lnOfGamma(n+1.0));
00053       <font class="keywordflow">while</font>(ntop&lt;n){
00054         <font class="keywordtype">int</font> j=ntop++;
00055         a[ntop]=a[j]*ntop ;
00056       }
00057       <font class="keywordflow">return</font> a[n] ;
00058     }
00059 
00060   <font class="keyword">template</font> &lt;<font class="keyword">class</font> T&gt;
00061     T binomialCoefficient(<font class="keywordtype">int</font> n, <font class="keywordtype">int</font> k)
00062     {
00063       <font class="keywordflow">return</font> (T)floor(0.5+exp(lnOfFactorial&lt;T&gt;(k)-lnOfFactorial&lt;T&gt;(n-k)));
00064     }
00065 
00066   <font class="keyword">template</font> &lt;<font class="keyword">class</font> T&gt;
00067     T lnOfFactorial(<font class="keywordtype">int</font> n)
00068     {
00069       <font class="keyword">static</font> T a[101] ;
00070       <font class="keywordflow">if</font>(n&lt;0){
00071 <font class="preprocessor">#ifdef USE_EXCEPTION       </font>
00072 <font class="preprocessor"></font>        <font class="keywordflow">throw</font> MatrixInputError();
00073 <font class="preprocessor">#else</font>
00074 <font class="preprocessor"></font>        Error error(<font class="stringliteral">"lnOfFactorial"</font>);
00075         error &lt;&lt; <font class="stringliteral">"The input value was lower than 0.\n"</font> ;
00076         error.fatal();
00077 <font class="preprocessor">#endif</font>
00078 <font class="preprocessor"></font>      }
00079       <font class="keywordflow">if</font>(n&lt;=1) <font class="keywordflow">return</font> 0;
00080       <font class="keywordflow">if</font>(n &lt;= 100) 
00081         <font class="keywordflow">return</font> a[n] ? a[n] : (a[n] = lnOfGamma(n+1.0)) ;
00082       <font class="keywordflow">return</font> lnOfGamma(n+1.0) ; <font class="comment">// out of range of table</font>
00083     }
00084   
00085   <font class="keyword">template</font> &lt;<font class="keyword">class</font> T&gt;
00086     T beta(T z, T w)
00087     {
00088       <font class="keywordflow">return</font> exp(lnOfGamma(z)+lnOfGamma(w)-lnOfGamma(z+w));
00089     }
00090 
00091   <font class="keyword">template</font> &lt;<font class="keyword">class</font> T&gt; 
00092     T gammaP(T a, T x)
00093     {
00094       T gamser, gammcf, gln ;
00095       <font class="keywordflow">if</font>(x &lt; 0 || a &lt;= 0){
00096 <font class="preprocessor">#ifdef USE_EXCEPTION       </font>
00097 <font class="preprocessor"></font>        <font class="keywordflow">throw</font> MatrixInputError();
00098 <font class="preprocessor">#else</font>
00099 <font class="preprocessor"></font>        Error error(<font class="stringliteral">"gammaP"</font>);
00100         error &lt;&lt; <font class="stringliteral">"Invalid arguments to the incomplete gamma function.\n"</font> ;
00101         error.fatal();
00102 <font class="preprocessor">#endif</font>
00103 <font class="preprocessor"></font>      }
00104       <font class="keywordflow">if</font>(x &lt; (a+1)){
00105         <font class="keywordflow">return</font> gammaSerie(a,x,gln);
00106       }
00107       <font class="keywordflow">return</font> 1.0-gammaSerieCF(a,x,gln);
00108     }
00109 
00110   <font class="keyword">template</font> &lt;<font class="keyword">class</font> T&gt;
00111     T gammaQ(T a, T x)
00112     {
00113       T gamser, gammcf, gln ;
00114       <font class="keywordflow">if</font>(x &lt; 0 || a &lt;= 0){
00115 <font class="preprocessor">#ifdef USE_EXCEPTION       </font>
00116 <font class="preprocessor"></font>        <font class="keywordflow">throw</font> MatrixInputError();
00117 <font class="preprocessor">#else</font>
00118 <font class="preprocessor"></font>        Error error(<font class="stringliteral">"gammaQ"</font>);
00119         error &lt;&lt; <font class="stringliteral">"Invalid arguments to the incomplete gamma function.\n"</font> ;
00120         error.fatal();
00121 <font class="preprocessor">#endif</font>
00122 <font class="preprocessor"></font>      }
00123       <font class="keywordflow">if</font>(x &lt; (a+1)){
00124         <font class="keywordflow">return</font> 1.0-gammaSerie(a,x,gln);
00125       }
00126       <font class="keywordflow">return</font> gammaSerieCF(a,x,gln);
00127     }
00128 
00129   <font class="keyword">template</font> &lt;<font class="keyword">class</font> T&gt;
00130     T gammaSerie(T a, T x, T&amp; gln)
00131     {
00132       <font class="keywordtype">int</font> n;
00133       T sum, del, ap;
00134       gln=lnOfGamma(a);
00135       <font class="keywordflow">if</font>(x&lt;0){
00136 <font class="preprocessor">#ifdef USE_EXCEPTION       </font>
00137 <font class="preprocessor"></font>        <font class="keywordflow">throw</font> MatrixInputError();
00138 <font class="preprocessor">#else</font>
00139 <font class="preprocessor"></font>        Error error(<font class="stringliteral">"gammaSerie"</font>);
00140         error &lt;&lt; <font class="stringliteral">"x can't be negative.\n"</font> ;
00141         error.fatal();
00142         <font class="keywordflow">return</font> 0; 
00143 <font class="preprocessor">#endif</font>
00144 <font class="preprocessor"></font>      }
00145       
00146       ap = a ;
00147       del= sum = T(1)/a;
00148       <font class="keywordflow">for</font>(n=MaximumIterations;n&gt;0;--n){
00149         ++ap;
00150         del *= x/ap ;
00151         sum += del ;
00152         <font class="keywordflow">if</font>(absolute(del)&lt; absolute(sum)*Precision&lt;T&gt;())
00153           <font class="keywordflow">return</font> sum*exp(-x+a*log(x)-gln) ;
00154       }
00155 <font class="preprocessor">#ifdef USING_EXCEPTION</font>
00156 <font class="preprocessor"></font>      <font class="keywordflow">throw</font> MatrixErr();
00157 <font class="preprocessor">#else</font>
00158 <font class="preprocessor"></font>      Error error(<font class="stringliteral">"gammaSerie"</font>);
00159       error &lt;&lt; <font class="stringliteral">"a too large or MaximumIterations too small.\n"</font> ;
00160       error.fatal();
00161       <font class="keywordflow">return</font> 0;
00162 <font class="preprocessor">#endif</font>
00163 <font class="preprocessor"></font>    }
00164 
00165   <font class="keyword">template</font> &lt;<font class="keyword">class</font> T&gt;
00166     T gammaSerieCF(T a, T x, T&amp; gln)
00167     {
00168       <font class="keywordtype">int</font> i;
00169       T an,b,c,d,del,h;
00170 
00171       gln=lnOfGamma(a);
00172 
00173       b= x + 1.0 - a;
00174       c= T(1)/MinimumFloat&lt;T&gt;();
00175       d= T(1)/b ;
00176       h= d ;
00177       <font class="keywordflow">for</font>(i=1;i&lt;=MaximumIterations;++i){
00178         an = -T(i)*T(i-a);
00179         b += 2 ;
00180         d = an*d + b ;
00181         <font class="keywordflow">if</font>(absolute(d) &lt; MinimumFloat&lt;T&gt;() )
00182           d = MinimumFloat&lt;T&gt;();
00183         c = b + an/c ;
00184         <font class="keywordflow">if</font>(absolute(c) &lt; MinimumFloat&lt;T&gt;() )
00185           c = MinimumFloat&lt;T&gt;();
00186         d=T(1)/d ;
00187         del=d*c;
00188         h *= del ;
00189         <font class="keywordflow">if</font>(absolute(del-1.0) &lt; Precision&lt;T&gt;()) <font class="keywordflow">break</font> ;
00190         
00191       }
00192 
00193       <font class="keywordflow">if</font>(i&gt;MaximumIterations){
00194 <font class="preprocessor">#ifdef USING_EXCEPTION</font>
00195 <font class="preprocessor"></font>        <font class="keywordflow">throw</font> MatrixErr();
00196 <font class="preprocessor">#else</font>
00197 <font class="preprocessor"></font>        Error error(<font class="stringliteral">"gammaSerie"</font>);
00198         error &lt;&lt; <font class="stringliteral">"a too large or MaximumIterations too small.\n"</font> ;
00199         error.fatal();
00200         <font class="keywordflow">return</font> 0;
00201 <font class="preprocessor">#endif</font>
00202 <font class="preprocessor"></font>      }
00203       <font class="keywordflow">return</font> exp(-x+a*log(x)-gln)*h ;
00204     }
00205 
00206   <font class="keyword">template</font> &lt;<font class="keyword">class</font> T&gt;
00207     T errorFcn(T x){
00208     <font class="keywordflow">return</font> x &lt; 0 ? -gammaP&lt;T&gt;(0.5,x*x) : gammaP&lt;T&gt;(0.5,x*x) ;
00209   }
00210 
00211   <font class="keyword">template</font> &lt;<font class="keyword">class</font> T&gt;
00212     T errorFcnC(T x){
00213     <font class="keywordflow">return</font> x &lt; 0 ? 1+gammaP&lt;T&gt;(0.5,x*x) : gammaQ&lt;T&gt;(0.5,x*x) ; 
00214   }
00215 
00216   <font class="keyword">template</font> &lt;<font class="keyword">class</font> T&gt;
00217     T errorFcnChebyshevC(T x)
00218     {
00219       T t,z,ans ;
00220       z = absolute(x);
00221       t = T(1)/(T(1)+0.5*z) ;
00222       ans=t*exp(-z*z-1.26551223+t*(1.00002368+t*(0.37409196+t*0.09678418+
00223                 t*(-0.18628806+t*(0.27886807+t*(-1.13520398+t*(1.48851587+
00224                 t*(-0.82215223+t*0.17087277))))))));
00225       <font class="keywordflow">return</font> x&gt;0 ? ans : T(2)-ans ;
00226                                                  
00227     }
00228 
00229   <font class="keyword">template</font> &lt;<font class="keyword">class</font> T&gt;
00230     <font class="keywordtype">void</font> kendallTau(<font class="keyword">const</font> BasicArray&lt;T&gt;&amp; data1, <font class="keyword">const</font> BasicArray&lt;T&gt;&amp; data2, T &amp;tau, T &amp;z, T&amp; prob)
00231     {
00232       <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> n2=0,n1=0,k,j ;
00233       <font class="keywordtype">int</font> is=0;
00234       T svar, aa, a2,a1 ;
00235       <font class="keywordtype">int</font> n = data1.n() ;
00236 
00237       <font class="keywordflow">for</font>(j=0;j&lt;n-1;++j)
00238         <font class="keywordflow">for</font>(k=j+1;k&lt;n;++k){
00239           a1= data1[j]-data1[k] ;
00240           a2= data2[j]-data2[k] ;
00241           aa=a1*a2;
00242           <font class="keywordflow">if</font>(aa){
00243             ++n1 ; <font class="comment">//no tie</font>
00244             ++n2 ;
00245             aa &gt; 0 ? ++is : --is ;
00246           }
00247           <font class="keywordflow">else</font>{
00248             <font class="keywordflow">if</font>(a1) ++n1 ; <font class="comment">// extra 'x' event</font>
00249             <font class="keywordflow">if</font>(a2) ++n2 ; <font class="comment">// extra 'y' event</font>
00250           }
00251         }
00252       tau = is/(T(sqrt((<font class="keywordtype">double</font>)n1)*sqrt((<font class="keywordtype">double</font>)n2))) ;
00253       svar = T(4*n+10)/T(9*n*(n-1)) ;
00254       z = tau/T(sqrt(svar)) ;
00255       prob = errorFcnChebyshevC&lt;T&gt;(absolute(z)/1.4142136) ;
00256     }
00257 
00258   <font class="keywordtype">void</font> kendallTau(<font class="keyword">const</font> BasicArray&lt;int&gt;&amp; data1, <font class="keyword">const</font> BasicArray&lt;int&gt;&amp; data2, <font class="keywordtype">float</font> &amp;tau, <font class="keywordtype">float</font> &amp;z, <font class="keywordtype">float</font>&amp; prob)
00259     {
00260       <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> n2=0,n1=0,k,j ;
00261       <font class="keywordtype">int</font> is=0;
00262       <font class="keywordtype">float</font> svar, aa, a2,a1 ;
00263       <font class="keywordtype">int</font> n = data1.n() ;
00264 
00265       
00266       <font class="keywordflow">for</font>(j=0;j&lt;n-1;++j)
00267         <font class="keywordflow">for</font>(k=j+1;k&lt;n;++k){
00268           a1= data1[j]-data1[k] ;
00269           a2= data2[j]-data2[k] ;
00270           aa=a1*a2;
00271           <font class="keywordflow">if</font>(aa){
00272             ++n1 ; <font class="comment">//no tie</font>
00273             ++n2 ;
00274             aa &gt; 0 ? ++is : --is ;
00275           }
00276           <font class="keywordflow">else</font>{
00277             <font class="keywordflow">if</font>(a1) ++n1 ; <font class="comment">// extra 'x' event</font>
00278             <font class="keywordflow">if</font>(a2) ++n2 ; <font class="comment">// extra 'y' event</font>
00279           }
00280         }
00281       tau = is/(float(sqrt((<font class="keywordtype">double</font>)n1)*sqrt((<font class="keywordtype">double</font>)n2))) ;
00282       svar = float(4*n+10)/float(9*n*(n-1)) ;
00283       z = tau/float(sqrt(svar)) ;
00284       prob = errorFcnChebyshevC&lt;float&gt;(absolute(z)/1.4142136) ;
00285     }
00286 
00287   <font class="keywordtype">void</font> kendallTau(<font class="keyword">const</font> BasicArray&lt;int&gt;&amp; data1, <font class="keyword">const</font> BasicArray&lt;int&gt;&amp; data2, <font class="keywordtype">double</font> &amp;tau, <font class="keywordtype">double</font> &amp;z, <font class="keywordtype">double</font>&amp; prob)
00288     {
00289       <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> n2=0,n1=0,k,j ;
00290       <font class="keywordtype">int</font> is=0;
00291       <font class="keywordtype">double</font> svar, aa, a2,a1 ;
00292       <font class="keywordtype">int</font> n = data1.n() ;
00293 
00294       
00295       <font class="keywordflow">for</font>(j=0;j&lt;n-1;++j)
00296         <font class="keywordflow">for</font>(k=j+1;k&lt;n;++k){
00297           a1= data1[j]-data1[k] ;
00298           a2= data2[j]-data2[k] ;
00299           aa=a1*a2;
00300           <font class="keywordflow">if</font>(aa){
00301             ++n1 ; <font class="comment">//no tie</font>
00302             ++n2 ;
00303             aa &gt; 0 ? ++is : --is ;
00304           }
00305           <font class="keywordflow">else</font>{
00306             <font class="keywordflow">if</font>(a1) ++n1 ; <font class="comment">// extra 'x' event</font>
00307             <font class="keywordflow">if</font>(a2) ++n2 ; <font class="comment">// extra 'y' event</font>
00308           }
00309         }
00310       tau = is/(double(sqrt((<font class="keywordtype">double</font>)n1)*sqrt((<font class="keywordtype">double</font>)n2))) ;
00311       svar = double(4*n+10)/double(9*n*(n-1)) ;
00312       z = tau/double(sqrt(svar)) ;
00313       prob = errorFcnChebyshevC&lt;double&gt;(absolute(z)/1.4142136) ;
00314     }
00315 
00316 }
00317 
00318 
00319 <font class="preprocessor">#endif</font>
</pre></div><hr><address><small>Generated on Tue Jun 24 13:26:58 2003 for NURBS++ by
<a href="javascript:if(confirm('http://www.doxygen.org/index.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.doxygen.org/index.html'" tppabs="http://www.doxygen.org/index.html">
<img src="doxygen.gif" tppabs="http://libnurbs.sourceforge.net/docs/doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.14 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2002</small></address>
</body>
</html>
