<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0062)http://www.cnblogs.com/zsbfree/archive/2008/01/29/1057643.html -->
<HTML><HEAD id=Head><TITLE>c#上传下载ftp(支持断点续传) - zsbfree - 博客园</TITLE>
<META http-equiv=Content-Type content="text/html; charset=utf-8">
<META id=metaKeywords content=c,上传下载ftp,支持断点续传, name=keywords>
<META 
content=这个ftpClient是从网上找来的，自己加了断点续传的方法usingSystem;usingSystem.Net;usingSystem.IO;usingSystem.Text;usi 
name=description><LINK id=CommondCss 
href="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/common.css" type=text/css 
rel=stylesheet><LINK id=MainCss 
href="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/Skins.css" type=text/css 
rel=stylesheet><LINK id=RSSLink title=RSS 
href="http://www.cnblogs.com/zsbfree/rss" type=application/rss+xml 
rel=alternate>
<SCRIPT src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/common.js" 
type=text/javascript></SCRIPT>

<META content="MSHTML 6.00.2900.3354" name=GENERATOR></HEAD>
<BODY>
<FORM id=Form1 name=Form1 onsubmit="javascript:return WebForm_OnSubmit();" 
action=1057643.html method=post>
<DIV><INPUT id=__EVENTTARGET type=hidden name=__EVENTTARGET> <INPUT 
id=__EVENTARGUMENT type=hidden name=__EVENTARGUMENT> <INPUT 
id="&#13;&#10;__VIEWSTATE" type=hidden name=__VIEWSTATE> </DIV>
<SCRIPT type=text/javascript>
//<![CDATA[
var theForm = document.forms['Form1'];
if (!theForm) {
    theForm = document.Form1;
}
function __doPostBack(eventTarget, eventArgument) {
    if (!theForm.onsubmit || (theForm.onsubmit() != false)) {
        theForm.__EVENTTARGET.value = eventTarget;
        theForm.__EVENTARGUMENT.value = eventArgument;
        theForm.submit();
    }
}
//]]>
</SCRIPT>

<SCRIPT src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/WebResource.axd" 
type=text/javascript></SCRIPT>

<SCRIPT language=JavaScript>
									function ctlent(evt,id)
											{
												if(evt.ctrlKey && evt.keyCode == 13)
												{	
													try
													{
														TempSave(id);
													}
													catch(ex)
													{
													}
													finally
													{
													    __doPostBack('AjaxHolder$PostComment$btnSubmit','')
													}
												}
		
												}</SCRIPT>

<SCRIPT language=JavaScript>function SetReplyAuhor(author){document.getElementById('AjaxHolder_PostComment_tbComment').value+="@"+author+"\n";document.getElementById('AjaxHolder_PostComment_tbComment').focus();return false}</SCRIPT>

<SCRIPT src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ScriptResource.axd" 
type=text/javascript></SCRIPT>

<SCRIPT 
src="C:\Documents and Settings\Administrator\桌面\VC_FTP_續傳\c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files\ScriptResource(1).axd" 
type=text/javascript></SCRIPT>

<SCRIPT 
src="C:\Documents and Settings\Administrator\桌面\VC_FTP_續傳\c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files\ScriptResource(2).axd" 
type=text/javascript></SCRIPT>

<SCRIPT src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/js" 
type=text/javascript></SCRIPT>

<SCRIPT type=text/javascript>
//<![CDATA[
function WebForm_OnSubmit() {
if (typeof(ValidatorOnSubmit) == "function" && ValidatorOnSubmit() == false) return false;
return true;
}
//]]>
</SCRIPT>

<H1><A class=headermaintitle id=Header1_HeaderTitle 
href="http://www.cnblogs.com/zsbfree/">zsbfree</A></H1>
<P id=tagline>技术的拉</P>
<DIV id=rigthtag>&nbsp;</DIV>
<DIV id=main>
<SCRIPT type=text/javascript>
//<![CDATA[
Sys.WebForms.PageRequestManager._initialize('AjaxHolder$scriptmanager1', document.getElementById('Form1'));
Sys.WebForms.PageRequestManager.getInstance()._updateControls(['tAjaxHolder$UpdatePanel1'], [], [], 90);
//]]>
</SCRIPT>

<DIV class=post>
<H2><A id=AjaxHolder_ctl01_TitleUrl 
href="http://www.cnblogs.com/zsbfree/archive/2008/01/29/1057643.html">c#上传下载ftp(支持断点续传)</A> 
</H2>
<P>&nbsp;&nbsp;&nbsp; 这个ftpClient是从网上找来的，自己加了断点续传的方法<IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/look001.gif"><BR><BR></P>
<DIV 
style="BORDER-RIGHT: #cccccc 1px solid; PADDING-RIGHT: 5px; BORDER-TOP: #cccccc 1px solid; PADDING-LEFT: 4px; FONT-SIZE: 13px; PADDING-BOTTOM: 4px; BORDER-LEFT: #cccccc 1px solid; WIDTH: 98%; WORD-BREAK: break-all; PADDING-TOP: 4px; BORDER-BOTTOM: #cccccc 1px solid; BACKGROUND-COLOR: #eeeeee"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/None.gif" align=top><SPAN 
style="COLOR: #0000ff">using</SPAN><SPAN 
style="COLOR: #000000">&nbsp;System;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/None.gif" align=top></SPAN><SPAN 
style="COLOR: #0000ff">using</SPAN><SPAN 
style="COLOR: #000000">&nbsp;System.Net;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/None.gif" align=top></SPAN><SPAN 
style="COLOR: #0000ff">using</SPAN><SPAN 
style="COLOR: #000000">&nbsp;System.IO;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/None.gif" align=top></SPAN><SPAN 
style="COLOR: #0000ff">using</SPAN><SPAN 
style="COLOR: #000000">&nbsp;System.Text;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/None.gif" align=top></SPAN><SPAN 
style="COLOR: #0000ff">using</SPAN><SPAN 
style="COLOR: #000000">&nbsp;System.Net.Sockets;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/None.gif" align=top><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/None.gif" align=top></SPAN><SPAN 
style="COLOR: #0000ff">namespace</SPAN><SPAN 
style="COLOR: #000000">&nbsp;ftpGet<BR><IMG 
id=Codehighlighter1_112_24618_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_112_24618_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_112_24618_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_112_24618_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedBlockStart.gif" 
align=top><IMG id=Codehighlighter1_112_24618_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_112_24618_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_112_24618_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_112_24618_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedBlock.gif" 
align=top></SPAN><SPAN id=Codehighlighter1_112_24618_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_112_24618_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
id=Codehighlighter1_118_170_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_118_170_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_118_170_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_118_170_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_118_170_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_118_170_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_118_170_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_118_170_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_118_170_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</SPAN><SPAN 
id=Codehighlighter1_118_170_Open_Text><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN 
style="COLOR: #008000">&nbsp;FTP&nbsp;Client<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;/summary&gt;</SPAN></SPAN><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">public</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">class</SPAN><SPAN 
style="COLOR: #000000">&nbsp;FTPClient<BR><IMG 
id=Codehighlighter1_201_24616_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_201_24616_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_201_24616_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_201_24616_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_201_24616_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_201_24616_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_201_24616_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_201_24616_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_201_24616_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_201_24616_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
id=Codehighlighter1_211_1235_Closed_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_211_1235_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_211_1235_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_211_1235_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top><IMG id=Codehighlighter1_211_1235_Open_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_211_1235_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_211_1235_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_211_1235_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_211_1235_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">构造函数</SPAN><SPAN 
id=Codehighlighter1_211_1235_Open_Text style="DISPLAY: none"><SPAN 
style="COLOR: #0000ff">#region</SPAN><SPAN 
style="COLOR: #000000">&nbsp;构造函数</SPAN><SPAN style="COLOR: #000000"><BR><IMG 
id=Codehighlighter1_232_288_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_232_288_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_232_288_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_232_288_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_232_288_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_232_288_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_232_288_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_232_288_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_232_288_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</SPAN><SPAN 
id=Codehighlighter1_232_288_Open_Text><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN 
style="COLOR: #008000">&nbsp;缺省构造函数<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;/summary&gt;</SPAN></SPAN><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">public</SPAN><SPAN 
style="COLOR: #000000">&nbsp;FTPClient()<BR><IMG 
id=Codehighlighter1_323_526_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_323_526_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_323_526_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_323_526_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_323_526_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_323_526_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_323_526_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_323_526_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_323_526_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_323_526_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strRemoteHost&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800000">""</SPAN><SPAN style="COLOR: #000000">;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strRemotePath&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800000">""</SPAN><SPAN style="COLOR: #000000">;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strRemoteUser&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800000">""</SPAN><SPAN style="COLOR: #000000">;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strRemotePass&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800000">""</SPAN><SPAN style="COLOR: #000000">;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strRemotePort&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">21</SPAN><SPAN style="COLOR: #000000">;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bConnected&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">false</SPAN><SPAN style="COLOR: #000000">;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><BR><IMG 
id=Codehighlighter1_536_857_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_536_857_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_536_857_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_536_857_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_536_857_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_536_857_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_536_857_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_536_857_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_536_857_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</SPAN><SPAN 
id=Codehighlighter1_536_857_Open_Text><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;构造函数<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;/summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;param&nbsp;name="remoteHost"&gt;</SPAN><SPAN 
style="COLOR: #008000">FTP服务器IP地址</SPAN><SPAN 
style="COLOR: #808080">&lt;/param&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;param&nbsp;name="remotePath"&gt;</SPAN><SPAN 
style="COLOR: #008000">当前服务器目录</SPAN><SPAN 
style="COLOR: #808080">&lt;/param&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;param&nbsp;name="remoteUser"&gt;</SPAN><SPAN 
style="COLOR: #008000">登录用户账号</SPAN><SPAN 
style="COLOR: #808080">&lt;/param&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;param&nbsp;name="remotePass"&gt;</SPAN><SPAN 
style="COLOR: #008000">登录用户密码</SPAN><SPAN 
style="COLOR: #808080">&lt;/param&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;param&nbsp;name="remotePort"&gt;</SPAN><SPAN 
style="COLOR: #008000">FTP服务器端口</SPAN><SPAN 
style="COLOR: #808080">&lt;/param&gt;</SPAN></SPAN><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">public</SPAN><SPAN 
style="COLOR: #000000">&nbsp;FTPClient(</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;remoteHost,&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;remotePath,&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;remoteUser,&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;remotePass,&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">int</SPAN><SPAN 
style="COLOR: #000000">&nbsp;remotePort)<BR><IMG 
id=Codehighlighter1_982_1216_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_982_1216_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_982_1216_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_982_1216_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_982_1216_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_982_1216_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_982_1216_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_982_1216_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_982_1216_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_982_1216_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strRemoteHost&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;remoteHost;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strRemotePath&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;remotePath;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strRemoteUser&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;remoteUser;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strRemotePass&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;remotePass;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strRemotePort&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;remotePort;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Connect();<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">#endregion</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><BR><IMG 
id=Codehighlighter1_1245_2944_Closed_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1245_2944_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_1245_2944_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_1245_2944_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top><IMG id=Codehighlighter1_1245_2944_Open_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1245_2944_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_1245_2944_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_1245_2944_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_1245_2944_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">登陆字段、属性</SPAN><SPAN 
id=Codehighlighter1_1245_2944_Open_Text style="DISPLAY: none"><SPAN 
style="COLOR: #0000ff">#region</SPAN><SPAN 
style="COLOR: #000000">&nbsp;登陆字段、属性</SPAN><SPAN style="COLOR: #000000"><BR><IMG 
id=Codehighlighter1_1269_1329_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1269_1329_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_1269_1329_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_1269_1329_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_1269_1329_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1269_1329_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_1269_1329_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_1269_1329_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_1269_1329_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</SPAN><SPAN 
id=Codehighlighter1_1269_1329_Open_Text><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN 
style="COLOR: #008000">&nbsp;FTP服务器IP地址<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;/summary&gt;</SPAN></SPAN><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">private</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strRemoteHost;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">public</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;RemoteHost<BR><IMG 
id=Codehighlighter1_1408_1584_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1408_1584_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_1408_1584_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_1408_1584_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_1408_1584_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1408_1584_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_1408_1584_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_1408_1584_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_1408_1584_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_1408_1584_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">get</SPAN><SPAN style="COLOR: #000000"><BR><IMG 
id=Codehighlighter1_1438_1491_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1438_1491_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_1438_1491_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_1438_1491_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_1438_1491_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1438_1491_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_1438_1491_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_1438_1491_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_1438_1491_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_1438_1491_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">return</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strRemoteHost;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">set</SPAN><SPAN style="COLOR: #000000"><BR><IMG 
id=Codehighlighter1_1520_1574_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1520_1574_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_1520_1574_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_1520_1574_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_1520_1574_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1520_1574_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_1520_1574_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_1520_1574_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_1520_1574_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_1520_1574_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strRemoteHost&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">&nbsp;value;<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG id=Codehighlighter1_1593_1651_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1593_1651_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_1593_1651_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_1593_1651_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_1593_1651_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1593_1651_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_1593_1651_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_1593_1651_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_1593_1651_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</SPAN><SPAN 
id=Codehighlighter1_1593_1651_Open_Text><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN 
style="COLOR: #008000">&nbsp;FTP服务器端口<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;/summary&gt;</SPAN></SPAN><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">private</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN style="COLOR: #0000ff">int</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strRemotePort;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">public</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN style="COLOR: #0000ff">int</SPAN><SPAN 
style="COLOR: #000000">&nbsp;RemotePort<BR><IMG 
id=Codehighlighter1_1724_1900_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1724_1900_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_1724_1900_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_1724_1900_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_1724_1900_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1724_1900_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_1724_1900_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_1724_1900_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_1724_1900_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_1724_1900_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">get</SPAN><SPAN style="COLOR: #000000"><BR><IMG 
id=Codehighlighter1_1754_1807_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1754_1807_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_1754_1807_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_1754_1807_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_1754_1807_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1754_1807_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_1754_1807_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_1754_1807_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_1754_1807_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_1754_1807_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">return</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strRemotePort;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">set</SPAN><SPAN style="COLOR: #000000"><BR><IMG 
id=Codehighlighter1_1836_1890_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1836_1890_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_1836_1890_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_1836_1890_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_1836_1890_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1836_1890_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_1836_1890_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_1836_1890_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_1836_1890_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_1836_1890_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strRemotePort&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">&nbsp;value;<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG id=Codehighlighter1_1909_1966_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1909_1966_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_1909_1966_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_1909_1966_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_1909_1966_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1909_1966_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_1909_1966_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_1909_1966_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_1909_1966_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</SPAN><SPAN 
id=Codehighlighter1_1909_1966_Open_Text><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN 
style="COLOR: #008000">&nbsp;当前服务器目录<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;/summary&gt;</SPAN></SPAN><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">private</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strRemotePath;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">public</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;RemotePath<BR><IMG 
id=Codehighlighter1_2045_2221_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_2045_2221_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_2045_2221_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_2045_2221_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_2045_2221_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_2045_2221_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_2045_2221_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_2045_2221_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_2045_2221_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_2045_2221_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">get</SPAN><SPAN style="COLOR: #000000"><BR><IMG 
id=Codehighlighter1_2075_2128_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_2075_2128_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_2075_2128_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_2075_2128_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_2075_2128_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_2075_2128_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_2075_2128_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_2075_2128_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_2075_2128_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_2075_2128_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">return</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strRemotePath;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">set</SPAN><SPAN style="COLOR: #000000"><BR><IMG 
id=Codehighlighter1_2157_2211_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_2157_2211_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_2157_2211_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_2157_2211_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_2157_2211_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_2157_2211_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_2157_2211_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_2157_2211_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_2157_2211_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_2157_2211_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strRemotePath&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">&nbsp;value;<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG id=Codehighlighter1_2230_2286_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_2230_2286_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_2230_2286_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_2230_2286_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_2230_2286_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_2230_2286_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_2230_2286_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_2230_2286_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_2230_2286_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</SPAN><SPAN 
id=Codehighlighter1_2230_2286_Open_Text><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN 
style="COLOR: #008000">&nbsp;登录用户账号<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;/summary&gt;</SPAN></SPAN><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">private</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strRemoteUser;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">public</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;RemoteUser<BR><IMG 
id=Codehighlighter1_2365_2459_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_2365_2459_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_2365_2459_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_2365_2459_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_2365_2459_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_2365_2459_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_2365_2459_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_2365_2459_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_2365_2459_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_2365_2459_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">set</SPAN><SPAN style="COLOR: #000000"><BR><IMG 
id=Codehighlighter1_2395_2449_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_2395_2449_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_2395_2449_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_2395_2449_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_2395_2449_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_2395_2449_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_2395_2449_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_2395_2449_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_2395_2449_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_2395_2449_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strRemoteUser&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">&nbsp;value;<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG id=Codehighlighter1_2468_2524_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_2468_2524_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_2468_2524_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_2468_2524_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_2468_2524_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_2468_2524_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_2468_2524_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_2468_2524_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_2468_2524_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</SPAN><SPAN 
id=Codehighlighter1_2468_2524_Open_Text><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN 
style="COLOR: #008000">&nbsp;用户登录密码<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;/summary&gt;</SPAN></SPAN><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">private</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strRemotePass;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">public</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;RemotePass<BR><IMG 
id=Codehighlighter1_2603_2697_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_2603_2697_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_2603_2697_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_2603_2697_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_2603_2697_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_2603_2697_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_2603_2697_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_2603_2697_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_2603_2697_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_2603_2697_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">set</SPAN><SPAN style="COLOR: #000000"><BR><IMG 
id=Codehighlighter1_2633_2687_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_2633_2687_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_2633_2687_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_2633_2687_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_2633_2687_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_2633_2687_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_2633_2687_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_2633_2687_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_2633_2687_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_2633_2687_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strRemotePass&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">&nbsp;value;<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><BR><IMG 
id=Codehighlighter1_2707_2761_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_2707_2761_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_2707_2761_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_2707_2761_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_2707_2761_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_2707_2761_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_2707_2761_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_2707_2761_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_2707_2761_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</SPAN><SPAN 
id=Codehighlighter1_2707_2761_Open_Text><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;是否登录<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;/summary&gt;</SPAN></SPAN><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">private</SPAN><SPAN 
style="COLOR: #000000">&nbsp;Boolean&nbsp;bConnected;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">public</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">bool</SPAN><SPAN 
style="COLOR: #000000">&nbsp;Connected<BR><IMG 
id=Codehighlighter1_2835_2925_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_2835_2925_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_2835_2925_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_2835_2925_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_2835_2925_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_2835_2925_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_2835_2925_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_2835_2925_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_2835_2925_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_2835_2925_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">get</SPAN><SPAN style="COLOR: #000000"><BR><IMG 
id=Codehighlighter1_2865_2915_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_2865_2915_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_2865_2915_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_2865_2915_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_2865_2915_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_2865_2915_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_2865_2915_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_2865_2915_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_2865_2915_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_2865_2915_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">return</SPAN><SPAN 
style="COLOR: #000000">&nbsp;bConnected;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">#endregion</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><BR><IMG 
id=Codehighlighter1_2954_4753_Closed_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_2954_4753_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_2954_4753_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_2954_4753_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top><IMG id=Codehighlighter1_2954_4753_Open_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_2954_4753_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_2954_4753_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_2954_4753_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_2954_4753_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">链接</SPAN><SPAN 
id=Codehighlighter1_2954_4753_Open_Text style="DISPLAY: none"><SPAN 
style="COLOR: #0000ff">#region</SPAN><SPAN 
style="COLOR: #000000">&nbsp;链接</SPAN><SPAN style="COLOR: #000000"><BR><IMG 
id=Codehighlighter1_2973_3028_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_2973_3028_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_2973_3028_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_2973_3028_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_2973_3028_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_2973_3028_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_2973_3028_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_2973_3028_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_2973_3028_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</SPAN><SPAN 
id=Codehighlighter1_2973_3028_Open_Text><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN 
style="COLOR: #008000">&nbsp;建立连接&nbsp;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;/summary&gt;</SPAN></SPAN><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">public</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">void</SPAN><SPAN 
style="COLOR: #000000">&nbsp;Connect()<BR><IMG 
id=Codehighlighter1_3066_4478_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_3066_4478_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_3066_4478_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_3066_4478_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_3066_4478_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_3066_4478_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_3066_4478_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_3066_4478_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_3066_4478_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_3066_4478_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;socketControl&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">new</SPAN><SPAN 
style="COLOR: #000000">&nbsp;Socket(AddressFamily.InterNetwork,&nbsp;SocketType.Stream,&nbsp;ProtocolType.Tcp);<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPEndPoint&nbsp;ep&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">new</SPAN><SPAN 
style="COLOR: #000000">&nbsp;IPEndPoint(IPAddress.Parse(RemoteHost),&nbsp;strRemotePort);<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #008000">//</SPAN><SPAN 
style="COLOR: #008000">&nbsp;链接</SPAN><SPAN style="COLOR: #008000"><BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top></SPAN><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">try</SPAN><SPAN style="COLOR: #000000"><BR><IMG 
id=Codehighlighter1_3307_3365_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_3307_3365_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_3307_3365_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_3307_3365_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_3307_3365_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_3307_3365_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_3307_3365_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_3307_3365_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_3307_3365_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_3307_3365_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;socketControl.Connect(ep);<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">catch</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(Exception)<BR><IMG 
id=Codehighlighter1_3408_3499_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_3408_3499_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_3408_3499_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_3408_3499_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_3408_3499_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_3408_3499_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_3408_3499_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_3408_3499_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_3408_3499_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_3408_3499_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">throw</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN style="COLOR: #0000ff">new</SPAN><SPAN 
style="COLOR: #000000">&nbsp;IOException(</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN 
style="COLOR: #800000">Couldn't&nbsp;connect&nbsp;to&nbsp;remote&nbsp;server</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">);<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #008000">//</SPAN><SPAN 
style="COLOR: #008000">&nbsp;获取应答码</SPAN><SPAN style="COLOR: #008000"><BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top></SPAN><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ReadReply();<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(iReplyCode&nbsp;</SPAN><SPAN 
style="COLOR: #000000">!=</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">220</SPAN><SPAN style="COLOR: #000000">)<BR><IMG 
id=Codehighlighter1_3594_3701_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_3594_3701_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_3594_3701_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_3594_3701_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_3594_3701_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_3594_3701_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_3594_3701_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_3594_3701_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_3594_3701_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_3594_3701_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DisConnect();<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">throw</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN style="COLOR: #0000ff">new</SPAN><SPAN 
style="COLOR: #000000">&nbsp;IOException(strReply.Substring(</SPAN><SPAN 
style="COLOR: #800080">4</SPAN><SPAN style="COLOR: #000000">));<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #008000">//</SPAN><SPAN 
style="COLOR: #008000">&nbsp;登陆</SPAN><SPAN style="COLOR: #008000"><BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top></SPAN><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SendCommand(</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN 
style="COLOR: #800000">USER&nbsp;</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #000000">+</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strRemoteUser);<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN style="COLOR: #000000">&nbsp;(</SPAN><SPAN 
style="COLOR: #000000">!</SPAN><SPAN 
style="COLOR: #000000">(iReplyCode&nbsp;</SPAN><SPAN 
style="COLOR: #000000">==</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">331</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #000000">||</SPAN><SPAN 
style="COLOR: #000000">&nbsp;iReplyCode&nbsp;</SPAN><SPAN 
style="COLOR: #000000">==</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">230</SPAN><SPAN style="COLOR: #000000">))<BR><IMG 
id=Codehighlighter1_3842_3963_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_3842_3963_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_3842_3963_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_3842_3963_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_3842_3963_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_3842_3963_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_3842_3963_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_3842_3963_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_3842_3963_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_3842_3963_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CloseSocketConnect();</SPAN><SPAN 
style="COLOR: #008000">//</SPAN><SPAN style="COLOR: #008000">关闭连接</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top></SPAN><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">throw</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN style="COLOR: #0000ff">new</SPAN><SPAN 
style="COLOR: #000000">&nbsp;IOException(strReply.Substring(</SPAN><SPAN 
style="COLOR: #800080">4</SPAN><SPAN style="COLOR: #000000">));<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(iReplyCode&nbsp;</SPAN><SPAN 
style="COLOR: #000000">!=</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">230</SPAN><SPAN style="COLOR: #000000">)<BR><IMG 
id=Codehighlighter1_4011_4293_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_4011_4293_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_4011_4293_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_4011_4293_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_4011_4293_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_4011_4293_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_4011_4293_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_4011_4293_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_4011_4293_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_4011_4293_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SendCommand(</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN 
style="COLOR: #800000">PASS&nbsp;</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #000000">+</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strRemotePass);<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN style="COLOR: #000000">&nbsp;(</SPAN><SPAN 
style="COLOR: #000000">!</SPAN><SPAN 
style="COLOR: #000000">(iReplyCode&nbsp;</SPAN><SPAN 
style="COLOR: #000000">==</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">230</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #000000">||</SPAN><SPAN 
style="COLOR: #000000">&nbsp;iReplyCode&nbsp;</SPAN><SPAN 
style="COLOR: #000000">==</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">202</SPAN><SPAN style="COLOR: #000000">))<BR><IMG 
id=Codehighlighter1_4146_4279_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_4146_4279_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_4146_4279_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_4146_4279_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_4146_4279_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_4146_4279_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_4146_4279_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_4146_4279_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_4146_4279_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_4146_4279_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CloseSocketConnect();</SPAN><SPAN 
style="COLOR: #008000">//</SPAN><SPAN style="COLOR: #008000">关闭连接</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top></SPAN><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">throw</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN style="COLOR: #0000ff">new</SPAN><SPAN 
style="COLOR: #000000">&nbsp;IOException(strReply.Substring(</SPAN><SPAN 
style="COLOR: #800080">4</SPAN><SPAN style="COLOR: #000000">));<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bConnected&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">true</SPAN><SPAN style="COLOR: #000000">;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #008000">//</SPAN><SPAN 
style="COLOR: #008000">&nbsp;切换到初始目录</SPAN><SPAN style="COLOR: #008000"><BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top></SPAN><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN style="COLOR: #000000">&nbsp;(</SPAN><SPAN 
style="COLOR: #000000">!</SPAN><SPAN style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">.IsNullOrEmpty(strRemotePath))<BR><IMG 
id=Codehighlighter1_4415_4468_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_4415_4468_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_4415_4468_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_4415_4468_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_4415_4468_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_4415_4468_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_4415_4468_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_4415_4468_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_4415_4468_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_4415_4468_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ChDir(strRemotePath);<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top><BR><IMG id=Codehighlighter1_4489_4543_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_4489_4543_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_4489_4543_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_4489_4543_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_4489_4543_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_4489_4543_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_4489_4543_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_4489_4543_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_4489_4543_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</SPAN><SPAN 
id=Codehighlighter1_4489_4543_Open_Text><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;关闭连接<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;/summary&gt;</SPAN></SPAN><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">public</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">void</SPAN><SPAN 
style="COLOR: #000000">&nbsp;DisConnect()<BR><IMG 
id=Codehighlighter1_4584_4733_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_4584_4733_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_4584_4733_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_4584_4733_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_4584_4733_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_4584_4733_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_4584_4733_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_4584_4733_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_4584_4733_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_4584_4733_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(socketControl&nbsp;</SPAN><SPAN 
style="COLOR: #000000">!=</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">null</SPAN><SPAN style="COLOR: #000000">)<BR><IMG 
id=Codehighlighter1_4637_4689_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_4637_4689_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_4637_4689_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_4637_4689_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_4637_4689_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_4637_4689_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_4637_4689_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_4637_4689_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_4637_4689_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_4637_4689_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SendCommand(</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #800000">QUIT</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">);<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CloseSocketConnect();<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">#endregion</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><BR><IMG 
id=Codehighlighter1_4763_5771_Closed_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_4763_5771_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_4763_5771_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_4763_5771_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top><IMG id=Codehighlighter1_4763_5771_Open_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_4763_5771_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_4763_5771_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_4763_5771_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_4763_5771_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">传输模式</SPAN><SPAN 
id=Codehighlighter1_4763_5771_Open_Text style="DISPLAY: none"><SPAN 
style="COLOR: #0000ff">#region</SPAN><SPAN 
style="COLOR: #000000">&nbsp;传输模式</SPAN><SPAN style="COLOR: #000000"><BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top><BR><IMG id=Codehighlighter1_4785_4853_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_4785_4853_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_4785_4853_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_4785_4853_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_4785_4853_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_4785_4853_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_4785_4853_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_4785_4853_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_4785_4853_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</SPAN><SPAN 
id=Codehighlighter1_4785_4853_Open_Text><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN 
style="COLOR: #008000">&nbsp;传输模式:二进制类型、ASCII类型<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;/summary&gt;</SPAN></SPAN><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">public</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">enum</SPAN><SPAN 
style="COLOR: #000000">&nbsp;TransferType<BR><IMG 
id=Codehighlighter1_4894_4943_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_4894_4943_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_4894_4943_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_4894_4943_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_4894_4943_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_4894_4943_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_4894_4943_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_4894_4943_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_4894_4943_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_4894_4943_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Binary,<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ASCII<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000">;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><BR><IMG 
id=Codehighlighter1_4954_5056_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_4954_5056_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_4954_5056_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_4954_5056_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_4954_5056_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_4954_5056_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_4954_5056_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_4954_5056_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_4954_5056_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</SPAN><SPAN 
id=Codehighlighter1_4954_5056_Open_Text><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN 
style="COLOR: #008000">&nbsp;设置传输模式<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;/summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;param&nbsp;name="ttType"&gt;</SPAN><SPAN 
style="COLOR: #008000">传输模式</SPAN><SPAN 
style="COLOR: #808080">&lt;/param&gt;</SPAN></SPAN><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">public</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">void</SPAN><SPAN 
style="COLOR: #000000">&nbsp;SetTransferType(TransferType&nbsp;ttType)<BR><IMG 
id=Codehighlighter1_5121_5556_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_5121_5556_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_5121_5556_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_5121_5556_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_5121_5556_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_5121_5556_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_5121_5556_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_5121_5556_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_5121_5556_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_5121_5556_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(ttType&nbsp;</SPAN><SPAN 
style="COLOR: #000000">==</SPAN><SPAN 
style="COLOR: #000000">&nbsp;TransferType.Binary)<BR><IMG 
id=Codehighlighter1_5182_5248_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_5182_5248_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_5182_5248_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_5182_5248_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_5182_5248_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_5182_5248_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_5182_5248_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_5182_5248_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_5182_5248_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_5182_5248_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SendCommand(</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN 
style="COLOR: #800000">TYPE&nbsp;I</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">);</SPAN><SPAN 
style="COLOR: #008000">//</SPAN><SPAN 
style="COLOR: #008000">binary类型传输</SPAN><SPAN style="COLOR: #008000"><BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top></SPAN><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">else</SPAN><SPAN style="COLOR: #000000"><BR><IMG 
id=Codehighlighter1_5278_5343_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_5278_5343_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_5278_5343_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_5278_5343_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_5278_5343_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_5278_5343_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_5278_5343_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_5278_5343_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_5278_5343_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_5278_5343_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SendCommand(</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN 
style="COLOR: #800000">TYPE&nbsp;A</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">);</SPAN><SPAN 
style="COLOR: #008000">//</SPAN><SPAN 
style="COLOR: #008000">ASCII类型传输</SPAN><SPAN style="COLOR: #008000"><BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top></SPAN><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(iReplyCode&nbsp;</SPAN><SPAN 
style="COLOR: #000000">!=</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">200</SPAN><SPAN style="COLOR: #000000">)<BR><IMG 
id=Codehighlighter1_5391_5468_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_5391_5468_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_5391_5468_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_5391_5468_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_5391_5468_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_5391_5468_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_5391_5468_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_5391_5468_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_5391_5468_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_5391_5468_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">throw</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN style="COLOR: #0000ff">new</SPAN><SPAN 
style="COLOR: #000000">&nbsp;IOException(strReply.Substring(</SPAN><SPAN 
style="COLOR: #800080">4</SPAN><SPAN style="COLOR: #000000">));<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">else</SPAN><SPAN style="COLOR: #000000"><BR><IMG 
id=Codehighlighter1_5498_5546_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_5498_5546_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_5498_5546_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_5498_5546_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_5498_5546_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_5498_5546_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_5498_5546_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_5498_5546_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_5498_5546_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_5498_5546_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;trType&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;ttType;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top><BR><IMG id=Codehighlighter1_5567_5659_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_5567_5659_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_5567_5659_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_5567_5659_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_5567_5659_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_5567_5659_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_5567_5659_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_5567_5659_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_5567_5659_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</SPAN><SPAN 
id=Codehighlighter1_5567_5659_Open_Text><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN 
style="COLOR: #008000">&nbsp;获得传输模式<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;/summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;returns&gt;</SPAN><SPAN 
style="COLOR: #008000">传输模式</SPAN><SPAN 
style="COLOR: #808080">&lt;/returns&gt;</SPAN></SPAN><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">public</SPAN><SPAN 
style="COLOR: #000000">&nbsp;TransferType&nbsp;GetTransferType()<BR><IMG 
id=Codehighlighter1_5713_5751_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_5713_5751_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_5713_5751_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_5713_5751_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_5713_5751_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_5713_5751_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_5713_5751_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_5713_5751_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_5713_5751_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_5713_5751_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">return</SPAN><SPAN 
style="COLOR: #000000">&nbsp;trType;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">#endregion</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><BR><IMG 
id=Codehighlighter1_5781_9088_Closed_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_5781_9088_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_5781_9088_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_5781_9088_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top><IMG id=Codehighlighter1_5781_9088_Open_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_5781_9088_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_5781_9088_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_5781_9088_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_5781_9088_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">文件操作</SPAN><SPAN 
id=Codehighlighter1_5781_9088_Open_Text style="DISPLAY: none"><SPAN 
style="COLOR: #0000ff">#region</SPAN><SPAN 
style="COLOR: #000000">&nbsp;文件操作</SPAN><SPAN style="COLOR: #000000"><BR><IMG 
id=Codehighlighter1_5802_5942_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_5802_5942_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_5802_5942_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_5802_5942_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_5802_5942_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_5802_5942_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_5802_5942_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_5802_5942_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_5802_5942_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</SPAN><SPAN 
id=Codehighlighter1_5802_5942_Open_Text><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN 
style="COLOR: #008000">&nbsp;获得文件列表<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;/summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;param&nbsp;name="strMask"&gt;</SPAN><SPAN 
style="COLOR: #008000">文件名的匹配字符串</SPAN><SPAN 
style="COLOR: #808080">&lt;/param&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;returns&gt;&lt;/returns&gt;</SPAN></SPAN><BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">public</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">[]&nbsp;Dir(</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strMask)<BR><IMG 
id=Codehighlighter1_5994_7211_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_5994_7211_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_5994_7211_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_5994_7211_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_5994_7211_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_5994_7211_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_5994_7211_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_5994_7211_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_5994_7211_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_5994_7211_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #008000">//</SPAN><SPAN 
style="COLOR: #008000">&nbsp;建立链接</SPAN><SPAN style="COLOR: #008000"><BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top></SPAN><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN style="COLOR: #000000">&nbsp;(</SPAN><SPAN 
style="COLOR: #000000">!</SPAN><SPAN style="COLOR: #000000">bConnected)<BR><IMG 
id=Codehighlighter1_6057_6099_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_6057_6099_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_6057_6099_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_6057_6099_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_6057_6099_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_6057_6099_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_6057_6099_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_6057_6099_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_6057_6099_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_6057_6099_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Connect();<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #008000">//</SPAN><SPAN 
style="COLOR: #008000">建立进行数据连接的socket</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top></SPAN><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Socket&nbsp;socketData&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;CreateDataSocket();<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #008000">//</SPAN><SPAN style="COLOR: #008000">传送命令</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top></SPAN><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SendCommand(</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN 
style="COLOR: #800000">LIST&nbsp;</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #000000">+</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strMask);<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #008000">//</SPAN><SPAN style="COLOR: #008000">分析应答代码</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top></SPAN><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN style="COLOR: #000000">&nbsp;(</SPAN><SPAN 
style="COLOR: #000000">!</SPAN><SPAN 
style="COLOR: #000000">(iReplyCode&nbsp;</SPAN><SPAN 
style="COLOR: #000000">==</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">150</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #000000">||</SPAN><SPAN 
style="COLOR: #000000">&nbsp;iReplyCode&nbsp;</SPAN><SPAN 
style="COLOR: #000000">==</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">125</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #000000">||</SPAN><SPAN 
style="COLOR: #000000">&nbsp;iReplyCode&nbsp;</SPAN><SPAN 
style="COLOR: #000000">==</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">226</SPAN><SPAN style="COLOR: #000000">))<BR><IMG 
id=Codehighlighter1_6361_6438_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_6361_6438_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_6361_6438_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_6361_6438_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_6361_6438_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_6361_6438_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_6361_6438_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_6361_6438_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_6361_6438_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_6361_6438_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">throw</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN style="COLOR: #0000ff">new</SPAN><SPAN 
style="COLOR: #000000">&nbsp;IOException(strReply.Substring(</SPAN><SPAN 
style="COLOR: #800080">4</SPAN><SPAN style="COLOR: #000000">));<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #008000">//</SPAN><SPAN style="COLOR: #008000">获得结果</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top></SPAN><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strMsg&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800000">""</SPAN><SPAN style="COLOR: #000000">;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">while</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(</SPAN><SPAN 
style="COLOR: #0000ff">true</SPAN><SPAN style="COLOR: #000000">)<BR><IMG 
id=Codehighlighter1_6521_6781_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_6521_6781_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_6521_6781_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_6521_6781_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_6521_6781_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_6521_6781_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_6521_6781_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_6521_6781_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_6521_6781_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_6521_6781_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">int</SPAN><SPAN 
style="COLOR: #000000">&nbsp;iBytes&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;socketData.Receive(buffer,&nbsp;buffer.Length,&nbsp;</SPAN><SPAN 
style="COLOR: #800080">0</SPAN><SPAN style="COLOR: #000000">);<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strMsg&nbsp;</SPAN><SPAN 
style="COLOR: #000000">+=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;GB2312.GetString(buffer,&nbsp;</SPAN><SPAN 
style="COLOR: #800080">0</SPAN><SPAN 
style="COLOR: #000000">,&nbsp;iBytes);<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(iBytes&nbsp;</SPAN><SPAN 
style="COLOR: #000000">&lt;</SPAN><SPAN 
style="COLOR: #000000">&nbsp;buffer.Length)<BR><IMG 
id=Codehighlighter1_6721_6767_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_6721_6767_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_6721_6767_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_6721_6767_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_6721_6767_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_6721_6767_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_6721_6767_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_6721_6767_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_6721_6767_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_6721_6767_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">break</SPAN><SPAN style="COLOR: #000000">;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG id=Codehighlighter1_6813_6822_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_6813_6822_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_6813_6822_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_6813_6822_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_6813_6822_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_6813_6822_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_6813_6822_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_6813_6822_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">char</SPAN><SPAN 
style="COLOR: #000000">[]&nbsp;seperator&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
id=Codehighlighter1_6813_6822_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_6813_6822_Open_Text><SPAN 
style="COLOR: #000000">{&nbsp;</SPAN><SPAN style="COLOR: #800000">'</SPAN><SPAN 
style="COLOR: #800000">\n</SPAN><SPAN style="COLOR: #800000">'</SPAN><SPAN 
style="COLOR: #000000">&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000">;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">[]&nbsp;strsFileList&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strMsg.Split(seperator);<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;socketData.Close();</SPAN><SPAN 
style="COLOR: #008000">//</SPAN><SPAN 
style="COLOR: #008000">数据socket关闭时也会有返回码</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top></SPAN><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(iReplyCode&nbsp;</SPAN><SPAN 
style="COLOR: #000000">!=</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">226</SPAN><SPAN style="COLOR: #000000">)<BR><IMG 
id=Codehighlighter1_6983_7168_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_6983_7168_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_6983_7168_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_6983_7168_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_6983_7168_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_6983_7168_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_6983_7168_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_6983_7168_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_6983_7168_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_6983_7168_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ReadReply();<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(iReplyCode&nbsp;</SPAN><SPAN 
style="COLOR: #000000">!=</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">226</SPAN><SPAN style="COLOR: #000000">)<BR><IMG 
id=Codehighlighter1_7069_7154_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_7069_7154_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_7069_7154_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_7069_7154_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_7069_7154_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_7069_7154_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_7069_7154_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_7069_7154_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_7069_7154_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_7069_7154_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">throw</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN style="COLOR: #0000ff">new</SPAN><SPAN 
style="COLOR: #000000">&nbsp;IOException(strReply.Substring(</SPAN><SPAN 
style="COLOR: #800080">4</SPAN><SPAN style="COLOR: #000000">));<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">return</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strsFileList;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top><BR><IMG id=Codehighlighter1_7222_7364_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_7222_7364_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_7222_7364_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_7222_7364_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_7222_7364_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_7222_7364_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_7222_7364_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_7222_7364_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_7222_7364_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</SPAN><SPAN 
id=Codehighlighter1_7222_7364_Open_Text><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN 
style="COLOR: #008000">&nbsp;获取文件大小<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;/summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;param&nbsp;name="strFileName"&gt;</SPAN><SPAN 
style="COLOR: #008000">文件名</SPAN><SPAN 
style="COLOR: #808080">&lt;/param&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;returns&gt;</SPAN><SPAN 
style="COLOR: #008000">文件大小</SPAN><SPAN 
style="COLOR: #808080">&lt;/returns&gt;</SPAN></SPAN><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">public</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">long</SPAN><SPAN 
style="COLOR: #000000">&nbsp;GetFileSize(</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strFileName)<BR><IMG 
id=Codehighlighter1_7424_7869_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_7424_7869_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_7424_7869_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_7424_7869_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_7424_7869_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_7424_7869_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_7424_7869_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_7424_7869_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_7424_7869_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_7424_7869_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN style="COLOR: #000000">&nbsp;(</SPAN><SPAN 
style="COLOR: #000000">!</SPAN><SPAN style="COLOR: #000000">bConnected)<BR><IMG 
id=Codehighlighter1_7467_7509_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_7467_7509_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_7467_7509_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_7467_7509_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_7467_7509_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_7467_7509_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_7467_7509_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_7467_7509_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_7467_7509_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_7467_7509_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Connect();<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SendCommand(</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN 
style="COLOR: #800000">SIZE&nbsp;</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #000000">+</SPAN><SPAN 
style="COLOR: #000000">&nbsp;Path.GetFileName(strFileName));<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">long</SPAN><SPAN 
style="COLOR: #000000">&nbsp;lSize&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">0</SPAN><SPAN style="COLOR: #000000">;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(iReplyCode&nbsp;</SPAN><SPAN 
style="COLOR: #000000">==</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">213</SPAN><SPAN style="COLOR: #000000">)<BR><IMG 
id=Codehighlighter1_7651_7726_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_7651_7726_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_7651_7726_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_7651_7726_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_7651_7726_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_7651_7726_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_7651_7726_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_7651_7726_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_7651_7726_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_7651_7726_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lSize&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;Int64.Parse(strReply.Substring(</SPAN><SPAN 
style="COLOR: #800080">4</SPAN><SPAN style="COLOR: #000000">));<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">else</SPAN><SPAN style="COLOR: #000000"><BR><IMG 
id=Codehighlighter1_7756_7833_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_7756_7833_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_7756_7833_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_7756_7833_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_7756_7833_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_7756_7833_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_7756_7833_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_7756_7833_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_7756_7833_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_7756_7833_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">throw</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN style="COLOR: #0000ff">new</SPAN><SPAN 
style="COLOR: #000000">&nbsp;IOException(strReply.Substring(</SPAN><SPAN 
style="COLOR: #800080">4</SPAN><SPAN style="COLOR: #000000">));<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">return</SPAN><SPAN 
style="COLOR: #000000">&nbsp;lSize;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top><BR><IMG id=Codehighlighter1_7880_7985_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_7880_7985_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_7880_7985_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_7880_7985_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_7880_7985_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_7880_7985_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_7880_7985_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_7880_7985_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_7880_7985_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</SPAN><SPAN 
id=Codehighlighter1_7880_7985_Open_Text><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;删除<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;/summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;param&nbsp;name="strFileName"&gt;</SPAN><SPAN 
style="COLOR: #008000">待删除文件名</SPAN><SPAN 
style="COLOR: #808080">&lt;/param&gt;</SPAN></SPAN><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">public</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">void</SPAN><SPAN 
style="COLOR: #000000">&nbsp;Delete(</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strFileName)<BR><IMG 
id=Codehighlighter1_8040_8308_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_8040_8308_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_8040_8308_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_8040_8308_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_8040_8308_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_8040_8308_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_8040_8308_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_8040_8308_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_8040_8308_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_8040_8308_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN style="COLOR: #000000">&nbsp;(</SPAN><SPAN 
style="COLOR: #000000">!</SPAN><SPAN style="COLOR: #000000">bConnected)<BR><IMG 
id=Codehighlighter1_8083_8125_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_8083_8125_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_8083_8125_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_8083_8125_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_8083_8125_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_8083_8125_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_8083_8125_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_8083_8125_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_8083_8125_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_8083_8125_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Connect();<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SendCommand(</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN 
style="COLOR: #800000">DELE&nbsp;</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #000000">+</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strFileName);<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(iReplyCode&nbsp;</SPAN><SPAN 
style="COLOR: #000000">!=</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">250</SPAN><SPAN style="COLOR: #000000">)<BR><IMG 
id=Codehighlighter1_8221_8298_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_8221_8298_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_8221_8298_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_8221_8298_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_8221_8298_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_8221_8298_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_8221_8298_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_8221_8298_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_8221_8298_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_8221_8298_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">throw</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN style="COLOR: #0000ff">new</SPAN><SPAN 
style="COLOR: #000000">&nbsp;IOException(strReply.Substring(</SPAN><SPAN 
style="COLOR: #800080">4</SPAN><SPAN style="COLOR: #000000">));<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top><BR><IMG id=Codehighlighter1_8319_8503_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_8319_8503_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_8319_8503_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_8319_8503_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_8319_8503_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_8319_8503_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_8319_8503_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_8319_8503_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_8319_8503_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</SPAN><SPAN 
id=Codehighlighter1_8319_8503_Open_Text><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN 
style="COLOR: #008000">&nbsp;重命名(如果新文件名与已有文件重名,将覆盖已有文件)<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;/summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;param&nbsp;name="strOldFileName"&gt;</SPAN><SPAN 
style="COLOR: #008000">旧文件名</SPAN><SPAN 
style="COLOR: #808080">&lt;/param&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;param&nbsp;name="strNewFileName"&gt;</SPAN><SPAN 
style="COLOR: #008000">新文件名</SPAN><SPAN 
style="COLOR: #808080">&lt;/param&gt;</SPAN></SPAN><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">public</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">void</SPAN><SPAN 
style="COLOR: #000000">&nbsp;Rename(</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strOldFileName,&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strNewFileName)<BR><IMG 
id=Codehighlighter1_8584_9069_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_8584_9069_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_8584_9069_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_8584_9069_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_8584_9069_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_8584_9069_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_8584_9069_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_8584_9069_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_8584_9069_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_8584_9069_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN style="COLOR: #000000">&nbsp;(</SPAN><SPAN 
style="COLOR: #000000">!</SPAN><SPAN style="COLOR: #000000">bConnected)<BR><IMG 
id=Codehighlighter1_8627_8669_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_8627_8669_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_8627_8669_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_8627_8669_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_8627_8669_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_8627_8669_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_8627_8669_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_8627_8669_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_8627_8669_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_8627_8669_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Connect();<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SendCommand(</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN 
style="COLOR: #800000">RNFR&nbsp;</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #000000">+</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strOldFileName);<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(iReplyCode&nbsp;</SPAN><SPAN 
style="COLOR: #000000">!=</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">350</SPAN><SPAN style="COLOR: #000000">)<BR><IMG 
id=Codehighlighter1_8768_8845_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_8768_8845_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_8768_8845_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_8768_8845_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_8768_8845_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_8768_8845_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_8768_8845_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_8768_8845_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_8768_8845_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_8768_8845_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">throw</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN style="COLOR: #0000ff">new</SPAN><SPAN 
style="COLOR: #000000">&nbsp;IOException(strReply.Substring(</SPAN><SPAN 
style="COLOR: #800080">4</SPAN><SPAN style="COLOR: #000000">));<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #008000">//</SPAN><SPAN 
style="COLOR: #008000">&nbsp;&nbsp;如果新文件名与原有文件重名,将覆盖原有文件</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top></SPAN><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SendCommand(</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN 
style="COLOR: #800000">RNTO&nbsp;</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #000000">+</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strNewFileName);<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(iReplyCode&nbsp;</SPAN><SPAN 
style="COLOR: #000000">!=</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">250</SPAN><SPAN style="COLOR: #000000">)<BR><IMG 
id=Codehighlighter1_8982_9059_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_8982_9059_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_8982_9059_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_8982_9059_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_8982_9059_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_8982_9059_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_8982_9059_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_8982_9059_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_8982_9059_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_8982_9059_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">throw</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN style="COLOR: #0000ff">new</SPAN><SPAN 
style="COLOR: #000000">&nbsp;IOException(strReply.Substring(</SPAN><SPAN 
style="COLOR: #800080">4</SPAN><SPAN style="COLOR: #000000">));<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">#endregion</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><BR><IMG 
id=Codehighlighter1_9098_17985_Closed_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_9098_17985_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_9098_17985_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_9098_17985_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top><IMG id=Codehighlighter1_9098_17985_Open_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_9098_17985_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_9098_17985_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_9098_17985_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_9098_17985_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">上传和下载</SPAN><SPAN 
id=Codehighlighter1_9098_17985_Open_Text style="DISPLAY: none"><SPAN 
style="COLOR: #0000ff">#region</SPAN><SPAN 
style="COLOR: #000000">&nbsp;上传和下载</SPAN><SPAN style="COLOR: #000000"><BR><IMG 
id=Codehighlighter1_9120_9294_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_9120_9294_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_9120_9294_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_9120_9294_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_9120_9294_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_9120_9294_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_9120_9294_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_9120_9294_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_9120_9294_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</SPAN><SPAN 
id=Codehighlighter1_9120_9294_Open_Text><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN 
style="COLOR: #008000">&nbsp;下载一批文件<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;/summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;param&nbsp;name="strFileNameMask"&gt;</SPAN><SPAN 
style="COLOR: #008000">文件名的匹配字符串</SPAN><SPAN 
style="COLOR: #808080">&lt;/param&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;param&nbsp;name="strFolder"&gt;</SPAN><SPAN 
style="COLOR: #008000">本地目录(不得以\结束)</SPAN><SPAN 
style="COLOR: #808080">&lt;/param&gt;</SPAN></SPAN><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">public</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">void</SPAN><SPAN 
style="COLOR: #000000">&nbsp;Get(</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strFileNameMask,&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strFolder)<BR><IMG 
id=Codehighlighter1_9368_9894_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_9368_9894_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_9368_9894_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_9368_9894_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_9368_9894_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_9368_9894_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_9368_9894_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_9368_9894_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_9368_9894_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_9368_9894_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN style="COLOR: #000000">&nbsp;(</SPAN><SPAN 
style="COLOR: #000000">!</SPAN><SPAN style="COLOR: #000000">bConnected)<BR><IMG 
id=Codehighlighter1_9411_9453_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_9411_9453_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_9411_9453_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_9411_9453_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_9411_9453_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_9411_9453_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_9411_9453_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_9411_9453_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_9411_9453_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_9411_9453_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Connect();<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">[]&nbsp;strFiles&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;Dir(strFileNameMask);<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">foreach</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strFile&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">in</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strFiles)<BR><IMG 
id=Codehighlighter1_9569_9884_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_9569_9884_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_9569_9884_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_9569_9884_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_9569_9884_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_9569_9884_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_9569_9884_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_9569_9884_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_9569_9884_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_9569_9884_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN style="COLOR: #000000">&nbsp;(</SPAN><SPAN 
style="COLOR: #000000">!</SPAN><SPAN 
style="COLOR: #000000">strFile.Equals(</SPAN><SPAN 
style="COLOR: #800000">""</SPAN><SPAN style="COLOR: #000000">))</SPAN><SPAN 
style="COLOR: #008000">//</SPAN><SPAN 
style="COLOR: #008000">一般来说strFiles的最后一个元素可能是空字符串</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG id=Codehighlighter1_9656_9870_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_9656_9870_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_9656_9870_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_9656_9870_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_9656_9870_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_9656_9870_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_9656_9870_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_9656_9870_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top></SPAN><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_9656_9870_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_9656_9870_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(strFile.LastIndexOf(</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #800000">.</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">)&nbsp;</SPAN><SPAN 
style="COLOR: #000000">&gt;</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN style="COLOR: #000000">-</SPAN><SPAN 
style="COLOR: #800080">1</SPAN><SPAN style="COLOR: #000000">)<BR><IMG 
id=Codehighlighter1_9733_9852_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_9733_9852_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_9733_9852_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_9733_9852_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_9733_9852_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_9733_9852_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_9733_9852_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_9733_9852_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_9733_9852_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_9733_9852_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get(strFile.Replace(</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #800000">\r</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">,&nbsp;</SPAN><SPAN 
style="COLOR: #800000">""</SPAN><SPAN 
style="COLOR: #000000">),&nbsp;strFolder,&nbsp;strFile.Replace(</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #800000">\r</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">,&nbsp;</SPAN><SPAN 
style="COLOR: #800000">""</SPAN><SPAN style="COLOR: #000000">));<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top><BR><IMG id=Codehighlighter1_9905_10139_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_9905_10139_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_9905_10139_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_9905_10139_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_9905_10139_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_9905_10139_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_9905_10139_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_9905_10139_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_9905_10139_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</SPAN><SPAN 
id=Codehighlighter1_9905_10139_Open_Text><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;下载目录<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;/summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;param&nbsp;name="strRemoteFileName"&gt;</SPAN><SPAN 
style="COLOR: #008000">要下载的文件名</SPAN><SPAN 
style="COLOR: #808080">&lt;/param&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;param&nbsp;name="strFolder"&gt;</SPAN><SPAN 
style="COLOR: #008000">本地目录(不得以\结束)</SPAN><SPAN 
style="COLOR: #808080">&lt;/param&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;param&nbsp;name="strLocalFileName"&gt;</SPAN><SPAN 
style="COLOR: #008000">保存在本地时的文件名</SPAN><SPAN 
style="COLOR: #808080">&lt;/param&gt;</SPAN></SPAN><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">public</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">void</SPAN><SPAN 
style="COLOR: #000000">&nbsp;Get(</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strRemoteFileName,&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strFolder,&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strLocalFileName)<BR><IMG 
id=Codehighlighter1_10240_12189_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_10240_12189_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_10240_12189_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_10240_12189_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_10240_12189_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_10240_12189_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_10240_12189_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_10240_12189_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_10240_12189_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_10240_12189_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(strLocalFileName.StartsWith(</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #800000">-r</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">))<BR><IMG 
id=Codehighlighter1_10305_12179_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_10305_12179_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_10305_12179_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_10305_12179_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_10305_12179_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_10305_12179_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_10305_12179_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_10305_12179_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_10305_12179_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_10305_12179_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">[]&nbsp;infos&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strLocalFileName.Split(</SPAN><SPAN 
style="COLOR: #800000">'</SPAN><SPAN style="COLOR: #800000">&nbsp;</SPAN><SPAN 
style="COLOR: #800000">'</SPAN><SPAN style="COLOR: #000000">);<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strRemoteFileName</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">strLocalFileName&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;infos[infos.Length&nbsp;</SPAN><SPAN 
style="COLOR: #000000">-</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">1</SPAN><SPAN style="COLOR: #000000">];<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN style="COLOR: #000000">&nbsp;(</SPAN><SPAN 
style="COLOR: #000000">!</SPAN><SPAN style="COLOR: #000000">bConnected)<BR><IMG 
id=Codehighlighter1_10497_10547_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_10497_10547_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_10497_10547_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_10497_10547_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_10497_10547_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_10497_10547_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_10497_10547_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_10497_10547_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_10497_10547_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_10497_10547_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Connect();<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SetTransferType(TransferType.Binary);<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(strLocalFileName.Equals(</SPAN><SPAN 
style="COLOR: #800000">""</SPAN><SPAN style="COLOR: #000000">))<BR><IMG 
id=Codehighlighter1_10667_10744_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_10667_10744_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_10667_10744_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_10667_10744_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_10667_10744_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_10667_10744_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_10667_10744_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_10667_10744_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_10667_10744_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_10667_10744_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strLocalFileName&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strRemoteFileName;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN style="COLOR: #000000">&nbsp;(</SPAN><SPAN 
style="COLOR: #000000">!</SPAN><SPAN 
style="COLOR: #000000">File.Exists(strLocalFileName))<BR><IMG 
id=Codehighlighter1_10813_10927_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_10813_10927_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_10813_10927_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_10813_10927_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_10813_10927_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_10813_10927_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_10813_10927_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_10813_10927_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_10813_10927_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_10813_10927_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Stream&nbsp;st&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;File.Create(strLocalFileName);<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;st.Close();<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FileStream&nbsp;output&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">new</SPAN><SPAN style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FileStream(strFolder&nbsp;</SPAN><SPAN 
style="COLOR: #000000">+</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #800000">\\</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #000000">+</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strLocalFileName,&nbsp;FileMode.Create);<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Socket&nbsp;socketData&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;CreateDataSocket();<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SendCommand(</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN 
style="COLOR: #800000">RETR&nbsp;</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #000000">+</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strRemoteFileName);<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN style="COLOR: #000000">&nbsp;(</SPAN><SPAN 
style="COLOR: #000000">!</SPAN><SPAN 
style="COLOR: #000000">(iReplyCode&nbsp;</SPAN><SPAN 
style="COLOR: #000000">==</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">150</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #000000">||</SPAN><SPAN 
style="COLOR: #000000">&nbsp;iReplyCode&nbsp;</SPAN><SPAN 
style="COLOR: #000000">==</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">125</SPAN><SPAN style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #000000">||</SPAN><SPAN 
style="COLOR: #000000">&nbsp;iReplyCode&nbsp;</SPAN><SPAN 
style="COLOR: #000000">==</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">226</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #000000">||</SPAN><SPAN 
style="COLOR: #000000">&nbsp;iReplyCode&nbsp;</SPAN><SPAN 
style="COLOR: #000000">==</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">250</SPAN><SPAN style="COLOR: #000000">))<BR><IMG 
id=Codehighlighter1_11308_11393_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_11308_11393_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_11308_11393_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_11308_11393_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_11308_11393_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_11308_11393_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_11308_11393_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_11308_11393_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_11308_11393_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_11308_11393_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">throw</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN style="COLOR: #0000ff">new</SPAN><SPAN 
style="COLOR: #000000">&nbsp;IOException(strReply.Substring(</SPAN><SPAN 
style="COLOR: #800080">4</SPAN><SPAN style="COLOR: #000000">));<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">while</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(</SPAN><SPAN 
style="COLOR: #0000ff">true</SPAN><SPAN style="COLOR: #000000">)<BR><IMG 
id=Codehighlighter1_11439_11702_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_11439_11702_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_11439_11702_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_11439_11702_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_11439_11702_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_11439_11702_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_11439_11702_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_11439_11702_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_11439_11702_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_11439_11702_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">int</SPAN><SPAN 
style="COLOR: #000000">&nbsp;iBytes&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;socketData.Receive(buffer,&nbsp;buffer.Length,&nbsp;</SPAN><SPAN 
style="COLOR: #800080">0</SPAN><SPAN style="COLOR: #000000">);<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output.Write(buffer,&nbsp;</SPAN><SPAN 
style="COLOR: #800080">0</SPAN><SPAN 
style="COLOR: #000000">,&nbsp;iBytes);<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(iBytes&nbsp;</SPAN><SPAN 
style="COLOR: #000000">&lt;=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN style="COLOR: #800080">0</SPAN><SPAN 
style="COLOR: #000000">)<BR><IMG id=Codehighlighter1_11630_11684_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_11630_11684_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_11630_11684_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_11630_11684_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_11630_11684_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_11630_11684_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_11630_11684_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_11630_11684_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_11630_11684_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_11630_11684_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">break</SPAN><SPAN style="COLOR: #000000">;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output.Close();<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(socketData.Connected)<BR><IMG 
id=Codehighlighter1_11793_11852_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_11793_11852_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_11793_11852_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_11793_11852_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_11793_11852_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_11793_11852_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_11793_11852_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_11793_11852_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_11793_11852_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_11793_11852_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;socketData.Close();<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN style="COLOR: #000000">&nbsp;(</SPAN><SPAN 
style="COLOR: #000000">!</SPAN><SPAN 
style="COLOR: #000000">(iReplyCode&nbsp;</SPAN><SPAN 
style="COLOR: #000000">==</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">226</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #000000">||</SPAN><SPAN 
style="COLOR: #000000">&nbsp;iReplyCode&nbsp;</SPAN><SPAN 
style="COLOR: #000000">==</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">250</SPAN><SPAN style="COLOR: #000000">))<BR><IMG 
id=Codehighlighter1_11932_12165_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_11932_12165_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_11932_12165_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_11932_12165_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_11932_12165_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_11932_12165_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_11932_12165_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_11932_12165_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_11932_12165_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_11932_12165_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ReadReply();<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN style="COLOR: #000000">&nbsp;(</SPAN><SPAN 
style="COLOR: #000000">!</SPAN><SPAN 
style="COLOR: #000000">(iReplyCode&nbsp;</SPAN><SPAN 
style="COLOR: #000000">==</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">226</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #000000">||</SPAN><SPAN 
style="COLOR: #000000">&nbsp;iReplyCode&nbsp;</SPAN><SPAN 
style="COLOR: #000000">==</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">250</SPAN><SPAN style="COLOR: #000000">))<BR><IMG 
id=Codehighlighter1_12054_12147_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_12054_12147_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_12054_12147_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_12054_12147_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_12054_12147_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_12054_12147_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_12054_12147_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_12054_12147_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_12054_12147_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_12054_12147_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">throw</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN style="COLOR: #0000ff">new</SPAN><SPAN 
style="COLOR: #000000">&nbsp;IOException(strReply.Substring(</SPAN><SPAN 
style="COLOR: #800080">4</SPAN><SPAN style="COLOR: #000000">));<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><BR><IMG 
id=Codehighlighter1_12199_12435_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_12199_12435_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_12199_12435_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_12199_12435_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_12199_12435_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_12199_12435_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_12199_12435_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_12199_12435_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_12199_12435_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</SPAN><SPAN 
id=Codehighlighter1_12199_12435_Open_Text><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN 
style="COLOR: #008000">&nbsp;下载一个文件<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;/summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;param&nbsp;name="strRemoteFileName"&gt;</SPAN><SPAN 
style="COLOR: #008000">要下载的文件名</SPAN><SPAN 
style="COLOR: #808080">&lt;/param&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;param&nbsp;name="strFolder"&gt;</SPAN><SPAN 
style="COLOR: #008000">本地目录(不得以\结束)</SPAN><SPAN 
style="COLOR: #808080">&lt;/param&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;param&nbsp;name="strLocalFileName"&gt;</SPAN><SPAN 
style="COLOR: #008000">保存在本地时的文件名</SPAN><SPAN 
style="COLOR: #808080">&lt;/param&gt;</SPAN></SPAN><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">public</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">void</SPAN><SPAN 
style="COLOR: #000000">&nbsp;GetFile(</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strRemoteFileName,&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strFolder,&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strLocalFileName)<BR><IMG 
id=Codehighlighter1_12540_14089_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_12540_14089_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_12540_14089_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_12540_14089_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_12540_14089_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_12540_14089_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_12540_14089_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_12540_14089_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_12540_14089_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_12540_14089_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN style="COLOR: #000000">&nbsp;(</SPAN><SPAN 
style="COLOR: #000000">!</SPAN><SPAN style="COLOR: #000000">bConnected)<BR><IMG 
id=Codehighlighter1_12583_12625_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_12583_12625_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_12583_12625_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_12583_12625_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_12583_12625_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_12583_12625_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_12583_12625_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_12583_12625_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_12583_12625_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_12583_12625_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Connect();<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SetTransferType(TransferType.Binary);<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(strLocalFileName.Equals(</SPAN><SPAN 
style="COLOR: #800000">""</SPAN><SPAN style="COLOR: #000000">))<BR><IMG 
id=Codehighlighter1_12733_12802_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_12733_12802_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_12733_12802_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_12733_12802_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_12733_12802_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_12733_12802_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_12733_12802_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_12733_12802_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_12733_12802_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_12733_12802_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strLocalFileName&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strRemoteFileName;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN style="COLOR: #000000">&nbsp;(</SPAN><SPAN 
style="COLOR: #000000">!</SPAN><SPAN 
style="COLOR: #000000">File.Exists(strLocalFileName))<BR><IMG 
id=Codehighlighter1_12863_12965_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_12863_12965_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_12863_12965_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_12863_12965_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_12863_12965_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_12863_12965_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_12863_12965_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_12863_12965_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_12863_12965_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_12863_12965_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Stream&nbsp;st&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;File.Create(strLocalFileName);<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;st.Close();<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FileStream&nbsp;output&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">new</SPAN><SPAN style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FileStream(strFolder&nbsp;</SPAN><SPAN 
style="COLOR: #000000">+</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #800000">\\</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #000000">+</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strLocalFileName,&nbsp;FileMode.Create);<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Socket&nbsp;socketData&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;CreateDataSocket();<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SendCommand(</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN 
style="COLOR: #800000">RETR&nbsp;</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #000000">+</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strRemoteFileName);<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN style="COLOR: #000000">&nbsp;(</SPAN><SPAN 
style="COLOR: #000000">!</SPAN><SPAN 
style="COLOR: #000000">(iReplyCode&nbsp;</SPAN><SPAN 
style="COLOR: #000000">==</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">150</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #000000">||</SPAN><SPAN 
style="COLOR: #000000">&nbsp;iReplyCode&nbsp;</SPAN><SPAN 
style="COLOR: #000000">==</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">125</SPAN><SPAN style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #000000">||</SPAN><SPAN 
style="COLOR: #000000">&nbsp;iReplyCode&nbsp;</SPAN><SPAN 
style="COLOR: #000000">==</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">226</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #000000">||</SPAN><SPAN 
style="COLOR: #000000">&nbsp;iReplyCode&nbsp;</SPAN><SPAN 
style="COLOR: #000000">==</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">250</SPAN><SPAN style="COLOR: #000000">))<BR><IMG 
id=Codehighlighter1_13318_13395_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_13318_13395_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_13318_13395_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_13318_13395_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_13318_13395_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_13318_13395_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_13318_13395_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_13318_13395_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_13318_13395_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_13318_13395_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">throw</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN style="COLOR: #0000ff">new</SPAN><SPAN 
style="COLOR: #000000">&nbsp;IOException(strReply.Substring(</SPAN><SPAN 
style="COLOR: #800080">4</SPAN><SPAN style="COLOR: #000000">));<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">while</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(</SPAN><SPAN 
style="COLOR: #0000ff">true</SPAN><SPAN style="COLOR: #000000">)<BR><IMG 
id=Codehighlighter1_13433_13668_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_13433_13668_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_13433_13668_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_13433_13668_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_13433_13668_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_13433_13668_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_13433_13668_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_13433_13668_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_13433_13668_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_13433_13668_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">int</SPAN><SPAN 
style="COLOR: #000000">&nbsp;iBytes&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;socketData.Receive(buffer,&nbsp;buffer.Length,&nbsp;</SPAN><SPAN 
style="COLOR: #800080">0</SPAN><SPAN style="COLOR: #000000">);<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output.Write(buffer,&nbsp;</SPAN><SPAN 
style="COLOR: #800080">0</SPAN><SPAN 
style="COLOR: #000000">,&nbsp;iBytes);<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(iBytes&nbsp;</SPAN><SPAN 
style="COLOR: #000000">&lt;=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN style="COLOR: #800080">0</SPAN><SPAN 
style="COLOR: #000000">)<BR><IMG id=Codehighlighter1_13608_13654_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_13608_13654_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_13608_13654_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_13608_13654_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_13608_13654_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_13608_13654_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_13608_13654_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_13608_13654_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_13608_13654_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_13608_13654_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">break</SPAN><SPAN style="COLOR: #000000">;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output.Close();<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(socketData.Connected)<BR><IMG 
id=Codehighlighter1_13747_13798_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_13747_13798_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_13747_13798_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_13747_13798_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_13747_13798_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_13747_13798_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_13747_13798_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_13747_13798_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_13747_13798_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_13747_13798_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;socketData.Close();<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN style="COLOR: #000000">&nbsp;(</SPAN><SPAN 
style="COLOR: #000000">!</SPAN><SPAN 
style="COLOR: #000000">(iReplyCode&nbsp;</SPAN><SPAN 
style="COLOR: #000000">==</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">226</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #000000">||</SPAN><SPAN 
style="COLOR: #000000">&nbsp;iReplyCode&nbsp;</SPAN><SPAN 
style="COLOR: #000000">==</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">250</SPAN><SPAN style="COLOR: #000000">))<BR><IMG 
id=Codehighlighter1_13870_14079_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_13870_14079_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_13870_14079_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_13870_14079_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_13870_14079_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_13870_14079_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_13870_14079_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_13870_14079_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_13870_14079_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_13870_14079_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ReadReply();<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN style="COLOR: #000000">&nbsp;(</SPAN><SPAN 
style="COLOR: #000000">!</SPAN><SPAN 
style="COLOR: #000000">(iReplyCode&nbsp;</SPAN><SPAN 
style="COLOR: #000000">==</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">226</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #000000">||</SPAN><SPAN 
style="COLOR: #000000">&nbsp;iReplyCode&nbsp;</SPAN><SPAN 
style="COLOR: #000000">==</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">250</SPAN><SPAN style="COLOR: #000000">))<BR><IMG 
id=Codehighlighter1_13980_14065_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_13980_14065_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_13980_14065_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_13980_14065_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_13980_14065_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_13980_14065_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_13980_14065_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_13980_14065_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_13980_14065_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_13980_14065_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">throw</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN style="COLOR: #0000ff">new</SPAN><SPAN 
style="COLOR: #000000">&nbsp;IOException(strReply.Substring(</SPAN><SPAN 
style="COLOR: #800080">4</SPAN><SPAN style="COLOR: #000000">));<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><BR><IMG 
id=Codehighlighter1_14099_14335_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_14099_14335_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_14099_14335_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_14099_14335_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_14099_14335_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_14099_14335_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_14099_14335_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_14099_14335_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_14099_14335_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</SPAN><SPAN 
id=Codehighlighter1_14099_14335_Open_Text><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN 
style="COLOR: #008000">&nbsp;下载一个文件<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;/summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;param&nbsp;name="strRemoteFileName"&gt;</SPAN><SPAN 
style="COLOR: #008000">要下载的文件名</SPAN><SPAN 
style="COLOR: #808080">&lt;/param&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;param&nbsp;name="strFolder"&gt;</SPAN><SPAN 
style="COLOR: #008000">本地目录(不得以\结束)</SPAN><SPAN 
style="COLOR: #808080">&lt;/param&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;param&nbsp;name="strLocalFileName"&gt;</SPAN><SPAN 
style="COLOR: #008000">保存在本地时的文件名</SPAN><SPAN 
style="COLOR: #808080">&lt;/param&gt;</SPAN></SPAN><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">public</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">void</SPAN><SPAN 
style="COLOR: #000000">&nbsp;GetBrokenFile(</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strRemoteFileName,&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strFolder,&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strLocalFileName,</SPAN><SPAN 
style="COLOR: #0000ff">long</SPAN><SPAN 
style="COLOR: #000000">&nbsp;size)<BR><IMG 
id=Codehighlighter1_14456_16251_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_14456_16251_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_14456_16251_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_14456_16251_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_14456_16251_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_14456_16251_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_14456_16251_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_14456_16251_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_14456_16251_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_14456_16251_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN style="COLOR: #000000">&nbsp;(</SPAN><SPAN 
style="COLOR: #000000">!</SPAN><SPAN style="COLOR: #000000">bConnected)<BR><IMG 
id=Codehighlighter1_14499_14541_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_14499_14541_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_14499_14541_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_14499_14541_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_14499_14541_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_14499_14541_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_14499_14541_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_14499_14541_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_14499_14541_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_14499_14541_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Connect();<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SetTransferType(TransferType.Binary);<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FileStream&nbsp;output&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">new</SPAN><SPAN style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FileStream(strFolder&nbsp;</SPAN><SPAN 
style="COLOR: #000000">+</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #800000">\\</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #000000">+</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strLocalFileName,&nbsp;FileMode.Append);<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Socket&nbsp;socketData&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;CreateDataSocket();<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SendCommand(</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN 
style="COLOR: #800000">REST&nbsp;</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #000000">+</SPAN><SPAN 
style="COLOR: #000000">&nbsp;size.ToString());<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SendCommand(</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN 
style="COLOR: #800000">RETR&nbsp;</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #000000">+</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strRemoteFileName);<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN style="COLOR: #000000">&nbsp;(</SPAN><SPAN 
style="COLOR: #000000">!</SPAN><SPAN 
style="COLOR: #000000">(iReplyCode&nbsp;</SPAN><SPAN 
style="COLOR: #000000">==</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">150</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #000000">||</SPAN><SPAN 
style="COLOR: #000000">&nbsp;iReplyCode&nbsp;</SPAN><SPAN 
style="COLOR: #000000">==</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">125</SPAN><SPAN style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #000000">||</SPAN><SPAN 
style="COLOR: #000000">&nbsp;iReplyCode&nbsp;</SPAN><SPAN 
style="COLOR: #000000">==</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">226</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #000000">||</SPAN><SPAN 
style="COLOR: #000000">&nbsp;iReplyCode&nbsp;</SPAN><SPAN 
style="COLOR: #000000">==</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">250</SPAN><SPAN style="COLOR: #000000">))<BR><IMG 
id=Codehighlighter1_15010_15087_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_15010_15087_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_15010_15087_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_15010_15087_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_15010_15087_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_15010_15087_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_15010_15087_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_15010_15087_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_15010_15087_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_15010_15087_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">throw</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN style="COLOR: #0000ff">new</SPAN><SPAN 
style="COLOR: #000000">&nbsp;IOException(strReply.Substring(</SPAN><SPAN 
style="COLOR: #800080">4</SPAN><SPAN style="COLOR: #000000">));<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #008000">//</SPAN><SPAN 
style="COLOR: #008000">int&nbsp;byteYu&nbsp;=&nbsp;(int)size&nbsp;%&nbsp;512;<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #008000">//</SPAN><SPAN 
style="COLOR: #008000">int&nbsp;byteChu&nbsp;=&nbsp;(int)size&nbsp;/&nbsp;512;<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #008000">//</SPAN><SPAN 
style="COLOR: #008000">byte[]&nbsp;tempBuffer&nbsp;=&nbsp;new&nbsp;byte[byteYu];<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #008000">//</SPAN><SPAN 
style="COLOR: #008000">for&nbsp;(int&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;byteChu;&nbsp;i++)<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #008000">//</SPAN><SPAN style="COLOR: #008000">{<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #008000">//</SPAN><SPAN 
style="COLOR: #008000">&nbsp;&nbsp;&nbsp;&nbsp;socketData.Receive(buffer,&nbsp;buffer.Length,&nbsp;0);<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #008000">//</SPAN><SPAN style="COLOR: #008000">}<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #008000">//</SPAN><SPAN 
style="COLOR: #008000">socketData.Receive(tempBuffer,&nbsp;tempBuffer.Length,&nbsp;0);<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #008000">//</SPAN><SPAN 
style="COLOR: #008000">socketData.Receive(buffer,&nbsp;byteYu,&nbsp;0);</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top></SPAN><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">while</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(</SPAN><SPAN 
style="COLOR: #0000ff">true</SPAN><SPAN style="COLOR: #000000">)<BR><IMG 
id=Codehighlighter1_15538_15830_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_15538_15830_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_15538_15830_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_15538_15830_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_15538_15830_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_15538_15830_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_15538_15830_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_15538_15830_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_15538_15830_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_15538_15830_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">int</SPAN><SPAN 
style="COLOR: #000000">&nbsp;iBytes&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;socketData.Receive(buffer,&nbsp;buffer.Length,&nbsp;</SPAN><SPAN 
style="COLOR: #800080">0</SPAN><SPAN style="COLOR: #000000">);<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #008000">//</SPAN><SPAN 
style="COLOR: #008000">totalBytes&nbsp;+=&nbsp;iBytes;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top></SPAN><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output.Write(buffer,&nbsp;</SPAN><SPAN 
style="COLOR: #800080">0</SPAN><SPAN 
style="COLOR: #000000">,&nbsp;iBytes);<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(iBytes&nbsp;</SPAN><SPAN 
style="COLOR: #000000">&lt;=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN style="COLOR: #800080">0</SPAN><SPAN 
style="COLOR: #000000">)<BR><IMG id=Codehighlighter1_15770_15816_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_15770_15816_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_15770_15816_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_15770_15816_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_15770_15816_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_15770_15816_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_15770_15816_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_15770_15816_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_15770_15816_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_15770_15816_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">break</SPAN><SPAN style="COLOR: #000000">;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output.Close();<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(socketData.Connected)<BR><IMG 
id=Codehighlighter1_15909_15960_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_15909_15960_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_15909_15960_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_15909_15960_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_15909_15960_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_15909_15960_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_15909_15960_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_15909_15960_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_15909_15960_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_15909_15960_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;socketData.Close();<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN style="COLOR: #000000">&nbsp;(</SPAN><SPAN 
style="COLOR: #000000">!</SPAN><SPAN 
style="COLOR: #000000">(iReplyCode&nbsp;</SPAN><SPAN 
style="COLOR: #000000">==</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">226</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #000000">||</SPAN><SPAN 
style="COLOR: #000000">&nbsp;iReplyCode&nbsp;</SPAN><SPAN 
style="COLOR: #000000">==</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">250</SPAN><SPAN style="COLOR: #000000">))<BR><IMG 
id=Codehighlighter1_16032_16241_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_16032_16241_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_16032_16241_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_16032_16241_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_16032_16241_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_16032_16241_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_16032_16241_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_16032_16241_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_16032_16241_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_16032_16241_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ReadReply();<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN style="COLOR: #000000">&nbsp;(</SPAN><SPAN 
style="COLOR: #000000">!</SPAN><SPAN 
style="COLOR: #000000">(iReplyCode&nbsp;</SPAN><SPAN 
style="COLOR: #000000">==</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">226</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #000000">||</SPAN><SPAN 
style="COLOR: #000000">&nbsp;iReplyCode&nbsp;</SPAN><SPAN 
style="COLOR: #000000">==</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">250</SPAN><SPAN style="COLOR: #000000">))<BR><IMG 
id=Codehighlighter1_16142_16227_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_16142_16227_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_16142_16227_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_16142_16227_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_16142_16227_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_16142_16227_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_16142_16227_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_16142_16227_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_16142_16227_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_16142_16227_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">throw</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN style="COLOR: #0000ff">new</SPAN><SPAN 
style="COLOR: #000000">&nbsp;IOException(strReply.Substring(</SPAN><SPAN 
style="COLOR: #800080">4</SPAN><SPAN style="COLOR: #000000">));<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><BR><IMG 
id=Codehighlighter1_16263_16444_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_16263_16444_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_16263_16444_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_16263_16444_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_16263_16444_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_16263_16444_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_16263_16444_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_16263_16444_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_16263_16444_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</SPAN><SPAN 
id=Codehighlighter1_16263_16444_Open_Text><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN 
style="COLOR: #008000">&nbsp;上传一批文件<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;/summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;param&nbsp;name="strFolder"&gt;</SPAN><SPAN 
style="COLOR: #008000">本地目录(不得以\结束)</SPAN><SPAN 
style="COLOR: #808080">&lt;/param&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;param&nbsp;name="strFileNameMask"&gt;</SPAN><SPAN 
style="COLOR: #008000">文件名匹配字符(可以包含*和?)</SPAN><SPAN 
style="COLOR: #808080">&lt;/param&gt;</SPAN></SPAN><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">public</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">void</SPAN><SPAN 
style="COLOR: #000000">&nbsp;Put(</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strFolder,&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strFileNameMask)<BR><IMG 
id=Codehighlighter1_16518_16755_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_16518_16755_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_16518_16755_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_16518_16755_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_16518_16755_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_16518_16755_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_16518_16755_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_16518_16755_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_16518_16755_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_16518_16755_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">[]&nbsp;strFiles&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;Directory.GetFiles(strFolder,&nbsp;strFileNameMask);<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">foreach</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strFile&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">in</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strFiles)<BR><IMG 
id=Codehighlighter1_16661_16745_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_16661_16745_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_16661_16745_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_16661_16745_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_16661_16745_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_16661_16745_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_16661_16745_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_16661_16745_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_16661_16745_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_16661_16745_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #008000">//</SPAN><SPAN 
style="COLOR: #008000">strFile是完整的文件名(包含路径)</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top></SPAN><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Put(strFile);<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top><BR><IMG id=Codehighlighter1_16766_16874_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_16766_16874_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_16766_16874_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_16766_16874_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_16766_16874_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_16766_16874_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_16766_16874_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_16766_16874_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_16766_16874_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</SPAN><SPAN 
id=Codehighlighter1_16766_16874_Open_Text><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN 
style="COLOR: #008000">&nbsp;上传一个文件<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;/summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;param&nbsp;name="strFileName"&gt;</SPAN><SPAN 
style="COLOR: #008000">本地文件名</SPAN><SPAN 
style="COLOR: #808080">&lt;/param&gt;</SPAN></SPAN><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">public</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">void</SPAN><SPAN 
style="COLOR: #000000">&nbsp;Put(</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strFileName)<BR><IMG 
id=Codehighlighter1_16926_17965_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_16926_17965_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_16926_17965_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_16926_17965_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_16926_17965_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_16926_17965_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_16926_17965_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_16926_17965_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_16926_17965_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_16926_17965_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN style="COLOR: #000000">&nbsp;(</SPAN><SPAN 
style="COLOR: #000000">!</SPAN><SPAN style="COLOR: #000000">bConnected)<BR><IMG 
id=Codehighlighter1_16969_17011_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_16969_17011_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_16969_17011_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_16969_17011_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_16969_17011_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_16969_17011_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_16969_17011_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_16969_17011_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_16969_17011_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_16969_17011_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Connect();<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Socket&nbsp;socketData&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;CreateDataSocket();<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SendCommand(</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN 
style="COLOR: #800000">STOR&nbsp;</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #000000">+</SPAN><SPAN 
style="COLOR: #000000">&nbsp;Path.GetFileName(strFileName));<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN style="COLOR: #000000">&nbsp;(</SPAN><SPAN 
style="COLOR: #000000">!</SPAN><SPAN 
style="COLOR: #000000">(iReplyCode&nbsp;</SPAN><SPAN 
style="COLOR: #000000">==</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">125</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #000000">||</SPAN><SPAN 
style="COLOR: #000000">&nbsp;iReplyCode&nbsp;</SPAN><SPAN 
style="COLOR: #000000">==</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">150</SPAN><SPAN style="COLOR: #000000">))<BR><IMG 
id=Codehighlighter1_17201_17278_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_17201_17278_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_17201_17278_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_17201_17278_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_17201_17278_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_17201_17278_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_17201_17278_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_17201_17278_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_17201_17278_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_17201_17278_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">throw</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN style="COLOR: #0000ff">new</SPAN><SPAN 
style="COLOR: #000000">&nbsp;IOException(strReply.Substring(</SPAN><SPAN 
style="COLOR: #800080">4</SPAN><SPAN style="COLOR: #000000">));<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FileStream&nbsp;input&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">new</SPAN><SPAN style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FileStream(strFileName,&nbsp;FileMode.Open);<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">int</SPAN><SPAN 
style="COLOR: #000000">&nbsp;iBytes&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">0</SPAN><SPAN style="COLOR: #000000">;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">while</SPAN><SPAN 
style="COLOR: #000000">&nbsp;((iBytes&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;input.Read(buffer,&nbsp;</SPAN><SPAN 
style="COLOR: #800080">0</SPAN><SPAN 
style="COLOR: #000000">,&nbsp;buffer.Length))&nbsp;</SPAN><SPAN 
style="COLOR: #000000">&gt;</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN style="COLOR: #800080">0</SPAN><SPAN 
style="COLOR: #000000">)<BR><IMG id=Codehighlighter1_17478_17545_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_17478_17545_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_17478_17545_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_17478_17545_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_17478_17545_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_17478_17545_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_17478_17545_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_17478_17545_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_17478_17545_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_17478_17545_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;socketData.Send(buffer,&nbsp;iBytes,&nbsp;</SPAN><SPAN 
style="COLOR: #800080">0</SPAN><SPAN style="COLOR: #000000">);<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;input.Close();<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(socketData.Connected)<BR><IMG 
id=Codehighlighter1_17623_17674_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_17623_17674_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_17623_17674_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_17623_17674_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_17623_17674_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_17623_17674_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_17623_17674_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_17623_17674_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_17623_17674_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_17623_17674_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;socketData.Close();<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN style="COLOR: #000000">&nbsp;(</SPAN><SPAN 
style="COLOR: #000000">!</SPAN><SPAN 
style="COLOR: #000000">(iReplyCode&nbsp;</SPAN><SPAN 
style="COLOR: #000000">==</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">226</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #000000">||</SPAN><SPAN 
style="COLOR: #000000">&nbsp;iReplyCode&nbsp;</SPAN><SPAN 
style="COLOR: #000000">==</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">250</SPAN><SPAN style="COLOR: #000000">))<BR><IMG 
id=Codehighlighter1_17746_17955_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_17746_17955_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_17746_17955_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_17746_17955_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_17746_17955_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_17746_17955_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_17746_17955_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_17746_17955_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_17746_17955_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_17746_17955_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ReadReply();<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN style="COLOR: #000000">&nbsp;(</SPAN><SPAN 
style="COLOR: #000000">!</SPAN><SPAN 
style="COLOR: #000000">(iReplyCode&nbsp;</SPAN><SPAN 
style="COLOR: #000000">==</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">226</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #000000">||</SPAN><SPAN 
style="COLOR: #000000">&nbsp;iReplyCode&nbsp;</SPAN><SPAN 
style="COLOR: #000000">==</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">250</SPAN><SPAN style="COLOR: #000000">))<BR><IMG 
id=Codehighlighter1_17856_17941_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_17856_17941_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_17856_17941_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_17856_17941_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_17856_17941_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_17856_17941_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_17856_17941_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_17856_17941_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_17856_17941_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_17856_17941_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">throw</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN style="COLOR: #0000ff">new</SPAN><SPAN 
style="COLOR: #000000">&nbsp;IOException(strReply.Substring(</SPAN><SPAN 
style="COLOR: #800080">4</SPAN><SPAN style="COLOR: #000000">));<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">#endregion</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><BR><IMG 
id=Codehighlighter1_17995_19490_Closed_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_17995_19490_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_17995_19490_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_17995_19490_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top><IMG id=Codehighlighter1_17995_19490_Open_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_17995_19490_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_17995_19490_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_17995_19490_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_17995_19490_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">目录操作</SPAN><SPAN 
id=Codehighlighter1_17995_19490_Open_Text style="DISPLAY: none"><SPAN 
style="COLOR: #0000ff">#region</SPAN><SPAN 
style="COLOR: #000000">&nbsp;目录操作</SPAN><SPAN style="COLOR: #000000"><BR><IMG 
id=Codehighlighter1_18016_18119_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_18016_18119_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_18016_18119_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_18016_18119_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_18016_18119_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_18016_18119_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_18016_18119_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_18016_18119_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_18016_18119_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</SPAN><SPAN 
id=Codehighlighter1_18016_18119_Open_Text><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;创建目录<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;/summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;param&nbsp;name="strDirName"&gt;</SPAN><SPAN 
style="COLOR: #008000">目录名</SPAN><SPAN 
style="COLOR: #808080">&lt;/param&gt;</SPAN></SPAN><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">public</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">void</SPAN><SPAN 
style="COLOR: #000000">&nbsp;MkDir(</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strDirName)<BR><IMG 
id=Codehighlighter1_18172_18438_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_18172_18438_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_18172_18438_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_18172_18438_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_18172_18438_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_18172_18438_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_18172_18438_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_18172_18438_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_18172_18438_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_18172_18438_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN style="COLOR: #000000">&nbsp;(</SPAN><SPAN 
style="COLOR: #000000">!</SPAN><SPAN style="COLOR: #000000">bConnected)<BR><IMG 
id=Codehighlighter1_18215_18257_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_18215_18257_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_18215_18257_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_18215_18257_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_18215_18257_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_18215_18257_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_18215_18257_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_18215_18257_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_18215_18257_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_18215_18257_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Connect();<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SendCommand(</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN 
style="COLOR: #800000">MKD&nbsp;</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #000000">+</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strDirName);<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(iReplyCode&nbsp;</SPAN><SPAN 
style="COLOR: #000000">!=</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">257</SPAN><SPAN style="COLOR: #000000">)<BR><IMG 
id=Codehighlighter1_18351_18428_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_18351_18428_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_18351_18428_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_18351_18428_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_18351_18428_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_18351_18428_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_18351_18428_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_18351_18428_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_18351_18428_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_18351_18428_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">throw</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN style="COLOR: #0000ff">new</SPAN><SPAN 
style="COLOR: #000000">&nbsp;IOException(strReply.Substring(</SPAN><SPAN 
style="COLOR: #800080">4</SPAN><SPAN style="COLOR: #000000">));<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top><BR><IMG id=Codehighlighter1_18449_18552_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_18449_18552_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_18449_18552_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_18449_18552_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_18449_18552_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_18449_18552_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_18449_18552_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_18449_18552_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_18449_18552_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</SPAN><SPAN 
id=Codehighlighter1_18449_18552_Open_Text><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;删除目录<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;/summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;param&nbsp;name="strDirName"&gt;</SPAN><SPAN 
style="COLOR: #008000">目录名</SPAN><SPAN 
style="COLOR: #808080">&lt;/param&gt;</SPAN></SPAN><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">public</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">void</SPAN><SPAN 
style="COLOR: #000000">&nbsp;RmDir(</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strDirName)<BR><IMG 
id=Codehighlighter1_18605_18871_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_18605_18871_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_18605_18871_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_18605_18871_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_18605_18871_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_18605_18871_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_18605_18871_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_18605_18871_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_18605_18871_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_18605_18871_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN style="COLOR: #000000">&nbsp;(</SPAN><SPAN 
style="COLOR: #000000">!</SPAN><SPAN style="COLOR: #000000">bConnected)<BR><IMG 
id=Codehighlighter1_18648_18690_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_18648_18690_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_18648_18690_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_18648_18690_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_18648_18690_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_18648_18690_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_18648_18690_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_18648_18690_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_18648_18690_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_18648_18690_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Connect();<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SendCommand(</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN 
style="COLOR: #800000">RMD&nbsp;</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #000000">+</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strDirName);<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(iReplyCode&nbsp;</SPAN><SPAN 
style="COLOR: #000000">!=</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">250</SPAN><SPAN style="COLOR: #000000">)<BR><IMG 
id=Codehighlighter1_18784_18861_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_18784_18861_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_18784_18861_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_18784_18861_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_18784_18861_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_18784_18861_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_18784_18861_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_18784_18861_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_18784_18861_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_18784_18861_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">throw</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN style="COLOR: #0000ff">new</SPAN><SPAN 
style="COLOR: #000000">&nbsp;IOException(strReply.Substring(</SPAN><SPAN 
style="COLOR: #800080">4</SPAN><SPAN style="COLOR: #000000">));<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top><BR><IMG id=Codehighlighter1_18882_18989_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_18882_18989_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_18882_18989_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_18882_18989_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_18882_18989_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_18882_18989_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_18882_18989_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_18882_18989_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_18882_18989_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</SPAN><SPAN 
id=Codehighlighter1_18882_18989_Open_Text><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;改变目录<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;/summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;param&nbsp;name="strDirName"&gt;</SPAN><SPAN 
style="COLOR: #008000">新的工作目录名</SPAN><SPAN 
style="COLOR: #808080">&lt;/param&gt;</SPAN></SPAN><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">public</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">void</SPAN><SPAN 
style="COLOR: #000000">&nbsp;ChDir(</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strDirName)<BR><IMG 
id=Codehighlighter1_19042_19470_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_19042_19470_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_19042_19470_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_19042_19470_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_19042_19470_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_19042_19470_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_19042_19470_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_19042_19470_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_19042_19470_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_19042_19470_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(strDirName.Equals(</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #800000">.</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">)&nbsp;</SPAN><SPAN 
style="COLOR: #000000">||</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strDirName.Equals(</SPAN><SPAN 
style="COLOR: #800000">""</SPAN><SPAN style="COLOR: #000000">))<BR><IMG 
id=Codehighlighter1_19121_19160_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_19121_19160_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_19121_19160_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_19121_19160_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_19121_19160_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_19121_19160_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_19121_19160_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_19121_19160_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_19121_19160_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_19121_19160_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">return</SPAN><SPAN style="COLOR: #000000">;<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN style="COLOR: #000000">&nbsp;(</SPAN><SPAN 
style="COLOR: #000000">!</SPAN><SPAN style="COLOR: #000000">bConnected)<BR><IMG 
id=Codehighlighter1_19202_19244_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_19202_19244_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_19202_19244_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_19202_19244_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_19202_19244_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_19202_19244_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_19202_19244_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_19202_19244_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_19202_19244_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_19202_19244_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Connect();<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SendCommand(</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN 
style="COLOR: #800000">CWD&nbsp;</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #000000">+</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strDirName);<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(iReplyCode&nbsp;</SPAN><SPAN 
style="COLOR: #000000">!=</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">250</SPAN><SPAN style="COLOR: #000000">)<BR><IMG 
id=Codehighlighter1_19338_19415_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_19338_19415_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_19338_19415_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_19338_19415_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_19338_19415_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_19338_19415_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_19338_19415_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_19338_19415_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_19338_19415_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_19338_19415_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">throw</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN style="COLOR: #0000ff">new</SPAN><SPAN 
style="COLOR: #000000">&nbsp;IOException(strReply.Substring(</SPAN><SPAN 
style="COLOR: #800080">4</SPAN><SPAN style="COLOR: #000000">));<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">this</SPAN><SPAN 
style="COLOR: #000000">.strRemotePath&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strDirName;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">#endregion</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><BR><IMG 
id=Codehighlighter1_19500_20356_Closed_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_19500_20356_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_19500_20356_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_19500_20356_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top><IMG id=Codehighlighter1_19500_20356_Open_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_19500_20356_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_19500_20356_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_19500_20356_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_19500_20356_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">内部变量</SPAN><SPAN 
id=Codehighlighter1_19500_20356_Open_Text style="DISPLAY: none"><SPAN 
style="COLOR: #0000ff">#region</SPAN><SPAN 
style="COLOR: #000000">&nbsp;内部变量</SPAN><SPAN style="COLOR: #000000"><BR><IMG 
id=Codehighlighter1_19521_19588_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_19521_19588_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_19521_19588_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_19521_19588_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_19521_19588_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_19521_19588_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_19521_19588_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_19521_19588_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_19521_19588_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</SPAN><SPAN 
id=Codehighlighter1_19521_19588_Open_Text><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN 
style="COLOR: #008000">&nbsp;服务器返回的应答信息(包含应答码)<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;/summary&gt;</SPAN></SPAN><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">private</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strMsg;<BR><IMG 
id=Codehighlighter1_19627_19694_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_19627_19694_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_19627_19694_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_19627_19694_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_19627_19694_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_19627_19694_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_19627_19694_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_19627_19694_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_19627_19694_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</SPAN><SPAN 
id=Codehighlighter1_19627_19694_Open_Text><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN 
style="COLOR: #008000">&nbsp;服务器返回的应答信息(包含应答码)<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;/summary&gt;</SPAN></SPAN><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">private</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strReply;<BR><IMG 
id=Codehighlighter1_19735_19794_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_19735_19794_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_19735_19794_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_19735_19794_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_19735_19794_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_19735_19794_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_19735_19794_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_19735_19794_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_19735_19794_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</SPAN><SPAN 
id=Codehighlighter1_19735_19794_Open_Text><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN 
style="COLOR: #008000">&nbsp;服务器返回的应答码<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;/summary&gt;</SPAN></SPAN><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">private</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN style="COLOR: #0000ff">int</SPAN><SPAN 
style="COLOR: #000000">&nbsp;iReplyCode;<BR><IMG 
id=Codehighlighter1_19834_19897_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_19834_19897_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_19834_19897_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_19834_19897_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_19834_19897_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_19834_19897_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_19834_19897_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_19834_19897_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_19834_19897_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</SPAN><SPAN 
id=Codehighlighter1_19834_19897_Open_Text><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN 
style="COLOR: #008000">&nbsp;进行控制连接的socket<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;/summary&gt;</SPAN></SPAN><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">private</SPAN><SPAN 
style="COLOR: #000000">&nbsp;Socket&nbsp;socketControl;<BR><IMG 
id=Codehighlighter1_19943_19997_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_19943_19997_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_19943_19997_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_19943_19997_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_19943_19997_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_19943_19997_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_19943_19997_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_19943_19997_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_19943_19997_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</SPAN><SPAN 
id=Codehighlighter1_19943_19997_Open_Text><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;传输模式<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;/summary&gt;</SPAN></SPAN><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">private</SPAN><SPAN 
style="COLOR: #000000">&nbsp;TransferType&nbsp;trType;<BR><IMG 
id=Codehighlighter1_20042_20103_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_20042_20103_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_20042_20103_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_20042_20103_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_20042_20103_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_20042_20103_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_20042_20103_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_20042_20103_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_20042_20103_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</SPAN><SPAN 
id=Codehighlighter1_20042_20103_Open_Text><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN 
style="COLOR: #008000">&nbsp;接收和发送数据的缓冲区<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;/summary&gt;</SPAN></SPAN><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">private</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">static</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN style="COLOR: #0000ff">int</SPAN><SPAN 
style="COLOR: #000000">&nbsp;BLOCK_SIZE&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">512</SPAN><SPAN style="COLOR: #000000">;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Byte[]&nbsp;buffer&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">new</SPAN><SPAN 
style="COLOR: #000000">&nbsp;Byte[BLOCK_SIZE];<BR><IMG 
id=Codehighlighter1_20202_20280_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_20202_20280_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_20202_20280_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_20202_20280_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_20202_20280_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_20202_20280_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_20202_20280_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_20202_20280_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_20202_20280_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</SPAN><SPAN 
id=Codehighlighter1_20202_20280_Open_Text><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN 
style="COLOR: #008000">&nbsp;编码方式(为防止出现中文乱码采用&nbsp;GB2312编码方式)<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;/summary&gt;</SPAN></SPAN><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Encoding&nbsp;GB2312&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;Encoding.GetEncoding(</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #800000">gb2312</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">);<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">#endregion</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><BR><IMG 
id=Codehighlighter1_20366_24610_Closed_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_20366_24610_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_20366_24610_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_20366_24610_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top><IMG id=Codehighlighter1_20366_24610_Open_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_20366_24610_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_20366_24610_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_20366_24610_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_20366_24610_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">内部函数</SPAN><SPAN 
id=Codehighlighter1_20366_24610_Open_Text style="DISPLAY: none"><SPAN 
style="COLOR: #0000ff">#region</SPAN><SPAN 
style="COLOR: #000000">&nbsp;内部函数</SPAN><SPAN style="COLOR: #000000"><BR><IMG 
id=Codehighlighter1_20387_20492_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_20387_20492_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_20387_20492_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_20387_20492_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_20387_20492_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_20387_20492_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_20387_20492_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_20387_20492_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_20387_20492_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</SPAN><SPAN 
id=Codehighlighter1_20387_20492_Open_Text><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN 
style="COLOR: #008000">&nbsp;将一行应答字符串记录在strReply和strMsg<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN 
style="COLOR: #008000">&nbsp;应答码记录在iReplyCode<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;/summary&gt;</SPAN></SPAN><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">private</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">void</SPAN><SPAN 
style="COLOR: #000000">&nbsp;ReadReply()<BR><IMG 
id=Codehighlighter1_20533_20668_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_20533_20668_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_20533_20668_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_20533_20668_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_20533_20668_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_20533_20668_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_20533_20668_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_20533_20668_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_20533_20668_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_20533_20668_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strMsg&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800000">""</SPAN><SPAN style="COLOR: #000000">;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strReply&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;ReadLine();<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iReplyCode&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;Int32.Parse(strReply.Substring(</SPAN><SPAN 
style="COLOR: #800080">0</SPAN><SPAN style="COLOR: #000000">,&nbsp;</SPAN><SPAN 
style="COLOR: #800080">3</SPAN><SPAN style="COLOR: #000000">));<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><BR><IMG 
id=Codehighlighter1_20678_20785_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_20678_20785_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_20678_20785_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_20678_20785_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_20678_20785_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_20678_20785_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_20678_20785_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_20678_20785_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_20678_20785_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</SPAN><SPAN 
id=Codehighlighter1_20678_20785_Open_Text><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN 
style="COLOR: #008000">&nbsp;建立进行数据连接的socket<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;/summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;returns&gt;</SPAN><SPAN 
style="COLOR: #008000">数据连接socket</SPAN><SPAN 
style="COLOR: #808080">&lt;/returns&gt;</SPAN></SPAN><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">private</SPAN><SPAN 
style="COLOR: #000000">&nbsp;Socket&nbsp;CreateDataSocket()<BR><IMG 
id=Codehighlighter1_20835_22749_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_20835_22749_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_20835_22749_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_20835_22749_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_20835_22749_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_20835_22749_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_20835_22749_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_20835_22749_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_20835_22749_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_20835_22749_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SendCommand(</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #800000">PASV</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">);<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(iReplyCode&nbsp;</SPAN><SPAN 
style="COLOR: #000000">!=</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">227</SPAN><SPAN style="COLOR: #000000">)<BR><IMG 
id=Codehighlighter1_20917_20994_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_20917_20994_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_20917_20994_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_20917_20994_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_20917_20994_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_20917_20994_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_20917_20994_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_20917_20994_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_20917_20994_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_20917_20994_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">throw</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN style="COLOR: #0000ff">new</SPAN><SPAN 
style="COLOR: #000000">&nbsp;IOException(strReply.Substring(</SPAN><SPAN 
style="COLOR: #800080">4</SPAN><SPAN style="COLOR: #000000">));<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">int</SPAN><SPAN 
style="COLOR: #000000">&nbsp;index1&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strReply.IndexOf(</SPAN><SPAN 
style="COLOR: #800000">'</SPAN><SPAN style="COLOR: #800000">(</SPAN><SPAN 
style="COLOR: #800000">'</SPAN><SPAN style="COLOR: #000000">);<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">int</SPAN><SPAN 
style="COLOR: #000000">&nbsp;index2&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strReply.IndexOf(</SPAN><SPAN 
style="COLOR: #800000">'</SPAN><SPAN style="COLOR: #800000">)</SPAN><SPAN 
style="COLOR: #800000">'</SPAN><SPAN style="COLOR: #000000">);<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;ipData&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strReply.Substring(index1&nbsp;</SPAN><SPAN 
style="COLOR: #000000">+</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">1</SPAN><SPAN 
style="COLOR: #000000">,&nbsp;index2&nbsp;</SPAN><SPAN 
style="COLOR: #000000">-</SPAN><SPAN 
style="COLOR: #000000">&nbsp;index1&nbsp;</SPAN><SPAN 
style="COLOR: #000000">-</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">1</SPAN><SPAN style="COLOR: #000000">);<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">int</SPAN><SPAN 
style="COLOR: #000000">[]&nbsp;parts&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">new</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">int</SPAN><SPAN style="COLOR: #000000">[</SPAN><SPAN 
style="COLOR: #800080">6</SPAN><SPAN style="COLOR: #000000">];<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">int</SPAN><SPAN 
style="COLOR: #000000">&nbsp;len&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;ipData.Length;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">int</SPAN><SPAN 
style="COLOR: #000000">&nbsp;partCount&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">0</SPAN><SPAN style="COLOR: #000000">;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;buf&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800000">""</SPAN><SPAN style="COLOR: #000000">;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">for</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(</SPAN><SPAN 
style="COLOR: #0000ff">int</SPAN><SPAN 
style="COLOR: #000000">&nbsp;i&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">0</SPAN><SPAN 
style="COLOR: #000000">;&nbsp;i&nbsp;</SPAN><SPAN 
style="COLOR: #000000">&lt;</SPAN><SPAN 
style="COLOR: #000000">&nbsp;len&nbsp;</SPAN><SPAN 
style="COLOR: #000000">&amp;&amp;</SPAN><SPAN 
style="COLOR: #000000">&nbsp;partCount&nbsp;</SPAN><SPAN 
style="COLOR: #000000">&lt;=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN style="COLOR: #800080">6</SPAN><SPAN 
style="COLOR: #000000">;&nbsp;i</SPAN><SPAN 
style="COLOR: #000000">++</SPAN><SPAN style="COLOR: #000000">)<BR><IMG 
id=Codehighlighter1_21391_22154_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_21391_22154_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_21391_22154_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_21391_22154_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_21391_22154_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_21391_22154_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_21391_22154_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_21391_22154_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_21391_22154_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_21391_22154_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">char</SPAN><SPAN 
style="COLOR: #000000">&nbsp;ch&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;Char.Parse(ipData.Substring(i,&nbsp;</SPAN><SPAN 
style="COLOR: #800080">1</SPAN><SPAN style="COLOR: #000000">));<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(Char.IsDigit(ch))<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf&nbsp;</SPAN><SPAN 
style="COLOR: #000000">+=</SPAN><SPAN style="COLOR: #000000">&nbsp;ch;<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">else</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN style="COLOR: #0000ff">if</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(ch&nbsp;</SPAN><SPAN 
style="COLOR: #000000">!=</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800000">'</SPAN><SPAN style="COLOR: #800000">,</SPAN><SPAN 
style="COLOR: #800000">'</SPAN><SPAN style="COLOR: #000000">)<BR><IMG 
id=Codehighlighter1_21576_21698_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_21576_21698_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_21576_21698_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_21576_21698_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_21576_21698_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_21576_21698_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_21576_21698_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_21576_21698_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_21576_21698_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_21576_21698_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">throw</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN style="COLOR: #0000ff">new</SPAN><SPAN 
style="COLOR: #000000">&nbsp;IOException(</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN 
style="COLOR: #800000">Malformed&nbsp;PASV&nbsp;strReply:&nbsp;</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #000000">+</SPAN><SPAN style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strReply);<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(ch&nbsp;</SPAN><SPAN 
style="COLOR: #000000">==</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800000">'</SPAN><SPAN style="COLOR: #800000">,</SPAN><SPAN 
style="COLOR: #800000">'</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #000000">||</SPAN><SPAN 
style="COLOR: #000000">&nbsp;i&nbsp;</SPAN><SPAN 
style="COLOR: #000000">+</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">1</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #000000">==</SPAN><SPAN style="COLOR: #000000">&nbsp;len)<BR><IMG 
id=Codehighlighter1_21762_22140_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_21762_22140_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_21762_22140_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_21762_22140_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_21762_22140_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_21762_22140_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_21762_22140_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_21762_22140_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_21762_22140_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_21762_22140_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">try</SPAN><SPAN style="COLOR: #000000"><BR><IMG 
id=Codehighlighter1_21808_21928_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_21808_21928_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_21808_21928_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_21808_21928_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_21808_21928_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_21808_21928_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_21808_21928_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_21808_21928_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_21808_21928_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_21808_21928_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parts[partCount</SPAN><SPAN 
style="COLOR: #000000">++</SPAN><SPAN style="COLOR: #000000">]&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;Int32.Parse(buf);<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800000">""</SPAN><SPAN style="COLOR: #000000">;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">catch</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(Exception)<BR><IMG 
id=Codehighlighter1_21987_22122_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_21987_22122_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_21987_22122_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_21987_22122_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_21987_22122_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_21987_22122_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_21987_22122_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_21987_22122_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_21987_22122_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_21987_22122_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">throw</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN style="COLOR: #0000ff">new</SPAN><SPAN 
style="COLOR: #000000">&nbsp;IOException(</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN 
style="COLOR: #800000">Malformed&nbsp;PASV&nbsp;strReply:&nbsp;</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #000000">+</SPAN><SPAN style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strReply);<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;ipAddress&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;parts[</SPAN><SPAN 
style="COLOR: #800080">0</SPAN><SPAN style="COLOR: #000000">]&nbsp;</SPAN><SPAN 
style="COLOR: #000000">+</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #800000">.</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #000000">+</SPAN><SPAN 
style="COLOR: #000000">&nbsp;parts[</SPAN><SPAN 
style="COLOR: #800080">1</SPAN><SPAN style="COLOR: #000000">]&nbsp;</SPAN><SPAN 
style="COLOR: #000000">+</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #800000">.</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #000000">+</SPAN><SPAN style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parts[</SPAN><SPAN 
style="COLOR: #800080">2</SPAN><SPAN style="COLOR: #000000">]&nbsp;</SPAN><SPAN 
style="COLOR: #000000">+</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #800000">.</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #000000">+</SPAN><SPAN 
style="COLOR: #000000">&nbsp;parts[</SPAN><SPAN 
style="COLOR: #800080">3</SPAN><SPAN style="COLOR: #000000">];<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">int</SPAN><SPAN 
style="COLOR: #000000">&nbsp;port&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(parts[</SPAN><SPAN 
style="COLOR: #800080">4</SPAN><SPAN style="COLOR: #000000">]&nbsp;</SPAN><SPAN 
style="COLOR: #000000">&lt;&lt;</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN style="COLOR: #800080">8</SPAN><SPAN 
style="COLOR: #000000">)&nbsp;</SPAN><SPAN style="COLOR: #000000">+</SPAN><SPAN 
style="COLOR: #000000">&nbsp;parts[</SPAN><SPAN 
style="COLOR: #800080">5</SPAN><SPAN style="COLOR: #000000">];<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Socket&nbsp;s&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">new</SPAN><SPAN style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Socket(AddressFamily.InterNetwork,&nbsp;SocketType.Stream,&nbsp;ProtocolType.Tcp);<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPEndPoint&nbsp;ep&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">new</SPAN><SPAN style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPEndPoint(IPAddress.Parse(ipAddress),&nbsp;port);<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">try</SPAN><SPAN style="COLOR: #000000"><BR><IMG 
id=Codehighlighter1_22540_22586_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_22540_22586_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_22540_22586_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_22540_22586_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_22540_22586_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_22540_22586_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_22540_22586_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_22540_22586_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_22540_22586_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_22540_22586_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s.Connect(ep);<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">catch</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(Exception)<BR><IMG 
id=Codehighlighter1_22629_22717_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_22629_22717_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_22629_22717_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_22629_22717_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_22629_22717_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_22629_22717_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_22629_22717_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_22629_22717_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_22629_22717_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_22629_22717_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">throw</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN style="COLOR: #0000ff">new</SPAN><SPAN 
style="COLOR: #000000">&nbsp;IOException(</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN 
style="COLOR: #800000">Can't&nbsp;connect&nbsp;to&nbsp;remote&nbsp;server</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">);<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">return</SPAN><SPAN 
style="COLOR: #000000">&nbsp;s;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top><BR><IMG id=Codehighlighter1_22760_22828_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_22760_22828_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_22760_22828_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_22760_22828_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_22760_22828_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_22760_22828_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_22760_22828_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_22760_22828_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_22760_22828_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</SPAN><SPAN 
id=Codehighlighter1_22760_22828_Open_Text><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN 
style="COLOR: #008000">&nbsp;关闭socket连接(用于登录以前)<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;/summary&gt;</SPAN></SPAN><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">private</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">void</SPAN><SPAN 
style="COLOR: #000000">&nbsp;CloseSocketConnect()<BR><IMG 
id=Codehighlighter1_22878_23065_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_22878_23065_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_22878_23065_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_22878_23065_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_22878_23065_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_22878_23065_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_22878_23065_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_22878_23065_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_22878_23065_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_22878_23065_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(socketControl&nbsp;</SPAN><SPAN 
style="COLOR: #000000">!=</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">null</SPAN><SPAN style="COLOR: #000000">)<BR><IMG 
id=Codehighlighter1_22931_23023_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_22931_23023_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_22931_23023_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_22931_23023_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_22931_23023_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_22931_23023_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_22931_23023_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_22931_23023_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_22931_23023_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_22931_23023_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;socketControl.Close();<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;socketControl&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">null</SPAN><SPAN style="COLOR: #000000">;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bConnected&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">false</SPAN><SPAN style="COLOR: #000000">;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><BR><IMG 
id=Codehighlighter1_23075_23183_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_23075_23183_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_23075_23183_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_23075_23183_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_23075_23183_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_23075_23183_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_23075_23183_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_23075_23183_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_23075_23183_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</SPAN><SPAN 
id=Codehighlighter1_23075_23183_Open_Text><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN 
style="COLOR: #008000">&nbsp;读取Socket返回的所有字符串<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;/summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;returns&gt;</SPAN><SPAN 
style="COLOR: #008000">包含应答码的字符串行</SPAN><SPAN 
style="COLOR: #808080">&lt;/returns&gt;</SPAN></SPAN><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">private</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;ReadLine()<BR><IMG 
id=Codehighlighter1_23225_24205_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_23225_24205_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_23225_24205_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_23225_24205_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_23225_24205_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_23225_24205_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_23225_24205_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_23225_24205_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_23225_24205_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_23225_24205_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">while</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(</SPAN><SPAN 
style="COLOR: #0000ff">true</SPAN><SPAN style="COLOR: #000000">)<BR><IMG 
id=Codehighlighter1_23264_23527_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_23264_23527_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_23264_23527_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_23264_23527_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_23264_23527_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_23264_23527_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_23264_23527_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_23264_23527_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_23264_23527_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_23264_23527_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">int</SPAN><SPAN 
style="COLOR: #000000">&nbsp;iBytes&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;socketControl.Receive(buffer,&nbsp;buffer.Length,&nbsp;</SPAN><SPAN 
style="COLOR: #800080">0</SPAN><SPAN style="COLOR: #000000">);<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strMsg&nbsp;</SPAN><SPAN 
style="COLOR: #000000">+=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;GB2312.GetString(buffer,&nbsp;</SPAN><SPAN 
style="COLOR: #800080">0</SPAN><SPAN 
style="COLOR: #000000">,&nbsp;iBytes);<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(iBytes&nbsp;</SPAN><SPAN 
style="COLOR: #000000">&lt;</SPAN><SPAN 
style="COLOR: #000000">&nbsp;buffer.Length)<BR><IMG 
id=Codehighlighter1_23467_23513_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_23467_23513_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_23467_23513_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_23467_23513_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_23467_23513_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_23467_23513_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_23467_23513_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_23467_23513_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_23467_23513_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_23467_23513_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">break</SPAN><SPAN style="COLOR: #000000">;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG id=Codehighlighter1_23559_23568_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_23559_23568_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_23559_23568_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_23559_23568_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_23559_23568_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_23559_23568_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_23559_23568_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_23559_23568_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">char</SPAN><SPAN 
style="COLOR: #000000">[]&nbsp;seperator&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
id=Codehighlighter1_23559_23568_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_23559_23568_Open_Text><SPAN 
style="COLOR: #000000">{&nbsp;</SPAN><SPAN style="COLOR: #800000">'</SPAN><SPAN 
style="COLOR: #800000">\n</SPAN><SPAN style="COLOR: #800000">'</SPAN><SPAN 
style="COLOR: #000000">&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000">;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">[]&nbsp;mess&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strMsg.Split(seperator);<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(strMsg.Length&nbsp;</SPAN><SPAN 
style="COLOR: #000000">&gt;</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN style="COLOR: #800080">2</SPAN><SPAN 
style="COLOR: #000000">)<BR><IMG id=Codehighlighter1_23670_23935_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_23670_23935_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_23670_23935_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_23670_23935_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_23670_23935_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_23670_23935_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_23670_23935_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_23670_23935_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_23670_23935_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_23670_23935_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strMsg&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;mess[mess.Length&nbsp;</SPAN><SPAN 
style="COLOR: #000000">-</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">2</SPAN><SPAN style="COLOR: #000000">];<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #008000">//</SPAN><SPAN 
style="COLOR: #008000">seperator[0]是10,换行符是由13和0组成的,分隔后10后面虽没有字符串,<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #008000">//</SPAN><SPAN 
style="COLOR: #008000">但也会分配为空字符串给后面(也是最后一个)字符串数组,<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #008000">//</SPAN><SPAN 
style="COLOR: #008000">所以最后一个mess是没用的空字符串<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #008000">//</SPAN><SPAN 
style="COLOR: #008000">但为什么不直接取mess[0],因为只有最后一行字符串应答码与信息之间有空格</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top></SPAN><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">else</SPAN><SPAN style="COLOR: #000000"><BR><IMG 
id=Codehighlighter1_23965_24014_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_23965_24014_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_23965_24014_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_23965_24014_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_23965_24014_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_23965_24014_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_23965_24014_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_23965_24014_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_23965_24014_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_23965_24014_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strMsg&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;mess[</SPAN><SPAN 
style="COLOR: #800080">0</SPAN><SPAN style="COLOR: #000000">];<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN style="COLOR: #000000">&nbsp;(</SPAN><SPAN 
style="COLOR: #000000">!</SPAN><SPAN 
style="COLOR: #000000">strMsg.Substring(</SPAN><SPAN 
style="COLOR: #800080">3</SPAN><SPAN style="COLOR: #000000">,&nbsp;</SPAN><SPAN 
style="COLOR: #800080">1</SPAN><SPAN 
style="COLOR: #000000">).Equals(</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #800000">&nbsp;</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">))</SPAN><SPAN 
style="COLOR: #008000">//</SPAN><SPAN 
style="COLOR: #008000">返回字符串正确的是以应答码(如220开头,后面接一空格,再接问候字符串)</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG id=Codehighlighter1_24118_24168_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_24118_24168_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_24118_24168_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_24118_24168_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_24118_24168_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_24118_24168_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_24118_24168_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_24118_24168_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top></SPAN><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_24118_24168_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_24118_24168_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">return</SPAN><SPAN 
style="COLOR: #000000">&nbsp;ReadLine();<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">return</SPAN><SPAN 
style="COLOR: #000000">&nbsp;strMsg;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top><BR><IMG id=Codehighlighter1_24216_24334_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_24216_24334_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_24216_24334_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_24216_24334_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_24216_24334_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_24216_24334_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_24216_24334_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_24216_24334_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_24216_24334_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</SPAN><SPAN 
id=Codehighlighter1_24216_24334_Open_Text><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN 
style="COLOR: #008000">&nbsp;发送命令并获取应答码和最后一行应答字符串<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;/summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;param&nbsp;name="strCommand"&gt;</SPAN><SPAN 
style="COLOR: #008000">命令</SPAN><SPAN 
style="COLOR: #808080">&lt;/param&gt;</SPAN></SPAN><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">private</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">void</SPAN><SPAN 
style="COLOR: #000000">&nbsp;SendCommand(String&nbsp;strCommand)<BR><IMG 
id=Codehighlighter1_24394_24590_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_24394_24590_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_24394_24590_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_24394_24590_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_24394_24590_Closed_Image 
style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_24394_24590_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_24394_24590_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_24394_24590_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_24394_24590_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_24394_24590_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Byte[]&nbsp;cmdBytes&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GB2312.GetBytes((strCommand&nbsp;</SPAN><SPAN 
style="COLOR: #000000">+</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #800000">\r\n</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN 
style="COLOR: #000000">).ToCharArray());<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;socketControl.Send(cmdBytes,&nbsp;cmdBytes.Length,&nbsp;</SPAN><SPAN 
style="COLOR: #800080">0</SPAN><SPAN style="COLOR: #000000">);<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ReadReply();<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">#endregion</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedBlockEnd.gif" 
align=top>}</SPAN></SPAN><SPAN style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/None.gif" 
align=top></SPAN></DIV><BR><BR>当然，大家还要看看Main方法 
<DIV 
style="BORDER-RIGHT: #cccccc 1px solid; PADDING-RIGHT: 5px; BORDER-TOP: #cccccc 1px solid; PADDING-LEFT: 4px; FONT-SIZE: 13px; PADDING-BOTTOM: 4px; BORDER-LEFT: #cccccc 1px solid; WIDTH: 98%; WORD-BREAK: break-all; PADDING-TOP: 4px; BORDER-BOTTOM: #cccccc 1px solid; BACKGROUND-COLOR: #eeeeee"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/None.gif" align=top><SPAN 
style="COLOR: #0000ff">using</SPAN><SPAN 
style="COLOR: #000000">&nbsp;System;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/None.gif" align=top></SPAN><SPAN 
style="COLOR: #0000ff">using</SPAN><SPAN 
style="COLOR: #000000">&nbsp;System.Collections.Generic;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/None.gif" align=top></SPAN><SPAN 
style="COLOR: #0000ff">using</SPAN><SPAN 
style="COLOR: #000000">&nbsp;System.Text;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/None.gif" align=top></SPAN><SPAN 
style="COLOR: #0000ff">using</SPAN><SPAN 
style="COLOR: #000000">&nbsp;System.IO;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/None.gif" align=top><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/None.gif" align=top></SPAN><SPAN 
style="COLOR: #0000ff">namespace</SPAN><SPAN 
style="COLOR: #000000">&nbsp;ftpGet<BR><IMG 
id=Codehighlighter1_102_4023_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_102_4023_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_102_4023_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_102_4023_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedBlockStart.gif" 
align=top><IMG id=Codehighlighter1_102_4023_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_102_4023_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_102_4023_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_102_4023_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedBlock.gif" 
align=top></SPAN><SPAN id=Codehighlighter1_102_4023_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_102_4023_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">class</SPAN><SPAN 
style="COLOR: #000000">&nbsp;Program<BR><IMG 
id=Codehighlighter1_126_4021_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_126_4021_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_126_4021_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_126_4021_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_126_4021_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_126_4021_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_126_4021_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_126_4021_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_126_4021_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_126_4021_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">static</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;remotingFolder&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;System.Configuration.ConfigurationSettings.AppSettings[</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN 
style="COLOR: #800000">remotingFolder</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN 
style="COLOR: #000000">];&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #008000">//</SPAN><SPAN 
style="COLOR: #008000">远程ftp文件目录</SPAN><SPAN style="COLOR: #008000"><BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top></SPAN><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">static</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;localFolder&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;System.Configuration.ConfigurationSettings.AppSettings[</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN 
style="COLOR: #800000">localFolder</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN 
style="COLOR: #000000">];&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #008000">//</SPAN><SPAN 
style="COLOR: #008000">要下载到的本地目录</SPAN><SPAN style="COLOR: #008000"><BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top></SPAN><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">static</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;ftpServer&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;System.Configuration.ConfigurationSettings.AppSettings[</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN 
style="COLOR: #800000">ftpServer</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN 
style="COLOR: #000000">];&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #008000">//</SPAN><SPAN style="COLOR: #008000">ftp服务器</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top></SPAN><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">static</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;user&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;System.Configuration.ConfigurationSettings.AppSettings[</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #800000">user</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN 
style="COLOR: #000000">];&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #008000">//</SPAN><SPAN style="COLOR: #008000">用户名</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top></SPAN><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">static</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;pwd&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;System.Configuration.ConfigurationSettings.AppSettings[</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #800000">pwd</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN 
style="COLOR: #000000">];&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #008000">//</SPAN><SPAN style="COLOR: #008000">密码</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top></SPAN><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">static</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;port&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;System.Configuration.ConfigurationSettings.AppSettings[</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #800000">port</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN 
style="COLOR: #000000">];&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #008000">//</SPAN><SPAN style="COLOR: #008000">端口</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top></SPAN><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">static</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">void</SPAN><SPAN 
style="COLOR: #000000">&nbsp;Main(</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">[]&nbsp;args)<BR><IMG 
id=Codehighlighter1_831_1178_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_831_1178_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_831_1178_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_831_1178_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_831_1178_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_831_1178_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_831_1178_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_831_1178_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_831_1178_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_831_1178_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FTPClient&nbsp;client&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">new</SPAN><SPAN 
style="COLOR: #000000">&nbsp;FTPClient(ftpServer,&nbsp;</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #800000">/</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN 
style="COLOR: #000000">,&nbsp;user,&nbsp;pwd,&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">int</SPAN><SPAN 
style="COLOR: #000000">.Parse(port));<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;client.Connect();<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GetFolder(</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #800000">*</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN 
style="COLOR: #000000">,&nbsp;remotingFolder,&nbsp;client,&nbsp;CreateFolder());<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;client.DisConnect();<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ClearFolder();<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Console.WriteLine(</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #800000">下载完毕</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">);<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.Threading.Thread.Sleep(</SPAN><SPAN 
style="COLOR: #800080">3000</SPAN><SPAN style="COLOR: #000000">);<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><BR><IMG 
id=Codehighlighter1_1188_1316_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1188_1316_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_1188_1316_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_1188_1316_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_1188_1316_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1188_1316_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_1188_1316_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_1188_1316_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_1188_1316_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</SPAN><SPAN 
id=Codehighlighter1_1188_1316_Open_Text><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN 
style="COLOR: #008000">&nbsp;在本地目录下创建一个以日期为名称的目录，我做这个ftp的主要目的是为了每天都备份<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;/summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;returns&gt;</SPAN><SPAN 
style="COLOR: #008000">创建的目录名</SPAN><SPAN 
style="COLOR: #808080">&lt;/returns&gt;</SPAN></SPAN><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">private</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">static</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;CreateFolder()<BR><IMG 
id=Codehighlighter1_1369_1595_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1369_1595_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_1369_1595_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_1369_1595_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_1369_1595_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1369_1595_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_1369_1595_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_1369_1595_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_1369_1595_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_1369_1595_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;folder</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">localFolder&nbsp;</SPAN><SPAN 
style="COLOR: #000000">+</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #800000">\\</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">+</SPAN><SPAN 
style="COLOR: #000000">DateTime.Now.ToShortDateString();<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN style="COLOR: #000000">&nbsp;(</SPAN><SPAN 
style="COLOR: #000000">!</SPAN><SPAN 
style="COLOR: #000000">Directory.Exists(folder))<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Directory.CreateDirectory(folder);<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">return</SPAN><SPAN 
style="COLOR: #000000">&nbsp;folder;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><BR><IMG 
id=Codehighlighter1_1605_1672_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1605_1672_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_1605_1672_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_1605_1672_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_1605_1672_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1605_1672_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_1605_1672_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_1605_1672_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_1605_1672_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</SPAN><SPAN 
id=Codehighlighter1_1605_1672_Open_Text><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN 
style="COLOR: #008000">&nbsp;在下载结束后清空程序目录的多余文件<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;/summary&gt;</SPAN></SPAN><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">private</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">static</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">void</SPAN><SPAN 
style="COLOR: #000000">&nbsp;ClearFolder()<BR><IMG 
id=Codehighlighter1_1722_2063_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1722_2063_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_1722_2063_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_1722_2063_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_1722_2063_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1722_2063_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_1722_2063_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_1722_2063_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_1722_2063_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_1722_2063_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;folder&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;Environment.CurrentDirectory;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">[]&nbsp;dictorys&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;Directory.GetFiles(folder);<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">foreach</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;dictory&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">in</SPAN><SPAN 
style="COLOR: #000000">&nbsp;dictorys)<BR><IMG 
id=Codehighlighter1_1903_2053_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1903_2053_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_1903_2053_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_1903_2053_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_1903_2053_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_1903_2053_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_1903_2053_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_1903_2053_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_1903_2053_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_1903_2053_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FileInfo&nbsp;info&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">new</SPAN><SPAN 
style="COLOR: #000000">&nbsp;FileInfo(dictory);<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(info.Length&nbsp;</SPAN><SPAN 
style="COLOR: #000000">==</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">0</SPAN><SPAN style="COLOR: #000000">)<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;File.Delete(dictory);<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><BR><IMG 
id=Codehighlighter1_2073_2312_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_2073_2312_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_2073_2312_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_2073_2312_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_2073_2312_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_2073_2312_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_2073_2312_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_2073_2312_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_2073_2312_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</SPAN><SPAN 
id=Codehighlighter1_2073_2312_Open_Text><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN 
style="COLOR: #008000">&nbsp;递归获取ftp文件夹的内容<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;/summary&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;param&nbsp;name="fileMark"&gt;</SPAN><SPAN 
style="COLOR: #008000">文件标记</SPAN><SPAN 
style="COLOR: #808080">&lt;/param&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;param&nbsp;name="path"&gt;</SPAN><SPAN 
style="COLOR: #008000">远程路径</SPAN><SPAN 
style="COLOR: #808080">&lt;/param&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;param&nbsp;name="client"&gt;&lt;/param&gt;</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #808080">///</SPAN><SPAN style="COLOR: #008000">&nbsp;</SPAN><SPAN 
style="COLOR: #808080">&lt;param&nbsp;name="folder"&gt;&lt;/param&gt;</SPAN></SPAN><BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">private</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">static</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">void</SPAN><SPAN 
style="COLOR: #000000">&nbsp;GetFolder(</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;fileMark,&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;path,&nbsp;FTPClient&nbsp;client,&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;folder)<BR><IMG 
id=Codehighlighter1_2421_4015_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_2421_4015_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_2421_4015_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_2421_4015_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_2421_4015_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_2421_4015_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_2421_4015_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_2421_4015_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_2421_4015_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_2421_4015_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">[]&nbsp;dirs&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;client.Dir(path);&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #008000">//</SPAN><SPAN 
style="COLOR: #008000">获取目录下的内容</SPAN><SPAN style="COLOR: #008000"><BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top></SPAN><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;client.ChDir(path);&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #008000">//</SPAN><SPAN style="COLOR: #008000">改变目录</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top></SPAN><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">foreach</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;dir&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">in</SPAN><SPAN style="COLOR: #000000">&nbsp;dirs)<BR><IMG 
id=Codehighlighter1_2574_4004_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_2574_4004_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_2574_4004_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_2574_4004_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_2574_4004_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_2574_4004_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_2574_4004_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_2574_4004_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_2574_4004_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_2574_4004_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">[]&nbsp;infos&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;dir.Split(</SPAN><SPAN 
style="COLOR: #800000">'</SPAN><SPAN style="COLOR: #800000">&nbsp;</SPAN><SPAN 
style="COLOR: #800000">'</SPAN><SPAN style="COLOR: #000000">);<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;info&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;infos[infos.Length&nbsp;</SPAN><SPAN 
style="COLOR: #000000">-</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800080">1</SPAN><SPAN 
style="COLOR: #000000">].Replace(</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #800000">\r</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">,&nbsp;</SPAN><SPAN 
style="COLOR: #800000">""</SPAN><SPAN style="COLOR: #000000">);<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(dir.StartsWith(</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #800000">d</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">)&nbsp;</SPAN><SPAN 
style="COLOR: #000000">&amp;&amp;</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN style="COLOR: #000000">!</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">.IsNullOrEmpty(dir))&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #008000">//</SPAN><SPAN style="COLOR: #008000">为目录</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG id=Codehighlighter1_2793_3153_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_2793_3153_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_2793_3153_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_2793_3153_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_2793_3153_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_2793_3153_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_2793_3153_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_2793_3153_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top></SPAN><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_2793_3153_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_2793_3153_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN style="COLOR: #000000">&nbsp;(</SPAN><SPAN 
style="COLOR: #000000">!</SPAN><SPAN 
style="COLOR: #000000">info.EndsWith(</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #800000">.</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">)&nbsp;</SPAN><SPAN 
style="COLOR: #000000">&amp;&amp;</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN style="COLOR: #000000">!</SPAN><SPAN 
style="COLOR: #000000">info.EndsWith(</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #800000">..</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN 
style="COLOR: #000000">))&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #008000">//</SPAN><SPAN 
style="COLOR: #008000">筛选出真实的目录</SPAN><SPAN style="COLOR: #008000"><BR><IMG 
id=Codehighlighter1_2897_3135_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_2897_3135_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_2897_3135_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_2897_3135_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_2897_3135_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_2897_3135_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_2897_3135_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_2897_3135_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top></SPAN><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_2897_3135_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_2897_3135_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Directory.CreateDirectory(folder&nbsp;</SPAN><SPAN 
style="COLOR: #000000">+</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #800000">\\</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #000000">+</SPAN><SPAN style="COLOR: #000000">&nbsp;info);<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GetFolder(fileMark,&nbsp;path&nbsp;</SPAN><SPAN 
style="COLOR: #000000">+</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #800000">/</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #000000">+</SPAN><SPAN 
style="COLOR: #000000">&nbsp;info,&nbsp;client,&nbsp;folder&nbsp;</SPAN><SPAN 
style="COLOR: #000000">+</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #800000">\\</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #000000">+</SPAN><SPAN style="COLOR: #000000">&nbsp;info);<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;client.ChDir(path);<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">else</SPAN><SPAN 
style="COLOR: #000000">&nbsp;</SPAN><SPAN style="COLOR: #0000ff">if</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(dir.StartsWith(</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #800000">-r</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN 
style="COLOR: #000000">))&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #008000">//</SPAN><SPAN style="COLOR: #008000">为文件</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG id=Codehighlighter1_3224_3990_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_3224_3990_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_3224_3990_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_3224_3990_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_3224_3990_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_3224_3990_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_3224_3990_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_3224_3990_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top></SPAN><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_3224_3990_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_3224_3990_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">string</SPAN><SPAN 
style="COLOR: #000000">&nbsp;file&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;folder&nbsp;</SPAN><SPAN 
style="COLOR: #000000">+</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #800000">\\</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #000000">+</SPAN><SPAN style="COLOR: #000000">&nbsp;info;<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(File.Exists(file))&nbsp;&nbsp;<BR><IMG 
id=Codehighlighter1_3349_3761_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_3349_3761_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_3349_3761_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_3349_3761_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_3349_3761_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_3349_3761_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_3349_3761_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_3349_3761_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_3349_3761_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_3349_3761_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">long</SPAN><SPAN 
style="COLOR: #000000">&nbsp;remotingSize&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;client.GetFileSize(info);<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FileInfo&nbsp;fileInfo&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">new</SPAN><SPAN 
style="COLOR: #000000">&nbsp;FileInfo(file);<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">long</SPAN><SPAN 
style="COLOR: #000000">&nbsp;localSize&nbsp;</SPAN><SPAN 
style="COLOR: #000000">=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;fileInfo.Length;<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">if</SPAN><SPAN 
style="COLOR: #000000">&nbsp;(remotingSize&nbsp;</SPAN><SPAN 
style="COLOR: #000000">!=</SPAN><SPAN 
style="COLOR: #000000">&nbsp;localSize)&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #008000">//</SPAN><SPAN style="COLOR: #008000">短点续传</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG id=Codehighlighter1_3631_3739_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_3631_3739_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_3631_3739_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_3631_3739_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_3631_3739_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_3631_3739_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_3631_3739_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_3631_3739_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top></SPAN><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_3631_3739_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_3631_3739_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;client.GetBrokenFile(info,&nbsp;folder,&nbsp;info,&nbsp;localSize);<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">else</SPAN><SPAN style="COLOR: #000000"><BR><IMG 
id=Codehighlighter1_3807_3972_Open_Image 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_3807_3972_Open_Text').style.display='none'; document.getElementById('Codehighlighter1_3807_3972_Closed_Image').style.display='inline'; document.getElementById('Codehighlighter1_3807_3972_Closed_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockStart.gif" 
align=top><IMG id=Codehighlighter1_3807_3972_Closed_Image style="DISPLAY: none" 
onclick="this.style.display='none'; document.getElementById('Codehighlighter1_3807_3972_Closed_Text').style.display='none'; document.getElementById('Codehighlighter1_3807_3972_Open_Image').style.display='inline'; document.getElementById('Codehighlighter1_3807_3972_Open_Text').style.display='inline';" 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ContractedSubBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
id=Codehighlighter1_3807_3972_Closed_Text 
style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/dot.gif"></SPAN><SPAN 
id=Codehighlighter1_3807_3972_Open_Text><SPAN style="COLOR: #000000">{<BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;client.GetFile(info,&nbsp;folder,&nbsp;info);&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #008000">//</SPAN><SPAN style="COLOR: #008000">下载文件</SPAN><SPAN 
style="COLOR: #008000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top></SPAN><SPAN 
style="COLOR: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Console.WriteLine(</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #800000">文件</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #000000">+</SPAN><SPAN 
style="COLOR: #000000">&nbsp;folder&nbsp;</SPAN><SPAN 
style="COLOR: #000000">+</SPAN><SPAN 
style="COLOR: #000000">&nbsp;info&nbsp;</SPAN><SPAN 
style="COLOR: #000000">+</SPAN><SPAN style="COLOR: #000000">&nbsp;</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #800000">已经下载</SPAN><SPAN 
style="COLOR: #800000">"</SPAN><SPAN style="COLOR: #000000">);<BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/InBlock.gif" align=top><BR><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedSubBlockEnd.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;}</SPAN></SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ExpandedBlockEnd.gif" 
align=top>}</SPAN></SPAN><SPAN style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/None.gif" 
align=top></SPAN></DIV><BR>配置文件<BR>
<DIV 
style="BORDER-RIGHT: #cccccc 1px solid; PADDING-RIGHT: 5px; BORDER-TOP: #cccccc 1px solid; PADDING-LEFT: 4px; FONT-SIZE: 13px; PADDING-BOTTOM: 4px; BORDER-LEFT: #cccccc 1px solid; WIDTH: 98%; WORD-BREAK: break-all; PADDING-TOP: 4px; BORDER-BOTTOM: #cccccc 1px solid; BACKGROUND-COLOR: #eeeeee"><IMG 
alt="" src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/None.gif" align=top><SPAN 
style="COLOR: #0000ff">&lt;?</SPAN><SPAN 
style="COLOR: #ff00ff">xml&nbsp;version="1.0"&nbsp;encoding="utf-8"&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">?&gt;</SPAN><SPAN style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/None.gif" align=top></SPAN><SPAN 
style="COLOR: #0000ff">&lt;</SPAN><SPAN 
style="COLOR: #800000">configuration</SPAN><SPAN 
style="COLOR: #0000ff">&gt;</SPAN><SPAN style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/None.gif" 
align=top>&nbsp;&nbsp;</SPAN><SPAN style="COLOR: #0000ff">&lt;</SPAN><SPAN 
style="COLOR: #800000">appSettings</SPAN><SPAN 
style="COLOR: #0000ff">&gt;</SPAN><SPAN style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/None.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">&lt;</SPAN><SPAN 
style="COLOR: #800000">add&nbsp;</SPAN><SPAN 
style="COLOR: #ff0000">key</SPAN><SPAN 
style="COLOR: #0000ff">="remotingFolder"</SPAN><SPAN 
style="COLOR: #ff0000">&nbsp;value</SPAN><SPAN 
style="COLOR: #0000ff">="/temp"</SPAN><SPAN 
style="COLOR: #0000ff">/&gt;</SPAN><SPAN style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/None.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">&lt;</SPAN><SPAN 
style="COLOR: #800000">add&nbsp;</SPAN><SPAN 
style="COLOR: #ff0000">key</SPAN><SPAN 
style="COLOR: #0000ff">="localFolder"</SPAN><SPAN 
style="COLOR: #ff0000">&nbsp;value</SPAN><SPAN 
style="COLOR: #0000ff">="c:\temp"</SPAN><SPAN 
style="COLOR: #0000ff">/&gt;</SPAN><SPAN style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/None.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">&lt;</SPAN><SPAN 
style="COLOR: #800000">add&nbsp;</SPAN><SPAN 
style="COLOR: #ff0000">key</SPAN><SPAN 
style="COLOR: #0000ff">="ftpServer"</SPAN><SPAN 
style="COLOR: #ff0000">&nbsp;value</SPAN><SPAN 
style="COLOR: #0000ff">="*"</SPAN><SPAN style="COLOR: #0000ff">/&gt;</SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/None.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">&lt;</SPAN><SPAN 
style="COLOR: #800000">add&nbsp;</SPAN><SPAN 
style="COLOR: #ff0000">key</SPAN><SPAN 
style="COLOR: #0000ff">="user"</SPAN><SPAN 
style="COLOR: #ff0000">&nbsp;value</SPAN><SPAN 
style="COLOR: #0000ff">="*"</SPAN><SPAN style="COLOR: #0000ff">/&gt;</SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/None.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">&lt;</SPAN><SPAN 
style="COLOR: #800000">add&nbsp;</SPAN><SPAN 
style="COLOR: #ff0000">key</SPAN><SPAN style="COLOR: #0000ff">="pwd"</SPAN><SPAN 
style="COLOR: #ff0000">&nbsp;value</SPAN><SPAN 
style="COLOR: #0000ff">="*"</SPAN><SPAN style="COLOR: #0000ff">/&gt;</SPAN><SPAN 
style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/None.gif" 
align=top>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN 
style="COLOR: #0000ff">&lt;</SPAN><SPAN 
style="COLOR: #800000">add&nbsp;</SPAN><SPAN 
style="COLOR: #ff0000">key</SPAN><SPAN 
style="COLOR: #0000ff">="port"</SPAN><SPAN 
style="COLOR: #ff0000">&nbsp;value</SPAN><SPAN 
style="COLOR: #0000ff">="21"</SPAN><SPAN 
style="COLOR: #0000ff">/&gt;</SPAN><SPAN style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/None.gif" 
align=top>&nbsp;&nbsp;</SPAN><SPAN style="COLOR: #0000ff">&lt;/</SPAN><SPAN 
style="COLOR: #800000">appSettings</SPAN><SPAN 
style="COLOR: #0000ff">&gt;</SPAN><SPAN style="COLOR: #000000"><BR><IMG alt="" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/None.gif" align=top></SPAN><SPAN 
style="COLOR: #0000ff">&lt;/</SPAN><SPAN 
style="COLOR: #800000">configuration</SPAN><SPAN 
style="COLOR: #0000ff">&gt;</SPAN></DIV><BR>
<P class=postfoot>posted on 2008-01-29 15:35 <A 
href="http://www.cnblogs.com/zsbfree/">周行天下</A> 阅读(577) <A 
href="http://www.cnblogs.com/zsbfree/archive/2008/01/29/1057643.html#Post">评论(7)</A> 
&nbsp;<A 
href="http://www.cnblogs.com/zsbfree/admin/EditPosts.aspx?postid=1057643">编辑</A> 
<A href="http://www.cnblogs.com/zsbfree/AddToFavorite.aspx?id=1057643">收藏</A> 
</P></DIV><IMG height=1 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/1057643.jpg" width=1> <!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
xmlns:dc="http://purl.org/dc/elements/1.1/"
xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
<rdf:Description
rdf:about="http://www.cnblogs.com/zsbfree/archive/2008/01/29/1057643.html"
dc:identifier="http://www.cnblogs.com/zsbfree/archive/2008/01/29/1057643.html"
dc:title="c#上传下载ftp(支持断点续传)"
trackback:ping="http://www.cnblogs.com/zsbfree/services/trackbacks/1057643.aspx" />
</rdf:RDF>
-->
<DIV id=AjaxHolder_UpdatePanel1><A name=pagedcomment></A><A name=评论>
<DIV id=comments>
<H3>评论</H3>
<H4><A title="permalink: re: c#上传下载ftp(支持断点续传)" 
href="http://www.cnblogs.com/zsbfree/archive/2008/01/29/1057643.html#1063384">#1楼</A>&nbsp;<A 
name=1063384></A>[<SPAN class=louzhu>楼主</SPAN>] <SPAN>2008-02-03 11:26 </SPAN><A 
id=AjaxHolder_Comments_CommentList_ctl00_NameLink 
href="http://www.cnblogs.com/zsbfree/" target=_blank>周行天下</A>&nbsp;<A 
class=sendMsg2This title=给此人发送站内短消息 
href="http://space.cnblogs.com/msg/send/å¨è¡å¤©ä¸">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</A> 
</H4>
<P>没有人捧场，自己定一个先 &nbsp;&nbsp;<A onclick='return SetReplyAuhor("周行天下")' 
href="http://www.cnblogs.com/zsbfree/archive/2008/01/29/1057643.html#post">回复</A>&nbsp;&nbsp;<A 
onclick="GetQuote(1063384);return false" 
href="http://www.cnblogs.com/zsbfree/archive/2008/01/29/1057643.html#post">引用</A>&nbsp;&nbsp;<A 
title=查看该作者发表过的评论 
href="http://www.cnblogs.com/CommentsByAuthor.aspx?author=%e5%91%a8%e8%a1%8c%e5%a4%a9%e4%b8%8b" 
target=_blank>查看</A>&nbsp;&nbsp;<A 
id=AjaxHolder_Comments_CommentList_ctl00_DeleteLink 
href="javascript:__doPostBack('AjaxHolder$Comments$CommentList$ctl00$DeleteLink','')"></A>&nbsp;&nbsp;<A 
id=AjaxHolder_Comments_CommentList_ctl00_EditLink></A> </P>
<H4><A title="permalink: re: c#上传下载ftp(支持断点续传)" 
href="http://www.cnblogs.com/zsbfree/archive/2008/01/29/1057643.html#1063911">#2楼</A>&nbsp;<A 
name=1063911></A> <SPAN>2008-02-03 22:06 </SPAN><A 
id=AjaxHolder_Comments_CommentList_ctl01_NameLink target=_blank>tomahawkfeng 
[未注册用户]</A> </H4>
<P>多谢，我参考一下。 &nbsp;&nbsp;<A onclick='return SetReplyAuhor("tomahawkfeng")' 
href="http://www.cnblogs.com/zsbfree/archive/2008/01/29/1057643.html#post">回复</A>&nbsp;&nbsp;<A 
onclick="GetQuote(1063911);return false" 
href="http://www.cnblogs.com/zsbfree/archive/2008/01/29/1057643.html#post">引用</A>&nbsp;&nbsp;<A 
id=AjaxHolder_Comments_CommentList_ctl01_DeleteLink 
href="javascript:__doPostBack('AjaxHolder$Comments$CommentList$ctl01$DeleteLink','')"></A>&nbsp;&nbsp;<A 
id=AjaxHolder_Comments_CommentList_ctl01_EditLink></A> </P>
<H4><A title="permalink: re: c#上传下载ftp(支持断点续传)" 
href="http://www.cnblogs.com/zsbfree/archive/2008/01/29/1057643.html#1071683">#3楼</A>&nbsp;<A 
name=1071683></A> <SPAN>2008-02-17 23:46 </SPAN><A 
id=AjaxHolder_Comments_CommentList_ctl02_NameLink 
href="http://www.cnblogs.com/xuyuan77/" target=_blank>路缘</A>&nbsp;<A 
class=sendMsg2This title=给此人发送站内短消息 
href="http://space.cnblogs.com/msg/send/è·¯ç¼">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</A> 
</H4>
<P>我给你捧一下 &nbsp;&nbsp;<A onclick='return SetReplyAuhor("路缘")' 
href="http://www.cnblogs.com/zsbfree/archive/2008/01/29/1057643.html#post">回复</A>&nbsp;&nbsp;<A 
onclick="GetQuote(1071683);return false" 
href="http://www.cnblogs.com/zsbfree/archive/2008/01/29/1057643.html#post">引用</A>&nbsp;&nbsp;<A 
title=查看该作者发表过的评论 
href="http://www.cnblogs.com/CommentsByAuthor.aspx?author=%e8%b7%af%e7%bc%98" 
target=_blank>查看</A>&nbsp;&nbsp;<A 
id=AjaxHolder_Comments_CommentList_ctl02_DeleteLink 
href="javascript:__doPostBack('AjaxHolder$Comments$CommentList$ctl02$DeleteLink','')"></A>&nbsp;&nbsp;<A 
id=AjaxHolder_Comments_CommentList_ctl02_EditLink></A> </P>
<H4><A title="permalink: re: c#上传下载ftp(支持断点续传)" 
href="http://www.cnblogs.com/zsbfree/archive/2008/01/29/1057643.html#1133084">#4楼</A>&nbsp;<A 
name=1133084></A> <SPAN>2008-04-01 16:08 </SPAN><A 
id=AjaxHolder_Comments_CommentList_ctl03_NameLink 
href="http://www.cnblogs.com/Impulse/" target=_blank>火龙</A>&nbsp;<A 
class=sendMsg2This title=给此人发送站内短消息 
href="http://space.cnblogs.com/msg/send/ç«é¾">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</A> 
</H4>
<P>收藏了 &nbsp;&nbsp;<A onclick='return SetReplyAuhor("火龙")' 
href="http://www.cnblogs.com/zsbfree/archive/2008/01/29/1057643.html#post">回复</A>&nbsp;&nbsp;<A 
onclick="GetQuote(1133084);return false" 
href="http://www.cnblogs.com/zsbfree/archive/2008/01/29/1057643.html#post">引用</A>&nbsp;&nbsp;<A 
title=查看该作者发表过的评论 
href="http://www.cnblogs.com/CommentsByAuthor.aspx?author=%e7%81%ab%e9%be%99" 
target=_blank>查看</A>&nbsp;&nbsp;<A 
id=AjaxHolder_Comments_CommentList_ctl03_DeleteLink 
href="javascript:__doPostBack('AjaxHolder$Comments$CommentList$ctl03$DeleteLink','')"></A>&nbsp;&nbsp;<A 
id=AjaxHolder_Comments_CommentList_ctl03_EditLink></A> </P>
<H4><A title="permalink: re: c#上传下载ftp(支持断点续传)" 
href="http://www.cnblogs.com/zsbfree/archive/2008/01/29/1057643.html#1133125">#5楼</A>&nbsp;<A 
name=1133125></A> <SPAN>2008-04-01 16:32 </SPAN><A 
id=AjaxHolder_Comments_CommentList_ctl04_NameLink 
href="http://www.cnblogs.com/Impulse/" target=_blank>火龙</A>&nbsp;<A 
class=sendMsg2This title=给此人发送站内短消息 
href="http://space.cnblogs.com/msg/send/ç«é¾">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</A> 
</H4>
<P>好像不能用，很多方法没有，是怎么回事呢 &nbsp;&nbsp;<A onclick='return SetReplyAuhor("火龙")' 
href="http://www.cnblogs.com/zsbfree/archive/2008/01/29/1057643.html#post">回复</A>&nbsp;&nbsp;<A 
onclick="GetQuote(1133125);return false" 
href="http://www.cnblogs.com/zsbfree/archive/2008/01/29/1057643.html#post">引用</A>&nbsp;&nbsp;<A 
title=查看该作者发表过的评论 
href="http://www.cnblogs.com/CommentsByAuthor.aspx?author=%e7%81%ab%e9%be%99" 
target=_blank>查看</A>&nbsp;&nbsp;<A 
id=AjaxHolder_Comments_CommentList_ctl04_DeleteLink 
href="javascript:__doPostBack('AjaxHolder$Comments$CommentList$ctl04$DeleteLink','')"></A>&nbsp;&nbsp;<A 
id=AjaxHolder_Comments_CommentList_ctl04_EditLink></A> </P>
<H4><A title="permalink: re: c#上传下载ftp(支持断点续传)" 
href="http://www.cnblogs.com/zsbfree/archive/2008/01/29/1057643.html#1133209">#6楼</A>&nbsp;<A 
name=1133209></A> <SPAN>2008-04-01 17:23 </SPAN><A 
id=AjaxHolder_Comments_CommentList_ctl05_NameLink 
href="http://www.cnblogs.com/Impulse/" target=_blank>火龙</A>&nbsp;<A 
class=sendMsg2This title=给此人发送站内短消息 
href="http://space.cnblogs.com/msg/send/ç«é¾">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</A> 
</H4>
<P>断点传输时，会产生一些垃圾文件，导致，再次下载时会提示找不到指定的资源，代码乱7八燥的，看我的头大了 &nbsp;&nbsp;<A 
onclick='return SetReplyAuhor("火龙")' 
href="http://www.cnblogs.com/zsbfree/archive/2008/01/29/1057643.html#post">回复</A>&nbsp;&nbsp;<A 
onclick="GetQuote(1133209);return false" 
href="http://www.cnblogs.com/zsbfree/archive/2008/01/29/1057643.html#post">引用</A>&nbsp;&nbsp;<A 
title=查看该作者发表过的评论 
href="http://www.cnblogs.com/CommentsByAuthor.aspx?author=%e7%81%ab%e9%be%99" 
target=_blank>查看</A>&nbsp;&nbsp;<A 
id=AjaxHolder_Comments_CommentList_ctl05_DeleteLink 
href="javascript:__doPostBack('AjaxHolder$Comments$CommentList$ctl05$DeleteLink','')"></A>&nbsp;&nbsp;<A 
id=AjaxHolder_Comments_CommentList_ctl05_EditLink></A> </P>
<H4><A title="permalink: re: c#上传下载ftp(支持断点续传)" 
href="http://www.cnblogs.com/zsbfree/archive/2008/01/29/1057643.html#1174068">#7楼</A>&nbsp;<A 
name=1174068></A><A name=Post></A> <SPAN>2008-04-28 10:10 </SPAN><A 
id=AjaxHolder_Comments_CommentList_ctl06_NameLink target=_blank>阿信(路过) 
[未注册用户]</A> </H4>
<P>大力支持一下楼主 &nbsp;&nbsp;<A onclick='return SetReplyAuhor("阿信(路过)")' 
href="http://www.cnblogs.com/zsbfree/archive/2008/01/29/1057643.html#post">回复</A>&nbsp;&nbsp;<A 
onclick="GetQuote(1174068);return false" 
href="http://www.cnblogs.com/zsbfree/archive/2008/01/29/1057643.html#post">引用</A>&nbsp;&nbsp;<A 
id=AjaxHolder_Comments_CommentList_ctl06_DeleteLink 
href="javascript:__doPostBack('AjaxHolder$Comments$CommentList$ctl06$DeleteLink','')"></A>&nbsp;&nbsp;<A 
id=AjaxHolder_Comments_CommentList_ctl06_EditLink></A> </P></DIV>
<STYLE>TD {
	FONT-SIZE: 12px
}
.commentTextBox {
	FONT-SIZE: 13px; FONT-FAMILY: Verdana
}
A.blue:visited {
	COLOR: blue
}
A.blue:active {
	COLOR: blue
}
A.blue:link {
	COLOR: blue
}
A.blue:hover {
	COLOR: blue
}
</STYLE>
<!--Beging Temp Save-->
<STYLE>.userData {
	BEHAVIOR: url(#default#userdata)
}
</STYLE>

<DIV class=userData id=CommentsPersistDiv></DIV>
<SCRIPT type=text/javascript>
function pageLoad()
{
    Sys.WebForms.PageRequestManager.getInstance().add_initializeRequest(handleInitializeRequest);
    //Sys.WebForms.PageRequestManager.getInstance().add_endRequest(handleEndRequest);
}

function handleInitializeRequest(sender, args)
{
    var prm = Sys.WebForms.PageRequestManager.getInstance();
    var eid = args.get_postBackElement().id;
    /*if (eid.indexOf("DeleteLink")>0) 
    {
       args.get_postBackElement().innerHTML = "<font color='red'>正在删除...</font>";         
    }    
    else */
    if (eid.indexOf("btnSubmit")>0) 
    {
       document.getElementById("AjaxHolder_PostComment_ltSubmitMsg").innerHTML="正在提交...";
       document.getElementById("AjaxHolder_PostComment_btnSubmit").disabled = true;       
    }   
    else if(eid.indexOf("refreshList")>0)
    {
        document.getElementById("AjaxHolder_PostComment_refreshList").innerHTML="<font color='red'>正在刷新...</font>";
    }
   
}	

function TempSave(ElementID)
{
	try
	{
	CommentsPersistDiv.setAttribute("CommentContent",document.getElementById(ElementID).value);
	CommentsPersistDiv.save("CommentXMLStore");
	}
	catch(ex)
	{
	}
	
}
function Restore(ElementID)
{
	CommentsPersistDiv.load("CommentXMLStore");
	document.getElementById(ElementID).value=CommentsPersistDiv.getAttribute("CommentContent");
}	
			
			
</SCRIPT>
<!--Ene TempSave-->
<DIV id=divRefreshComments 
style="FONT-SIZE: 12px; MARGIN-BOTTOM: 5px; MARGIN-RIGHT: 10px; TEXT-ALIGN: right"><A 
href="http://space.cnblogs.com/">社区</A>&nbsp;&nbsp;<A 
href="http://news.cnblogs.com/">新闻</A>&nbsp;&nbsp;<A 
href="http://www.cnblogs.com/RequireRegister.aspx">新用户注册</A>&nbsp;&nbsp;<A 
id=AjaxHolder_PostComment_refreshList 
href="javascript:__doPostBack('AjaxHolder$PostComment$refreshList','')">刷新评论列表</A>&nbsp;&nbsp;</DIV>
<DIV class=commentform><SPAN id=AjaxHolder_PostComment_ltSubmitMsg 
style="COLOR: red"></SPAN><BR><A name=Feedback></A>
<TABLE cellSpacing=1 cellPadding=1 border=0>
  <TBODY>
  <TR>
    <TD width=75></TD>
    <TD></TD>
    <TD></TD></TR>
  <TR>
    <TD width=55>标题</TD>
    <TD><INPUT class=commenttb id=AjaxHolder_PostComment_tbTitle 
      value="re: c#上传下载ftp(支持断点续传)" name=AjaxHolder$PostComment$tbTitle></TD>
    <TD><SPAN id=AjaxHolder_PostComment_RequiredFieldValidator1 
      style="VISIBILITY: hidden; COLOR: red">请输入标题</SPAN></TD></TR>
  <TR>
    <TD>姓名</TD>
    <TD><INPUT class=commenttb id=AjaxHolder_PostComment_tbName 
      name=AjaxHolder$PostComment$tbName></TD>
    <TD><SPAN id=AjaxHolder_PostComment_RequiredFieldValidator2 
      style="VISIBILITY: hidden; COLOR: red">请输入你的姓名</SPAN></TD></TR>
  <TR>
    <TD>主页</TD>
    <TD><INPUT class=commenttb id=AjaxHolder_PostComment_tbUrl 
      name=AjaxHolder$PostComment$tbUrl></TD>
    <TD><FONT face=宋体></FONT></TD></TR>
  <TR id=AjaxHolder_PostComment_trEmail>
    <TD>Email</TD>
    <TD><INPUT class=commenttb id=AjaxHolder_PostComment_tbEmail 
      name=AjaxHolder$PostComment$tbEmail>(只有博主才能看到)<SPAN 
      id=AjaxHolder_PostComment_revContactMail 
      style="VISIBILITY: hidden; COLOR: red">邮件地址无效</SPAN></TD>
    <TD></TD></TR>
  <TR>
    <TD align=left colSpan=3>
      <TABLE class=CommentForm id=AjaxHolder_PostComment_tbCaptchaImage 
      cellSpacing=0 cellPadding=0 border=0>
        <TBODY>
        <TR>
          <TD colSpan=3><SPAN 
            id=AjaxHolder_PostComment_Requiredfieldvalidator4 
            style="DISPLAY: none; COLOR: red">请输入验证码</SPAN> <SPAN 
            id=AjaxHolder_PostComment_lblImage 
            style="FONT-WEIGHT: bold; COLOR: red"></SPAN></TD></TR>
        <TR>
          <TD width=78>验证码</TD>
          <TD><INPUT id=AjaxHolder_PostComment_CodeNumberTextBox 
            name=AjaxHolder$PostComment$CodeNumberTextBox>*&nbsp;&nbsp;<IMG 
            src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/JpegImage.jpg"><A 
            id=AjaxHolder_PostComment_lkbChangeCode 
            href="javascript:__doPostBack('AjaxHolder$PostComment$lkbChangeCode','')">看不清,换一张</A> 
            [<A href="http://www.cnblogs.com/login.aspx">登录</A>][<A 
            href="http://www.cnblogs.com/RequireRegister.aspx">注册</A>]</TD>
          <TD align=left></TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD colSpan=3>内容(请不要发表任何与政治相关的内容) <SPAN 
      id=AjaxHolder_PostComment_RequiredFieldValidator3 
      style="VISIBILITY: hidden; COLOR: red">请输入评论内容</SPAN><BR><TEXTAREA class=commentTextBox id=AjaxHolder_PostComment_tbComment onkeydown="ctlent(event,'AjaxHolder_PostComment_tbComment')" name=AjaxHolder$PostComment$tbComment></TEXTAREA></TD></TR>
  <TR>
    <TD colSpan=3><SPAN id=AjaxHolder_PostComment_Message 
      style="COLOR: red"></SPAN></TD>
  <TR>
    <TD colSpan=3><INPUT id=AjaxHolder_PostComment_chkRemember tabIndex=-1 
      type=checkbox CHECKED name=AjaxHolder$PostComment$chkRemember><LABEL 
      for=AjaxHolder_PostComment_chkRemember>Remember Me?</LABEL></TD></TR>
  <TR>
    <TD height=23><INPUT class=commentButton id=AjaxHolder_PostComment_btnSubmit onclick="TempSave('AjaxHolder_PostComment_tbComment');WebForm_DoPostBackWithOptions(new WebForm_PostBackOptions(&quot;AjaxHolder$PostComment$btnSubmit&quot;, &quot;&quot;, true, &quot;&quot;, &quot;&quot;, false, false))" type=submit value=提交 name=AjaxHolder$PostComment$btnSubmit> 
    </TD>
    <TD colSpan=2 height=23>&nbsp; <A id=AjaxHolder_PostComment_lnkLogin 
      href="http://www.cnblogs.com/login.aspx?ReturnURL=http://www.cnblogs.com/zsbfree/archive/2008/01/29/1057643.html&amp;SourceURL=/zsbfree/archive/2008/01/29/1057643.html">登录</A>&nbsp;&nbsp;<A 
      id=AjaxHolder_PostComment_linkLoginComment 
      onclick="if(document.getElementById('AjaxHolder_PostComment_tbComment').value != '') return confirm('未提交的评论内容将会丢失, 你真的要进入高级评论吗?');" 
      href="http://www.cnblogs.com/zsbfree/archive/2008/01/29/1057643.html?login=1#Post">使用高级评论</A>&nbsp;&nbsp;<A 
      href="http://www.cnblogs.com/RequireRegister.aspx">新用户注册</A>&nbsp;&nbsp;<A 
      href="http://www.cnblogs.com/zsbfree/archive/2008/01/29/1057643.html#Top">返回页首</A>&nbsp;&nbsp;<A 
      id=AjaxHolder_PostComment_lbRestore 
      onclick="Restore('AjaxHolder_PostComment_tbComment'); return false;" 
      href="http://www.cnblogs.com/zsbfree/archive/2008/01/29/1057643.html#Post">恢复上次提交</A>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    </TD></TR>
  <TR>
    <TD colSpan=3><LABEL class=CtrlEnter>[使用Ctrl+Enter键可以直接提交]</LABEL></TD></TR>
  <TR>
    <TD colSpan=3>该文被作者在 2008-01-30 11:01 编辑过</TD></TR>
  <TR>
    <TD colSpan=3 height=3>&nbsp;</TD></TR>
  <TR>
    <TD colSpan=3></TD></TR>
  <TR>
    <TD colSpan=3 height=10></TD></TR>
  <TR>
    <TD colSpan=3>
      <DIV class=itnews>最新IT新闻:<BR>· <A href="http://news.cnblogs.com/n/41383/" 
      target=_blank>中文维基百科可以访问啦</A><BR>· <A 
      href="http://news.cnblogs.com/n/41382/" 
      target=_blank>个人在博客发布奥运侵权信息应迅速删除</A><BR>· <A 
      href="http://news.cnblogs.com/n/41381/" target=_blank>Firefox 3.1 Alpha发布 
      改进标签和智能地址栏</A><BR>· <A href="http://news.cnblogs.com/n/41379/" 
      target=_blank>IBM推出代码分析工具 减少开发者错误</A><BR>· <A 
      href="http://news.cnblogs.com/n/41378/" 
      target=_blank>我国部分城市明日将现日全食(时间表)</A><BR></DIV>
      <DIV class=cnblogs_link style="MARGIN-TOP: 5px"><A 
      href="http://news.cnblogs.com/">博客园新闻频道</A>&nbsp;&nbsp;<A 
      href="http://www.cnblogs.com/">博客园首页</A>&nbsp;&nbsp;<A 
      href="http://space.cnblogs.com/">社区</A> </DIV></TD></TR>
  <TR>
    <TD colSpan=3 height=5>&nbsp;</TD></TR>
  <TR>
    <TD colSpan=3>
      <SCRIPT type=text/javascript><!--
google_ad_client = "pub-4210569241504288";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
google_ad_type = "text";
google_ad_channel ="";
google_color_link = "6699CC";
//--></SCRIPT>

      <SCRIPT src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/show_ads.js" 
      type=text/javascript>
</SCRIPT>
      <BR><BR></TD></TR>
  <TR>
    <TD colSpan=3></TD></TR></TBODY></TABLE></DIV>
<DIV id=AjaxHolder_PostComment_ValidationSummary1 
style="DISPLAY: none; COLOR: red"></DIV></DIV>
<SCRIPT language=javascript>

function GetQuote(id)
{
    //www.cnblogs.com.ICommentService.GetCommentText(id,SetQuote);
    BlogServer.WebService.AjaxWS.GetComment(id,SetQuote);
}

 function SetQuote(result)
{
    document.getElementById('AjaxHolder_PostComment_tbComment').value+= ("--引用--------------------------------------------------\n"+result+"\n--------------------------------------------------------\n");
    document.getElementById('AjaxHolder_PostComment_tbComment').focus(); 
}

function Favorite(entryID,title,url,element)
{
    document.getElementById(element.id).innerHTML = "<span style='color:red'>正在收藏...</span>";
    BlogServer.WebService.AjaxWS.AddToFavorites(entryID,title,url,OnFavoriteSuccess);
    document.getElementById(element.id).removeAttribute("href");
    document.getElementById(element.id).removeAttribute("onclick");
}

function OnFavoriteSuccess(result)
{
    if(result == "请先登录")
    {
        window.location.href = "../../../../../login.aspx?ReturnUrl=" + window.location.href;
    }
    else
    {
        var returnstr = result.split(",");
        var id = "lnkFavorite"+returnstr[0];
        document.getElementById(id).innerHTML = "<span style='color:red'>" + returnstr[1] + "</span>";
    }
}

function DelComment(id,element)
{
    if(confirm("确认要删除该评论吗?"))
    {
        document.getElementById(element.id).innerHTML = "<span style='color:red'>正在删除...</span>";
        BlogServer.WebService.AjaxWS.DelComment(id,del_comment_callback);
    }
    return false;
}

function del_comment_callback(response)
{
    __doPostBack('AjaxHolder$PostComment$refreshList','');
}
</SCRIPT>
</DIV>
<DIV id=rightmenu>
<H3>导航</H3>
<UL>
  <LI><A id=MyLinks1_HomeLink href="http://www.cnblogs.com/">博客园</A> </LI>
  <LI><A id=MyLinks1_MyHomeLink href="http://www.cnblogs.com/zsbfree/">首页</A> 
  </LI>
  <LI><A id=MyLinks1_NewPostLink 
  href="http://www.cnblogs.com/zsbfree/admin/EditPosts.aspx?opt=1">新随笔</A> </LI>
  <LI><A id=MyLinks1_ContactLink accessKey=9 
  href="http://www.cnblogs.com/zsbfree/contact.aspx?id=1">联系</A> </LI>
  <LI><A id=MyLinks1_Syndication 
  href="http://www.cnblogs.com/zsbfree/rss">订阅</A><A id=MyLinks1_XMLLink 
  href="http://www.cnblogs.com/zsbfree/rss"><IMG 
  style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
  alt=订阅 src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/xml.gif"></A> </LI>
  <LI><A id=MyLinks1_Admin 
  href="http://www.cnblogs.com/zsbfree/admin/EditPosts.aspx">管理</A> </LI></UL>
<H3>统计</H3>
<UL>
  <LI>随笔 - 5 </LI>
  <LI>文章 - 0 </LI>
  <LI>评论 - 12 </LI>
  <LI>引用 - 0 </LI></UL>
<DIV class=catListInteraction>
<H3 class=catListTitle>与我联系</H3>
<UL>
  <LI><A class=sendMsg id=SingleColumn1_ctl00_lnkSendMsg 
  href="http://space.cnblogs.com/msg/send/å¨è¡å¤©ä¸">发短消息</A> </LI></UL></DIV>
<H3>常用链接</H3>
<UL>
  <LI><A id=SingleColumn1_ctl01_rptMainLinks_ctl00_lnkLinkItem 
  href="http://www.cnblogs.com/zsbfree/MyPosts.html">我的随笔</A> </LI>
  <LI><A id=SingleColumn1_ctl01_rptMainLinks_ctl01_lnkLinkItem 
  href="http://space.cnblogs.com/zsbfree">我的空间</A> </LI>
  <LI><A id=SingleColumn1_ctl01_rptMainLinks_ctl02_lnkLinkItem 
  href="http://space.cnblogs.com/msg/recent">我的短信</A> </LI>
  <LI><A id=SingleColumn1_ctl01_rptMainLinks_ctl03_lnkLinkItem 
  href="http://www.cnblogs.com/zsbfree/MyComments.html">我的评论</A> </LI>
  <LI><A id=itemListLink 
  onclick="this.blur();WarpClass('itemListLink', 'itemListLin_con');return false;" 
  href="http://www.cnblogs.com/zsbfree/archive/2008/01/29/1057643.html#">更多链接</A> 
  </LI></UL>
<DIV id=itemListLin_con style="DISPLAY: none">
<UL>
  <LI><A id=SingleColumn1_ctl01_repeaterLinks_ctl01_lnkLinkItem title=我发表过评论的随笔 
  href="http://www.cnblogs.com/zsbfree/OtherPosts.html">我的参与</A> </LI>
  <LI><A id=SingleColumn1_ctl01_repeaterLinks_ctl02_lnkLinkItem 
  href="http://www.cnblogs.com/zsbfree/MyNews.html">我的新闻</A> </LI>
  <LI><A id=SingleColumn1_ctl01_repeaterLinks_ctl03_lnkLinkItem 
  href="http://www.cnblogs.com/zsbfree/RecentComments.html">最新评论</A> </LI>
  <LI><A id=SingleColumn1_ctl01_repeaterLinks_ctl04_lnkLinkItem 
  href="http://www.cnblogs.com/zsbfree/tag/">我的标签</A> </LI></UL></DIV>
<H3>留言簿<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px">(1)</SPAN></H3>
<UL>
  <LI><A id=SingleColumn1_ctl02_lnkMessages 
  href="http://www.cnblogs.com/zsbfree/Contact.aspx?id=1">给我留言</A> <!--<li><a id="SingleColumn1_ctl02_lnkPublicMsgView" href="http://www.cnblogs.com/zsbfree/default.aspx?opt=msg">查看公开留言</a></li>--></LI>
  <LI><A id=SingleColumn1_ctl02_lnkPrivateMsgView 
  href="http://www.cnblogs.com/zsbfree/admin/MyMessages.aspx">查看留言</A> 
</LI></UL></ASP:PANEL>
<H3>随笔档案</H3>
<UL>
  <LI><A id=SingleColumn1_Categories_CatList_ctl00_LinkList_ctl01_Link 
  href="http://www.cnblogs.com/zsbfree/archive/2008/01.html">2008年1月 (1)</A> 
  </LI>
  <LI><A id=SingleColumn1_Categories_CatList_ctl00_LinkList_ctl02_Link 
  href="http://www.cnblogs.com/zsbfree/archive/2007/11.html">2007年11月 (1)</A> 
  </LI>
  <LI><A id=SingleColumn1_Categories_CatList_ctl00_LinkList_ctl03_Link 
  href="http://www.cnblogs.com/zsbfree/archive/2007/08.html">2007年8月 (1)</A> 
  </LI>
  <LI><A id=SingleColumn1_Categories_CatList_ctl00_LinkList_ctl04_Link 
  href="http://www.cnblogs.com/zsbfree/archive/2007/06.html">2007年6月 (2)</A> 
  </LI></UL>
<SCRIPT language=JavaScript>
function SearchGoogle(key,evt,site)
		{
			if(evt.keyCode==13 || evt.keyCode==0 || evt.type =='click')
			{
				key.focus();
				var keystr = encodeURIComponent(key.value);
				url = "http://www.google.com/search?q=";
				url = url+keystr;
				url += "&ie=UTF-8&oe=GB2312&hl=zh-CN&domains="+site+"&sitesearch="+site;
				window.location=url;
				return false;
			}
		}
</SCRIPT>

<H3>搜索</H3>
<UL>
  <LI></LI>
  <LI><INPUT id=q 
  onkeydown="return SearchGoogle(document.getElementById('q'),event,'http://www.cnblogs.com/zsbfree/')" 
  style="WIDTH: 130px" name=q>&nbsp;<INPUT onclick="SearchGoogle(document.getElementById('q'),event,'http://www.cnblogs.com/zsbfree/')" type=button value=搜索 name=sa> 
  </LI></UL>
<H3>最新评论 <A id=SingleColumn1__172901f_RSSHyperlink1 
href="http://www.cnblogs.com/zsbfree/CommentsRSS.aspx"><IMG 
style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/xml.gif"></A></H3>
<DIV class=RecentComment id=RecentComments></DIV>
<H3>阅读排行榜</H3>
<DIV class=RecentComment id=TopViewPosts>
<UL style="WORD-BREAK: break-all">
  <LI><A id=SingleColumn1__1020f50_TopList_ctl01_Hyperlink1 
  href="http://www.cnblogs.com/zsbfree/archive/2008/01/29/1057643.html">1.&nbsp;c#上传下载ftp(支持断点续传)(577)</A> 
  </LI>
  <LI><A id=SingleColumn1__1020f50_TopList_ctl02_Hyperlink1 
  href="http://www.cnblogs.com/zsbfree/archive/2007/08/03/841802.html">2.&nbsp;合并多个声音文件(285)</A> 
  </LI>
  <LI><A id=SingleColumn1__1020f50_TopList_ctl03_Hyperlink1 
  href="http://www.cnblogs.com/zsbfree/archive/2007/06/07/774846.html">3.&nbsp;茫然的心情(92)</A> 
  </LI>
  <LI><A id=SingleColumn1__1020f50_TopList_ctl04_Hyperlink1 
  href="http://www.cnblogs.com/zsbfree/archive/2007/11/13/958114.html">4.&nbsp;JavaScript 
  Web页面内容导出到Word、Excel (转载)(65)</A> </LI>
  <LI><A id=SingleColumn1__1020f50_TopList_ctl05_Hyperlink1 
  href="http://www.cnblogs.com/zsbfree/archive/2007/06/25/794458.html">5.&nbsp;龙舟记(29)</A> 
  </LI></UL></DIV>
<H3>评论排行榜</H3>
<DIV class=RecentComment id=TopCommentsPosts>
<UL style="WORD-BREAK: break-all">
  <LI><A id=SingleColumn1__aaa650_TopList_ctl01_Hyperlink1 
  href="http://www.cnblogs.com/zsbfree/archive/2008/01/29/1057643.html">1.&nbsp;c#上传下载ftp(支持断点续传)(7)</A> 
  </LI>
  <LI><A id=SingleColumn1__aaa650_TopList_ctl02_Hyperlink1 
  href="http://www.cnblogs.com/zsbfree/archive/2007/06/07/774846.html">2.&nbsp;茫然的心情(4)</A> 
  </LI>
  <LI><A id=SingleColumn1__aaa650_TopList_ctl03_Hyperlink1 
  href="http://www.cnblogs.com/zsbfree/archive/2007/08/03/841802.html">3.&nbsp;合并多个声音文件(1)</A> 
  </LI>
  <LI><A id=SingleColumn1__aaa650_TopList_ctl04_Hyperlink1 
  href="http://www.cnblogs.com/zsbfree/archive/2007/11/13/958114.html">4.&nbsp;JavaScript 
  Web页面内容导出到Word、Excel (转载)(0)</A> </LI>
  <LI><A id=SingleColumn1__aaa650_TopList_ctl05_Hyperlink1 
  href="http://www.cnblogs.com/zsbfree/archive/2007/06/25/794458.html">5.&nbsp;龙舟记(0)</A> 
  </LI></UL></DIV></DIV>
<P id=footer>Powered by: <BR><A id=Footer1_Hyperlink3 
style="FONT-SIZE: 12px; FONT-FAMILY: Verdana" href="http://www.cnblogs.com/" 
name=Hyperlink1>博客园</A> <BR>Copyright © 周行天下 </P>
<SCRIPT type=text/javascript>
//<![CDATA[
var Page_ValidationSummaries =  new Array(document.getElementById("AjaxHolder_PostComment_ValidationSummary1"));
var Page_Validators =  new Array(document.getElementById("AjaxHolder_PostComment_RequiredFieldValidator1"), document.getElementById("AjaxHolder_PostComment_RequiredFieldValidator2"), document.getElementById("AjaxHolder_PostComment_revContactMail"), document.getElementById("AjaxHolder_PostComment_Requiredfieldvalidator4"), document.getElementById("AjaxHolder_PostComment_RequiredFieldValidator3"));
//]]>
</SCRIPT>

<SCRIPT type=text/javascript>
//<![CDATA[
var AjaxHolder_PostComment_RequiredFieldValidator1 = document.all ? document.all["AjaxHolder_PostComment_RequiredFieldValidator1"] : document.getElementById("AjaxHolder_PostComment_RequiredFieldValidator1");
AjaxHolder_PostComment_RequiredFieldValidator1.controltovalidate = "AjaxHolder_PostComment_tbTitle";
AjaxHolder_PostComment_RequiredFieldValidator1.errormessage = "请输入标题";
AjaxHolder_PostComment_RequiredFieldValidator1.evaluationfunction = "RequiredFieldValidatorEvaluateIsValid";
AjaxHolder_PostComment_RequiredFieldValidator1.initialvalue = "";
var AjaxHolder_PostComment_RequiredFieldValidator2 = document.all ? document.all["AjaxHolder_PostComment_RequiredFieldValidator2"] : document.getElementById("AjaxHolder_PostComment_RequiredFieldValidator2");
AjaxHolder_PostComment_RequiredFieldValidator2.controltovalidate = "AjaxHolder_PostComment_tbName";
AjaxHolder_PostComment_RequiredFieldValidator2.errormessage = "请输入你的姓名";
AjaxHolder_PostComment_RequiredFieldValidator2.evaluationfunction = "RequiredFieldValidatorEvaluateIsValid";
AjaxHolder_PostComment_RequiredFieldValidator2.initialvalue = "";
var AjaxHolder_PostComment_revContactMail = document.all ? document.all["AjaxHolder_PostComment_revContactMail"] : document.getElementById("AjaxHolder_PostComment_revContactMail");
AjaxHolder_PostComment_revContactMail.controltovalidate = "AjaxHolder_PostComment_tbEmail";
AjaxHolder_PostComment_revContactMail.errormessage = "邮件地址无效";
AjaxHolder_PostComment_revContactMail.evaluationfunction = "RegularExpressionValidatorEvaluateIsValid";
AjaxHolder_PostComment_revContactMail.validationexpression = "^([0-9a-zA-Z+-._]([+-._\\w]*[0-9a-zA-Z+-._])*@([0-9a-zA-Z][-\\w]*\\.)+[a-zA-Z]{2,9})$";
var AjaxHolder_PostComment_Requiredfieldvalidator4 = document.all ? document.all["AjaxHolder_PostComment_Requiredfieldvalidator4"] : document.getElementById("AjaxHolder_PostComment_Requiredfieldvalidator4");
AjaxHolder_PostComment_Requiredfieldvalidator4.controltovalidate = "AjaxHolder_PostComment_CodeNumberTextBox";
AjaxHolder_PostComment_Requiredfieldvalidator4.errormessage = "请输入验证码";
AjaxHolder_PostComment_Requiredfieldvalidator4.display = "Dynamic";
AjaxHolder_PostComment_Requiredfieldvalidator4.evaluationfunction = "RequiredFieldValidatorEvaluateIsValid";
AjaxHolder_PostComment_Requiredfieldvalidator4.initialvalue = "";
var AjaxHolder_PostComment_RequiredFieldValidator3 = document.all ? document.all["AjaxHolder_PostComment_RequiredFieldValidator3"] : document.getElementById("AjaxHolder_PostComment_RequiredFieldValidator3");
AjaxHolder_PostComment_RequiredFieldValidator3.controltovalidate = "AjaxHolder_PostComment_tbComment";
AjaxHolder_PostComment_RequiredFieldValidator3.errormessage = "请输入评论内容";
AjaxHolder_PostComment_RequiredFieldValidator3.evaluationfunction = "RequiredFieldValidatorEvaluateIsValid";
AjaxHolder_PostComment_RequiredFieldValidator3.initialvalue = "";
var AjaxHolder_PostComment_ValidationSummary1 = document.all ? document.all["AjaxHolder_PostComment_ValidationSummary1"] : document.getElementById("AjaxHolder_PostComment_ValidationSummary1");
AjaxHolder_PostComment_ValidationSummary1.showmessagebox = "True";
AjaxHolder_PostComment_ValidationSummary1.showsummary = "False";
//]]>
</SCRIPT>

<SCRIPT type=text/javascript>
<!--
var Page_ValidationActive = false;
if (typeof(ValidatorOnLoad) == "function") {
    ValidatorOnLoad();
}

function ValidatorOnSubmit() {
    if (Page_ValidationActive) {
        return ValidatorCommonOnSubmit();
    }
    else {
        return true;
    }
}
// -->
</SCRIPT>

<SCRIPT type=text/javascript>
//<![CDATA[

document.getElementById('AjaxHolder_PostComment_ValidationSummary1').dispose = function() {
    Array.remove(Page_ValidationSummaries, document.getElementById('AjaxHolder_PostComment_ValidationSummary1'));
}
Sys.Application.initialize();

document.getElementById('AjaxHolder_PostComment_RequiredFieldValidator1').dispose = function() {
    Array.remove(Page_Validators, document.getElementById('AjaxHolder_PostComment_RequiredFieldValidator1'));
}

document.getElementById('AjaxHolder_PostComment_RequiredFieldValidator2').dispose = function() {
    Array.remove(Page_Validators, document.getElementById('AjaxHolder_PostComment_RequiredFieldValidator2'));
}

document.getElementById('AjaxHolder_PostComment_revContactMail').dispose = function() {
    Array.remove(Page_Validators, document.getElementById('AjaxHolder_PostComment_revContactMail'));
}

document.getElementById('AjaxHolder_PostComment_Requiredfieldvalidator4').dispose = function() {
    Array.remove(Page_Validators, document.getElementById('AjaxHolder_PostComment_Requiredfieldvalidator4'));
}

document.getElementById('AjaxHolder_PostComment_RequiredFieldValidator3').dispose = function() {
    Array.remove(Page_Validators, document.getElementById('AjaxHolder_PostComment_RequiredFieldValidator3'));
}
//]]>
</SCRIPT>
</FORM>
<SCRIPT src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/ShowHidden.js" 
type=text/javascript></SCRIPT>
<SPAN style="DISPLAY: none">
<SCRIPT language=javascript 
src="c#上传下载ftp(支持断点续传) - zsbfree - 博客园.files/click.htm"></SCRIPT>
</SPAN></BODY></HTML>
