<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3c.org/TR/1999/REC-html401-19991224/loose.dtd">
<!-- saved from url=(0060)http://www.daniweb.com/techtalkforums/printthread.php?t=6708 -->
<HTML lang=en dir=ltr><HEAD><TITLE>DaniWeb IT Community - visual c++ strange compile error...</TITLE>
<META http-equiv=Content-Type content="text/html; charset=UTF-8">
<META content="MSHTML 6.00.2800.1491" name=GENERATOR>
<STYLE type=text/css>TD {
	FONT: 10pt verdana, geneva, lucida, 'lucida grande', arial, helvetica, sans-serif
}
P {
	FONT: 10pt verdana, geneva, lucida, 'lucida grande', arial, helvetica, sans-serif
}
LI {
	FONT: 10pt verdana, geneva, lucida, 'lucida grande', arial, helvetica, sans-serif
}
DIV {
	FONT: 10pt verdana, geneva, lucida, 'lucida grande', arial, helvetica, sans-serif
}
.smallfont {
	FONT-SIZE: 11px
}
.tborder {
	BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid
}
.thead {
	BACKGROUND-COLOR: #eeeeee
}
.page {
	COLOR: #000000; BACKGROUND-COLOR: #ffffff
}
</STYLE>
</HEAD>
<BODY class=page>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR vAlign=bottom>
    <TD><A href="http://www.daniweb.com/techtalkforums/"><IMG 
      alt="DaniWeb IT Community" 
      src="DaniWeb IT Community - visual c++ strange compile error__.files/logo.gif" 
      border=0></A></TD>
    <TD align=right>
      <DIV class=smallfont></DIV></TD></TR></TBODY></TABLE><BR>
<DIV><A accessKey=1 
href="http://www.daniweb.com/techtalkforums/index.php"><STRONG>DaniWeb IT 
Community</STRONG></A> (<SPAN 
class=smallfont><EM>http://www.daniweb.com/techtalkforums/index.php</EM></SPAN>) 
</DIV>
<DIV>- &nbsp; <A 
href="http://www.daniweb.com/techtalkforums/forum8.html"><STRONG>C and 
C++</STRONG></A> (<SPAN 
class=smallfont><EM>http://www.daniweb.com/techtalkforums/forumdisplay.php?f=8</EM></SPAN>) 
</DIV>
<DIV>- &nbsp; - &nbsp; <A accessKey=3 
href="http://www.daniweb.com/techtalkforums/thread6708.html"><STRONG>visual c++ 
strange compile error...</STRONG></A> (<SPAN 
class=smallfont><EM>http://www.daniweb.com/techtalkforums/showthread.php?t=6708</EM></SPAN>) 
</DIV><BR>
<TABLE class=tborder cellSpacing=1 cellPadding=6 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=page>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR vAlign=bottom>
          <TD style="FONT-SIZE: 14pt">alex130</TD>
          <TD class=smallfont align=right>Jun 7th 2004 02:19 
      AM</TD></TR></TBODY></TABLE>
      <HR>

      <DIV><STRONG>visual c++ strange compile error...</STRONG><BR>&nbsp;</DIV>
      <DIV>I'm trying to compile the following program (file named 
      test.cpp):<BR><BR>#include "stdafx.h"<BR><BR>int main(int argc, char* 
      argv[]){<BR>INPUT *buffer = new INPUT[1]; //allocate a 
      buffer<BR>buffer-&gt;type = INPUT_MOUSE;<BR>buffer-&gt;mi.dx = 
      100;<BR>buffer-&gt;mi.dy = 100;<BR>buffer-&gt;mi.mouseData = 
      XBUTTON1;<BR>buffer-&gt;mi.dwFlags = 
      MOUSEEVENTF_LEFTDOWN;<BR>buffer-&gt;mi.time = 
      0;<BR>buffer-&gt;mi.dwExtraInfo = 
      0;<BR>SendInput(1,buffer,sizeof(INPUT));<BR>delete (buffer); //clean up 
      our messes.<BR>}<BR><BR>when "stdafx.h" is:<BR><BR>#pragma 
      once<BR><BR>#define WIN32_LEAN_AND_MEAN // Exclude rarely-used stuff from 
      Windows headers<BR>#include &lt;stdio.h&gt;<BR>#include 
      &lt;stdlib.h&gt;<BR>#include &lt;time.h&gt;<BR>#include 
      &lt;conio.h&gt;<BR>#include &lt;string.h&gt; <BR>#include 
      &lt;windows.h&gt;<BR><BR>Then I get the following 
      errors:<BR><BR>e:\test\src\test.cpp(4) : error C2065: 'INPUT' : undeclared 
      identifier<BR>e:\test\src\test.cpp(4) : error C2065: 'buffer' : undeclared 
      identifier<BR>e:\test\src\test.cpp(4) : error C2061: syntax error : 
      identifier 'INPUT'<BR>e:\test\src\test.cpp(5) : error C2227: left of 
      '-&gt;type' must point to class/struct/union type is 
      ''unknown-type''<BR>e:\test\src\test.cpp(5) : error C2065: 'INPUT_MOUSE' : 
      undeclared identifier<BR>e:\test\src\test.cpp(5) : error C3861: 'buffer': 
      identifier not found, even with argument-dependent 
      lookup<BR>e:\test\src\test.cpp(6) : error C2227: left of '-&gt;mi' must 
      point to class/struct/union type is 
      ''unknown-type''<BR>e:\test\src\test.cpp(6) : error C2228: left of '.dx' 
      must have class/struct/union type<BR>e:\test\src\test.cpp(6) : error 
      C3861: 'buffer': identifier not found, even with argument-dependent 
      lookup<BR>e:\test\src\test.cpp(7) : error C2227: left of '-&gt;mi' must 
      point to class/struct/union type is 
      ''unknown-type''<BR>e:\test\src\test.cpp(7) : error C2228: left of '.dy' 
      must have class/struct/union type<BR>e:\test\src\test.cpp(7) : error 
      C3861: 'buffer': identifier not found, even with argument-dependent 
      lookup<BR>e:\test\src\test.cpp(8) : error C2227: left of '-&gt;mi' must 
      point to class/struct/union type is 
      ''unknown-type''<BR>e:\test\src\test.cpp(8) : error C2228: left of 
      '.mouseData' must have class/struct/union type<BR>e:\test\src\test.cpp(8) 
      : error C2065: 'XBUTTON1' : undeclared 
      identifier<BR>e:\test\src\test.cpp(8) : error C3861: 'buffer': identifier 
      not found, even with argument-dependent lookup<BR>e:\test\src\test.cpp(9) 
      : error C2227: left of '-&gt;mi' must point to class/struct/union type is 
      ''unknown-type''<BR>e:\test\src\test.cpp(9) : error C2228: left of 
      '.dwFlags' must have class/struct/union type<BR>e:\test\src\test.cpp(9) : 
      error C3861: 'buffer': identifier not found, even with argument-dependent 
      lookup<BR>e:\test\src\test.cpp(10) : error C2227: left of '-&gt;mi' must 
      point to class/struct/union type is 
      ''unknown-type''<BR>e:\test\src\test.cpp(10) : error C2228: left of 
      '.time' must have class/struct/union type<BR>e:\test\src\test.cpp(10) : 
      error C3861: 'buffer': identifier not found, even with argument-dependent 
      lookup<BR>e:\test\src\test.cpp(11) : error C2227: left of '-&gt;mi' must 
      point to class/struct/union type is 
      ''unknown-type''<BR>e:\test\src\test.cpp(11) : error C2228: left of 
      '.dwExtraInfo' must have class/struct/union 
      type<BR>e:\test\src\test.cpp(11) : error C3861: 'buffer': identifier not 
      found, even with argument-dependent lookup<BR>e:\test\src\test.cpp(12) : 
      error C2070: ''unknown-type'': illegal sizeof 
      operand<BR>e:\test\src\test.cpp(12) : error C3861: 'SendInput': identifier 
      not found, even with argument-dependent lookup<BR>e:\test\src\test.cpp(12) 
      : error C3861: 'buffer': identifier not found, even with 
      argument-dependent lookup<BR>e:\test\src\test.cpp(12) : error C3861: 
      'INPUT': identifier not found, even with argument-dependent 
      lookup<BR>e:\test\src\test.cpp(13) : error C2541: 'delete' : cannot delete 
      objects that are not pointers<BR>e:\test\src\test.cpp(13) : error C3861: 
      'buffer': identifier not found, even with argument-dependent 
      lookup<BR><BR>I'm using everyting as specified in MSDN, but still got this 
      stupid compiler error. Have no idea why... :(<BR><A 
      href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/WinUI/WindowsUserInterface/UserInput/KeyboardInput/KeyboardInputReference/KeyboardInputFunctions/SendInput.asp" 
      target=_blank>http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/WinUI/WindowsUserInterface/UserInput/KeyboardInput/KeyboardInputReference/KeyboardInputFunctions/SendInput.asp</A><BR><A 
      href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/WinUI/WindowsUserInterface/UserInput/KeyboardInput/KeyboardInputReference/KeyboardInputStructures/INPUT.asp" 
      target=_blank>http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/WinUI/WindowsUserInterface/UserInput/KeyboardInput/KeyboardInputReference/KeyboardInputStructures/INPUT.asp</A><BR><BR>Obviously 
      what I want is this code to compile and run :)<BR><BR>PS<BR>When I compile 
      it with only &lt;winuser.h&gt; (instead #include "stdafx.h" I write 
      #include &lt;winuser.h&gt;), I get the following 
      errors:<BR><BR>c:\...\include\winuser.h(39) : error C2146: syntax error : 
      missing ';' before identifier 'HDWP'<BR>c:\...\include\winuser.h(39) : 
      fatal error C1004: unexpected end of file found<BR><BR>I've tried to 
      compile both on VC++ 6.0 and .net and both produce the same 
    errors!!!</DIV></TD></TR></TBODY></TABLE><BR>
<TABLE class=tborder cellSpacing=1 cellPadding=6 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=page>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR vAlign=bottom>
          <TD style="FONT-SIZE: 14pt">FireNet</TD>
          <TD class=smallfont align=right>Jun 7th 2004 03:22 
      AM</TD></TR></TBODY></TABLE>
      <HR>

      <DIV><STRONG>Re: visual c++ strange compile 
      error...</STRONG><BR>&nbsp;</DIV>
      <DIV>maybe you should try tinkering with the compiler options<BR><BR>or 
      try including both winuser.h and stdafx.h</DIV></TD></TR></TBODY></TABLE><BR>
<TABLE class=tborder cellSpacing=1 cellPadding=6 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=page>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR vAlign=bottom>
          <TD style="FONT-SIZE: 14pt">revilord</TD>
          <TD class=smallfont align=right>Jun 11th 2004 04:36 
      PM</TD></TR></TBODY></TABLE>
      <HR>

      <DIV><STRONG>Re: visual c++ strange compile 
      error...</STRONG><BR>&nbsp;</DIV>
      <DIV>I am having similar problems. Let us know if you find a solution. 
      Thanks</DIV></TD></TR></TBODY></TABLE><BR>
<TABLE class=tborder cellSpacing=1 cellPadding=6 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=page>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR vAlign=bottom>
          <TD style="FONT-SIZE: 14pt">bobd</TD>
          <TD class=smallfont align=right>Jun 13th 2004 03:02 
      PM</TD></TR></TBODY></TABLE>
      <HR>

      <DIV><STRONG>Re: visual c++ strange compile 
      error...</STRONG><BR>&nbsp;</DIV>
      <DIV>I took a quick look at the code then tried to compile under VC7.1. It 
      failed there too. I right clicked in the IDE to find the definition of 
      INPUT which took me to WINUSER.H. Everything looked ok right there, but 
      the looking up in the file I found that the definition of INPUT was 
      guarded by a <BR><BR>#if (_WIN32_WINNT &gt; 0x0400)<BR><BR>This 
      _WIN32_WINNT define appears to limit access to specific functionality 
      (including INPUT) to certain versions of windows. I looked to see where 
      _WIN32_WINNT defined but could not find it quickly, however it was being 
      tested with WINVER first thing in windows.h. It looks like it must be 
      defined prior to including windows.h<BR><BR>I was able to cleanly compile 
      by adding<BR><BR>#define _WIN32_WINNT 0x0501<BR><BR>as the first line in 
      stdafx.h.<BR><BR>have fun<BR>-bobd-</DIV></TD></TR></TBODY></TABLE><BR>
<TABLE class=tborder cellSpacing=1 cellPadding=6 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=page>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR vAlign=bottom>
          <TD style="FONT-SIZE: 14pt">FireNet</TD>
          <TD class=smallfont align=right>Jun 14th 2004 02:00 
      AM</TD></TR></TBODY></TABLE>
      <HR>

      <DIV><STRONG>Re: visual c++ strange compile 
      error...</STRONG><BR>&nbsp;</DIV>
      <DIV>Hey guys now be careful not to modify your actual headers it's not 
      safe.Bodb, nice of you to check it out but that kinda protection is usally 
      related to memory modes or some sort of diffrence in the way the compiled 
      program inteacts with the system or is compatable with.Now in this 
      particular case it may complie well but I would still recommend you change 
      the options on your complier when you are compliing your program.That way 
      you will be able to avoid any errors during runtime due to illegally 
      structured programs.</DIV></TD></TR></TBODY></TABLE><BR>
<TABLE class=tborder cellSpacing=1 cellPadding=6 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=page>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR vAlign=bottom>
          <TD style="FONT-SIZE: 14pt">bobd</TD>
          <TD class=smallfont align=right>Jun 15th 2004 03:18 
      AM</TD></TR></TBODY></TABLE>
      <HR>

      <DIV><STRONG>Re: visual c++ strange compile 
      error...</STRONG><BR>&nbsp;</DIV>
      <DIV>A little further searching for _WIN32_WINNT in the VS7 help index 
      brings the following.<BR><BR>[Begin help file text ]<BR>Certain functions 
      that depend on a particular version of Windows are declared using 
      conditional code. This enables you to use the compiler to detect whether 
      your application uses functions that are not supported on its target 
      version(s) of Windows. To compile an application that uses these 
      functions, you must define the appropriate macros. Otherwise, you will 
      receive the C2065 error message. The following table indicates the macros 
      you must define to target each system.<BR><BR>Minimum system required 
      Macros to define <BR>Windows Server 2003 family _WIN32_WINNT&gt;=0x0502 
      <BR>Windows XP _WIN32_WINNT&gt;=0x0501 <BR>Windows 2000 
      _WIN32_WINNT&gt;=0x0500 <BR>Windows NT 4.0 _WIN32_WINNT&gt;=0x0400 
      <BR>Windows Me _WIN32_WINDOWS=0x0490 <BR>Windows 98 
      _WIN32_WINDOWS&gt;=0x0410 <BR>Internet Explorer 6.0 _WIN32_IE&gt;=0x0600 
      <BR>Internet Explorer 5.01, 5.5 _WIN32_IE&gt;=0x0501 <BR>Internet Explorer 
      5.0, 5.0a, 5.0b _WIN32_IE&gt;=0x0500 <BR>Internet Explorer 4.01 
      _WIN32_IE&gt;=0x0401 <BR>Internet Explorer 4.0 _WIN32_IE&gt;=0x0400 
      <BR>Internet Explorer 3.0, 3.01, 3.02 _WIN32_IE&gt;=0x0300 <BR><BR><BR>For 
      example, to use the features specifically marked for Windows 2000 in the 
      header files, you need to explicitly define _WIN32_WINNT as 0x0500 or 
      greater. You can define the symbols using the #define statement in each 
      source file, or by specifying the /D_WIN32_WINNT=0x0500 compiler option 
      supported by Visual C++.<BR><BR>Visual C++ 6.0: To specify compiler 
      options, go to the Projects menu and click Settings, then select the C/C++ 
      tab.<BR><BR>Visual C++ 7.0: To specify compiler options, go to the 
      Projects menu and click Properties.<BR><BR>[End help file text]<BR><BR>So, 
      it looks like the INPUT structure was added to Windows after NT4. 
      According to the SDK help, to get access to the "new" structures, you must 
      either add a /D_WIN32_WINNT=0x0500 (or anything greater than 0x0400) to 
      the compile options or add the define to one of your header files before 
      you include windows.h. <BR><BR>I prefer putting project options of this 
      nature in the source as it makes the OS dependency visible, browsable, and 
      understandable (presuming an appropriate comment is included.) Since the 
      IDE generates stdafx.h as the "general header" for all files in a project, 
      I believe it is safe and reasonable to put the define for OS platform 
      there. <BR><BR>I totally agree that windows.h or any headers not specific 
      to a project should not be modified by a single 
      project.<BR><BR>-bobd-</DIV></TD></TR></TBODY></TABLE><BR><BR>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR vAlign=top>
    <TD class=smallfont>All times are GMT -4. The time now is <SPAN 
      class=time>10:03 PM</SPAN>.</TD>
    <TD align=right>
      <DIV class=smallfont></DIV></TD></TR></TBODY></TABLE>
<P class=smallfont align=center>Powered by: vBulletin Version 3.0.7 Copyright 
©2000 - 2005, Jelsoft Enterprises Ltd. <BR></P></BODY></HTML>
