<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0045)http://tech.99soft.net/h/2002-9-26/103186.htm -->
<HTML><HEAD><TITLE>程序员之家 - 为何不能Disable菜单项? 论文</TITLE>
<STYLE type=text/css>BODY {
	FONT-SIZE: 12px; MARGIN: 0px 4px
}
LI {
	FONT-SIZE: 12px; COLOR: black; TEXT-DECORATION: underline
}
TD {
	FONT-SIZE: 12px; MARGIN-LEFT: 5px; COLOR: #000000
}
TH {
	FONT-SIZE: 9pt; COLOR: #000000
}
A:link {
	FONT-SIZE: 12px; COLOR: black; TEXT-DECORATION: none
}
A:hover {
	FONT-SIZE: 12px; COLOR: red; TEXT-DECORATION: underline
}
A:visited {
	FONT-SIZE: 12px; COLOR: black; TEXT-DECORATION: none
}
IMG {
	BORDER-RIGHT: 0px; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px
}
.p1 {
	FONT-SIZE: 14px; COLOR: black; FONT-STYLE: normal; FONT-FAMILY: "宋体"
}
.p2 {
	PADDING-RIGHT: 10px; PADDING-LEFT: 10px; MARGIN-LEFT: 10px; LINE-HEIGHT: 16pt; MARGIN-RIGHT: 10px
}
.f1 {
	COLOR: #000000; LINE-HEIGHT: 14pt; PADDING-TOP: 5px
}
P {
	FONT-SIZE: 12px; COLOR: black
}
.big {
	FONT-SIZE: 14px; COLOR: black
}
.buttonstyle {
	BORDER-RIGHT: 1px outset; BORDER-TOP: 1px outset; BORDER-LEFT: 1px outset; BORDER-BOTTOM: 1px outset
}
.in01 {
	BORDER-RIGHT: 1px inset; BORDER-TOP: 1px inset; BACKGROUND: #99ccff; BORDER-LEFT: 1px inset; BORDER-BOTTOM: 1px inset
}
.box1 {
	BORDER-RIGHT: 1px solid; BORDER-TOP: 1px solid; BORDER-LEFT: 1px solid; BORDER-BOTTOM: 1px solid; HEIGHT: 18px
}
.style1 {
	COLOR: #990000; FONT-FAMILY: "宋体"
}
.style3 {
	FONT-SIZE: 14px
}
.style4 {
	COLOR: #ffffff
}
.style5 {
	FONT-WEIGHT: bold; FONT-FAMILY: Arial, Helvetica, sans-serif
}
.style6 {
	COLOR: #990000
}
</STYLE>

<META http-equiv=Content-Type content="text/html; charset=gb2312">
<META lang=cn 
content=免费vc编程,免费vc编程文章,免费vc源代码,vc编程技巧,界面编程,网络编程,多媒体编程,控件类编程,软件开发,程序开发,数据库编程,打印编程,句柄,图像,接口,进程,线程,窗口类,文档类,视图类,内存,系统,成员变量,菜单,对话框,指针,光标,变量,重载,继承,派生,客户区,工具栏,资源,图标,编译链接,阻塞,命令,框架,对象,拖放,参数,数据类型,文件操作,模 
name=keywords>
<META content=专业vc编程网站，vc入门及提高，完全免费的编程文章及vc源代码，想学vc，这里是最好的vc编程网站 
name=description>
<SCRIPT language=JavaScript src=""></SCRIPT>

<META content="MSHTML 6.00.2800.1491" name=GENERATOR></HEAD>
<BODY>
<TABLE cellSpacing=0 cellPadding=0 width=751 align=center border=0>
  <TBODY>
  <TR>
    <TD width=751 bgColor=#395a9f>
      <TABLE cellSpacing=1 cellPadding=4 width="100%" border=0>
        <TBODY>
        <TR>
          <TD align=middle width="23%" bgColor=#80bfff><STRONG><SPAN 
            class=style1>程 序 员 </SPAN>之 家</STRONG></TD>
          <TD align=right width="77%" bgColor=#cce5ff><A 
            href="http://tech.99soft.net/">技术资料</A> | <A 
            href="http://forum.99soft.net/">综合社区</A> 
  </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=4 width=750 align=center border=0>
  <TBODY>
  <TR>
    <TD width=162><IMG height=70 src="程序之家 - 何不能Disable菜 文.files/logo.gif" 
      width=160></TD>
    <TD width=468>
      <SCRIPT src=""></SCRIPT>
    </TD>
    <TD class=style3 align=middle width=96><A 
      href="http://tech.99soft.net/h/2002-9-26/103186.htm#">&gt;&gt;<A 
      onclick="this.style.behavior='url(#default#homepage)';this.setHomePage('http://www.99soft.net')" 
      href="javascript:;"><SPAN class=style3>设为首页</SPAN></A>&lt;&lt;<BR><A 
      onclick="window.external.addFavorite('http://www.99soft.net','程序员之家')" 
      href="javascript:;"><SPAN>&gt;&gt;<SPAN 
      class=style3>加入收藏</SPAN>&lt;&lt;</SPAN></A><BR><A 
      href="mailto:webmaster@99soft.net">&gt;&gt;<SPAN 
      class=style3>联系我们</SPAN></A>&lt;&lt; </TD></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 width=750 align=center border=0>
  <TBODY>
  <TR>
    <TD bgColor=#395a9f>
      <TABLE cellSpacing=1 cellPadding=4 width="100%" border=0>
        <TBODY>
        <TR>
          <TD class=style4 align=middle><A 
            href="http://tech.99soft.net/"><SPAN class=style4>首页</SPAN></A> |
            <SCRIPT src="程序之家 - 何不能Disable菜 文.files/menu.js"></SCRIPT>
             <A href="http://bbs.99soft.net/"><SPAN 
          class=style4>综合讨论区</SPAN></A></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=4 width=750 align=center border=0>
  <FORM action=http://tech.99soft.net/search.asp method=post>
  <TBODY>
  <TR>
    <TD bgColor=#ebebeb>技术资料搜索：
      <SCRIPT src="程序之家 - 何不能Disable菜 文.files/search.js"></SCRIPT>
       <A href="http://paper.99soft.net/" target=_blank><STRONG><FONT 
      color=red>论文资料 (重点推荐,精彩不容错过!)</FONT></STRONG></A> 
</TD></TR></FORM></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 width=750 align=center border=0>
  <TBODY>
  <TR>
    <TD width="100%" bgColor=#a8a8a8 height=1></TD></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 width=750 align=center border=0>
  <TBODY>
  <TR>
    <TD>
      <SCRIPT src="" Top_ad.js? js tech.99soft.net http:></SCRIPT>
    </TD></TR></TBODY></TABLE>
<TABLE height=24 cellSpacing=0 cellPadding=4 width=750 align=center border=0>
  <TBODY>
  <TR>
    <TD>・当前位置： <A href="http://tech.99soft.net/">程序员之家资料站</A> → <A 
      href="http://tech.99soft.net/c/B0008_1.html">C语言与C++</A> → <A 
      href="http://tech.99soft.net/c/B00028_1.html">图形图象处理</A> → 
正文</TD></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 width=750 align=center border=0>
  <TBODY>
  <TR>
    <TD width="100%" background="程序之家 - 何不能Disable菜 文.files/line.gif" 
    height=1></TD></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 width=750 align=center border=0>
  <TBODY>
  <TR>
    <TD vAlign=top align=left width=570 height=67>
      <TABLE style="TABLE-LAYOUT: fixed; WORD-BREAK: break-all" cellSpacing=1 
      cellPadding=4 width="100%" border=0>
        <TBODY>
        <TR>
          <TD align=middle><SPAN 
            style="FONT-SIZE: 16px"><B>为何不能Disable菜单项?</B></SPAN></TD></TR>
        <TR>
          <TD align=middle><A href="http://www.99soft.net/">程序员之家</A> 作者：旅者整理 
            日期：2002-9-26 22:20:00</TD></TR>
        <TR>
          <TD>
            <HR align=center width="98%" SIZE=1>
          </TD></TR>
        <TR>
          <TD style="FONT-SIZE: 14px">问：我有一个工具按钮在WM_COMMAND消息是这样做的:</FONT>
            <P></P>
            <P style="FONT-SIZE: 14px"><BR>Cmenu *pMenu = 
            GetMenu();<BR>pMenu-&gt;EnableMenuItem(ID_MY_OPTION,MF_BYCOMMAND|MF_DISABLED);</FONT></P>
            <P 
            style="FONT-SIZE: 14px">但菜单并没有被Disable<BR>答：缺省的习惯是当没有UpdateCmdUI句柄时程序是使能（Enable)菜单，这就是<BR>为什么菜单自动 
            变成使能，只要关掉缺省值就可以了，把下面的代码加入你的<BR>程序</FONT></P>
            <P style="FONT-SIZE: 14px">CMainFrm::CMainFrm<BR>{<BR>// Other 
            stuff<BR>this-&gt;m_bAutoMenuEnable = false;<BR>}</FONT></P>
            <P style="FONT-SIZE: 14px"><BR>
            <SCRIPT type=text/javascript><!--
google_ad_client = "pub-7571846847850254";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
google_ad_channel ="";
google_color_border = "DFF2FD";
google_color_bg = "DFF2FD";
google_color_link = "0000CC";
google_color_url = "008000";
google_color_text = "000000";
//--></SCRIPT>

            <SCRIPT src="程序之家 - 何不能Disable菜 文.files/show_ads.js" 
            type=text/javascript>
</SCRIPT>
            </P></TD></TR>
        <TR>
          <TD align=right>来源：程序员之家</TD></TR>
        <TR>
          <TD align=middle><INPUT onclick=window.print() type=image 
            src="程序之家 - 何不能Disable菜 文.files/print.gif"> <INPUT 
            onclick=window.close() type=image 
            src="程序之家 - 何不能Disable菜 文.files/close.gif"></TD></TR>
        <TR>
          <TD>&nbsp;</TD></TR></TBODY></TABLE></TD>
    <TD width=1 bgColor=#80bfff></TD>
    <TD vAlign=top align=left width=173 bgColor=#dee7f7>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR>
          <TD align=middle background="程序之家 - 何不能Disable菜 文.files/titlebg.gif" 
          height=24>・ 相关文章 ・</TD></TR>
        <TR>
          <TD height=24></TD></TR></TBODY></TABLE>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR>
          <TD align=middle background="程序之家 - 何不能Disable菜 文.files/titlebg.gif" 
          height=24>・ 本类热点 ・</TD></TR>
        <TR>
          <TD height=24>没有任何文章！</TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 width=750 align=center border=0>
  <TBODY>
  <TR>
    <TD bgColor=#000000 height=1></TD></TR>
  <TR>
    <TD bgColor=#e7e7e7 height=12></TD></TR></TBODY></TABLE>
<TABLE height=20 cellSpacing=0 cellPadding=0 width=750 align=center border=0>
  <TBODY>
  <TR bgColor=#395a9f>
    <TD align=middle bgColor=#395a9f height=30><FONT color=#ffffff>关于我们</FONT> 
      <FONT color=#ffffff>|</FONT> <FONT color=#ffffff>帮助(？)</FONT> <FONT 
      color=#ffffff>|</FONT> <FONT color=#ffffff>广告服务</FONT> <FONT 
      color=#ffffff>|</FONT> <FONT color=#ffffff>版权声明</FONT> <FONT 
      color=#ffffff>| 商业合作</FONT> <FONT color=#ffffff>|</FONT> <FONT 
      color=#ffffff>发展历程</FONT> <FONT color=#ffffff>|</FONT> <FONT 
      color=#ffffff>加盟我们</FONT> <FONT color=#ffffff>|</FONT> <FONT 
      color=#ffffff>联系我们</FONT> </TD></TR>
  <TBODY>
  <TR>
    <TD align=middle height=30>
      <TABLE height=18 cellSpacing=0 cellPadding=0 width="98%" align=center 
      border=0>
        <TBODY>
        <TR>
          <TD width="55%" height=19><FONT 
            face="Verdana, Arial, Helvetica, sans-serif">Copyright &copy; 1998-2003 
            </FONT><SPAN class=style5>99Soft<SPAN 
            class=style6>.Net</SPAN></SPAN><FONT 
            face="Verdana, Arial, Helvetica, sans-serif"> All Rights 
            Reserved.</FONT></TD>
          <TD width="20%" height=19>
            <DIV align=right></DIV></TD>
          <TD width="25%" height=19>
            <DIV align=right><FONT 
            face="Verdana, Arial, Helvetica, sans-serif">Powered by:<A 
            href="http://www.99soft.net/" target=_blank><SPAN 
            class=style5>99Soft<SPAN 
            class=style6>.Net</SPAN></SPAN></A></FONT></DIV></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></BODY></HTML>
