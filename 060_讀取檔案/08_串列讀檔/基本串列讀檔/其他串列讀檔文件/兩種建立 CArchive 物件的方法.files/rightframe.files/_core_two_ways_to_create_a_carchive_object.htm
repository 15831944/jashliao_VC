<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0107)http://msdn.microsoft.com/library/CHT/vccore/html/_core_two_ways_to_create_a_carchive_object.asp?frame=true -->
<!--TOOLBAR_EXEMPT--><!--TOOLBAR_EXEMPT--><HTML xmlns:tool = 
"http://www.microsoft.com/tooltip"><HEAD><TITLE>兩種建立 CArchive 物件的方法 (Visual C++ 概念 - 繁體中文) (Visual C++ 概念 - 繁體中文)</TITLE>
<META http-equiv=Content-Type content="text/html; charset=utf-8">
<META 
content="有兩種方法可以建立 CArchive 物件：       透過架構隱含建立 CArchive 物件     外顯建立 CArchive 物件      透過架構隱含建立 CArchive 物件    最常見及最簡單的方法是，讓架構為您的文件依照檔案功能表上的儲存、另存新檔及開啟命令建立一個 CArchive 物件。     此處是當您的應用程式使用者從檔案功能表發出了另存新檔命令時，架構所進行的動作：       展示 [另存新檔] 對話方塊及從使用者取得檔案名稱。     開啟使用者稱為 CFile" 
name=Description>
<META content="" name=Robots>
<META content="" name=Keywords>
<META content=zh-CHT name=MS.LOCALE><LINK 
href="_core_two_ways_to_create_a_carchive_object.files/ie4.css" type=text/css 
rel=stylesheet><LINK 
href="_core_two_ways_to_create_a_carchive_object.files/ie5.css" type=text/css 
rel=stylesheet>
<STYLE>BODY {
	MARGIN: 0px; FONT-FAMILY: Bold 9pt Verdana
}
</STYLE>

<SCRIPT language=javascript 
src="_core_two_ways_to_create_a_carchive_object.files/dtuelink.js"></SCRIPT>

<SCRIPT language=javascript 
src="_core_two_ways_to_create_a_carchive_object.files/toolbar.js"></SCRIPT>

<SCRIPT language=javascript 
src="_core_two_ways_to_create_a_carchive_object.files/Broker.js"></SCRIPT>
<LINK href="_core_two_ways_to_create_a_carchive_object.files/dtue.css" 
type=text/css rel=stylesheet><LINK 
href="_core_two_ways_to_create_a_carchive_object.files/default.css" 
type=text/css rel=stylesheet><LINK 
href="_core_two_ways_to_create_a_carchive_object.files/ie.css" type=text/css 
rel=stylesheet>
<SCRIPT language=JavaScript><!--
   function BrowserData()
{
		this.userAgent = "Mozilla/4.0 (compatible; MSIE 6.0; Windows 98)";

		this.bot = false;

		this.browser = "MSIE";

		this.majorVer = 6;

		this.minorVer = "0";

		this.betaVer = "0";

		this.platform = "98";

		this.platVer = "0";

		this.getsNavBar = true;

		this.doesActiveX = true;

		this.doesPersistence = true;

		this.fullVer = 6;

   }

   var oBD = new BrowserData();

   //--></SCRIPT>

<SCRIPT>
	if( self == top )
{
	location = "/library/CHT/vccore/html/_core_two_ways_to_create_a_carchive_object.asp";
}

</SCRIPT>
<xml id=xmlPageContext><eyebrow findmenu="false">
	<item label="MSDN Home" url="http://www.microsoft.com/taiwan/msdn/"/>
</eyebrow></xml>
<SCRIPT>
var sContentID = "_150816"; 
 </SCRIPT>
<!--VENUS_START-->
<META content="兩種建立 CArchive 物件的方法" name=MSHTOCTitle>
<META content="兩種建立 CArchive 物件的方法 (MFC)" name=MSHRLTitle>
<META content=_core_Two_Ways_to_Create_a_CArchive_Object name=MSHKeywordA>
<META content="CArchive 類別, 關閉 CArchive 物件" name=MSHKeywordK>
<META content="CArchive 類別, 建構函式" name=MSHKeywordK>
<META content="關閉 CArchive 物件" name=MSHKeywordK>
<META content="資料存放區, CArchive 類別" name=MSHKeywordK>
<META content="I/O, CArchive 類別" name=MSHKeywordK>
<META content="序列化, CArchive 類別" name=MSHKeywordK>
<META content="儲存體, CArchive 類別" name=MSHKeywordK>
<META content=_core_Two_Ways_to_Create_a_CArchive_Object name=MSHKeywordA>
<META content=carchive name=MSHKeywordF>
<META content=DevLang:C name=MSHAttr>
<META content=DevLangVers:kbLangC name=MSHAttr>
<META content=DevLang:C++ name=MSHAttr>
<META content=DevLangVers:kbLangCPP name=MSHAttr>
<META content="DocSet:Visual C++" name=MSHAttr>
<META content="DocSet:Visual Studio" name=MSHAttr>
<META content=Product:VC name=MSHAttr>
<META content=ProductVers:kbVC700 name=MSHAttr>
<META content=TargetOSVers:kbWinOS name=MSHAttr>
<META content=TopicType:kbOrient name=MSHAttr>
<META content=TargetOS:Windows name=MSHAttr>
<META content=Locale:kbChineseTrad name=MSHAttr><!---VENUS_END---><LINK 
href="_core_two_ways_to_create_a_carchive_object.files/css.aspx" type=text/css 
rel=stylesheet>
<SCRIPT language=javascript>
var doImage=doImage;var TType=TType;
function mhHover(tbl,idx,cls){var t,d;if(document.getElementById)t=document.getElementById(tbl);else t=document.all(tbl);if(t==null)return;if(t.getElementsByTagName)d=t.getElementsByTagName("TD");else d=t.all.tags("TD");if(d==null)return;if(d.length<=idx)return;d[idx].className=cls;}
function footerjs(doc){if(doImage==null){var tt=TType==null?"PV":TType;doc.write('<layer visibility="hide"><div style="display:none"><img src="http://c.microsoft.com/trans_pixel.asp?source=msdn&TYPE=' + tt + '&p=library_CHT_vccore_html__core_two_ways_to_create_a_carchive&URI=%2flibrary%2ftoolbar%2f3.0%2fasp.aspx%3fmode%3dhead%26c%3d%2flibrary%2fcht%2fchtshell.config%26h%3dmsdn%252Emicrosoft%252Ecom%26u%3d%252Flibrary%252FCHT%252Fvccore%252Fhtml%252F%255Fcore%255Ftwo%255Fways%255Fto%255Fcreate%255Fa%255Fcarchive%255Fobject%252Easp%26r%3dhttp%253A%252F%252Fmsdn%252Emicrosoft%252Ecom%252Flibrary%252Fshared%252Fdeeptree%252Fasp%252Frightframe%252Easp%253Fdtcfg%253D%252Flibrary%252Fcht%252Fdeeptreeconfig%252Exml%2526url%253D%252Flibrary%252FCHT%252Fvccore%252Fhtml%252F%255Fcore%255Ftwo%255Fways%255Fto%255Fcreate%255Fa%255Fcarchive%255Fobject%252Easp%253Fframe%253Dtrue%2526hidetoc%253Dfalse&GUID=1F4FC18C-F71E-47FB-8FC9-612F8EE59C61&r=http%3a%2f%2fmsdn.microsoft.com%2flibrary%2fshared%2fdeeptree%2fasp%2frightframe.asp%3fdtcfg%3d%2flibrary%2fcht%2fdeeptreeconfig.xml%26url%3d%2flibrary%2fCHT%2fvccore%2fhtml%2f_core_two_ways_to_create_a_carchive_object.asp%3fframe%3dtrue%26hidetoc%3dfalse" width=0 height=0 hspace=0 vspace=0 border=0 /></div></layer>');}}
</SCRIPT>

<META content="MSHTML 6.00.2800.1491" name=GENERATOR></HEAD>
<BODY text=#000000 bgColor=#ffffff leftMargin=0 topMargin=0 MARGINWIDTH="0" 
MARGINHEIGHT="0">
<TABLE height=24 cellSpacing=0 cellPadding=4 width="100%" bgColor=#ffffff 
border=0>
  <TBODY>
  <TR>
    <TD class=eyebrow vAlign=center align=left width="100%">&nbsp;&nbsp; <A 
      href="http://msdn.microsoft.com/library/CHT/vccore/html/"></A></TD></TR></TBODY></TABLE>
<TABLE class=clsContainer style="TABLE-LAYOUT: fixed" cellSpacing=0 
cellPadding=15 width="100%" border=0 float="left">
  <TBODY>
  <TR>
    <TD vAlign=top><!--TOOLBAR_START--><!--TOOLBAR_EXEMPT--><!--TOOLBAR_END--><!-- Begin Content --><!--NONSCROLLING BANNER START-->
      <DIV id=nsbanner>
      <DIV id=bannerrow1>
      <TABLE class=bannerparthead cellSpacing=0>
        <TBODY>
        <TR id=hdr>
          <TD class=runninghead noWrap>Visual&nbsp;C++&nbsp;概念：加入功能</TD>
          <TD class=product noWrap>&nbsp;</TD></TR></TBODY></TABLE></DIV>
      <DIV id=TitleRow>
      <H1 class=dtH1><A name=_core_two_ways_to_create_a_carchive_object></A>兩種建立 
      CArchive 物件的方法</H1></DIV></DIV><!--NONSCROLLING BANNER END-->
      <DIV id=nstext valign="bottom">
      <DIV class=saveHistory id=allHistory onload="loadAll()" 
      onsave="saveAll()"></DIV><!-- Topic Status -->
      <P>有兩種方法可以建立 <B>CArchive</B> 物件： 
      <UL type=disc>
        <LI><A 
        href="http://msdn.microsoft.com/library/CHT/vccore/html/_core_two_ways_to_create_a_carchive_object.asp?frame=true#_core_implicit_creation_of_a_carchive_object_via_the_framework" 
        target=_self>透過架構隱含建立 CArchive 物件</A> 
        <LI><A 
        href="http://msdn.microsoft.com/library/CHT/vccore/html/_core_two_ways_to_create_a_carchive_object.asp?frame=true#_core_explicit_creation_of_a_carchive_object" 
        target=_self>外顯建立 CArchive 物件</A> </LI></UL>
      <H3 class=dtH3><A 
      name=_core_implicit_creation_of_a_carchive_object_via_the_framework></A>透過架構隱含建立 
      CArchive 物件</H3>
      <P>最常見及最簡單的方法是，讓架構為您的文件依照檔案功能表上的儲存、另存新檔及開啟命令建立一個 <B>CArchive</B> 物件。 </P>
      <P>此處是當您的應用程式使用者從檔案功能表發出了另存新檔命令時，架構所進行的動作： 
      <OL type=1>
        <LI>展示 [另存新檔] 對話方塊及從使用者取得檔案名稱。 
        <LI>開啟使用者稱為 <B>CFile</B> 物件的檔案。 
        <LI>建立一個指向這個 <B>CFile</B> 物件的 <B>CArchive</B> 物件。建立這個 <B>CArchive</B> 
        物件時，架構會把模式設定成「儲存」(寫入、序列化)，相對於「載入」(讀取、解除序列化)。 
        <LI>呼叫定義在 <B>CDocument</B> 的衍生類別之 <CODE class=ce>Serialize</CODE> 
        函式，向其傳遞一個 <B>CArchive</B> 物件的參考。 </LI></OL>
      <P>接著您的文件的 <CODE class=ce>Serialize</CODE> 函式會將資料寫入 <B>CArchive</B> 
      物件中，如下簡略說明所示。一旦您的 <CODE class=ce>Serialize</CODE> 函式傳回時，這個架構便會終結這個 
      <B>CArchive</B> 物件及其之後的 <B>CFile</B> 物件。</P>
      <P>因此，如果您讓架構為文件建立 <B>CArchive</B> 物件，則所要作的只有實作負責文件寫入及讀取保存的 <CODE 
      class=ce>Serialize</CODE> 函式。您也必須為任一個文件的 <CODE class=ce>Serialize</CODE> 
      函式依序直接或間接序列化的 <B>CObject</B> 衍生物件實作 <CODE class=ce>Serialize</CODE>。</P>
      <H3 class=dtH3><A 
      name=_core_explicit_creation_of_a_carchive_object></A>外顯建立 CArchive 
物件</H3>
      <P>除了透過架構序列化一份文件，您可能還會在其他場合使用到 <B>CArchive</B> 物件。例如，您可能希望序列化剪貼簿中的資料 (以 
      <B>CSharedFile</B> 物件表示)。或是您可能想要使用使用者介面，來儲存不同於架構所提供的檔案之檔案。在這個案例中，您可以明確地建立 
      <B>CArchive</B> 物件。您可以使用下列程序，達到使用架構時的效果。</P>
      <P class=labelproc><B><A 
      name=_core_to_explicitly_create_a_carchive_object></A>若要外顯建立 CArchive 
      物件</B> 
      <OL type=1>
        <LI>建構一個 <B>CFile</B> 物件或是一個自 <B>CFile</B> 衍生的物件。 
        <LI>傳遞 <B>CFile</B> 物件到 <B>CArchive</B> 的建構函式，請參閱下列範例： <PRE class=code>CFile theFile;
theFile.Open(..., CFile::modeWrite);
CArchive archive(&amp;theFile, CArchive::store);</PRE>
        <P><B>CArchive</B> 建構函式的第二個引數是一個列舉值，其可指定這個保存將會被用來儲存資料到檔案中，或是從檔案中載入資料。物件的 
        <CODE class=ce>Serialize</CODE> 函式會為這個保存物件呼叫 <B>IsStoring</B> 函式來檢查這種狀態。 
        </P></LI></OL>
      <P>當您完成儲存資料到 <B>CArchive</B> 物件，或是完成從 <B>CArchive</B> 載入資料，須將其關閉。雖然 
      <B>CArchive</B> (及 <B>CFile</B>) 物件會自動關閉保存 
      (及檔案)，但最好仍明確地執行這種行為，以便其更容易從錯誤中復原。如需錯誤處理的詳細資訊，請參閱<A 
      href="http://msdn.microsoft.com/library/CHT/vccore/html/_core_exceptions.3a_.catching_and_deleting_exceptions.asp">例外狀況：捕捉和刪除例外狀況</A>文件。 
      </P>
      <P class=labelproc><B><A name=_core_to_close_the_carchive_object></A>若要關閉 
      CArchive 物件</B> 
      <UL type=disc>
        <LI>下列的範例說明如何關閉 <B>CArchive</B> 物件： <PRE class=code>archive.Close();
theFile.Close();</PRE></LI></UL>
      <H4 class=dtH4>請參閱</H4>
      <P><A 
      href="http://msdn.microsoft.com/library/CHT/vccore/html/_core_serialization.3a_.serializing_an_object.asp">序列化：序列化物件</A></P><!-- End Content --></DIV></TD></TR></TBODY></TABLE><BR 
style="OVERFLOW: hidden; LINE-HEIGHT: 1px" clear=all>
<TABLE id=msviFooter cellSpacing=0 cellPadding=0 width="100%">
  <TBODY>
  <TR vAlign=bottom>
    <TD id=msviFooter2 
    style="FILTER: progid:DXImageTransform.Microsoft.Gradient(startColorStr='#FFFFFF', endColorStr='#669AFF', gradientType='1')">
      <DIV id=msviLocalFooter><NOBR><A 
      href="https://profile.microsoft.com/RegSysProfileCenter/Infodefault.aspx?LCID=1028">個人資訊中心</A> 
      |</NOBR><WBR><NOBR><A 
      href="http://www.microsoft.com/taiwan/misc/mstc/contactus.htm" 
      target=_parent>與我們聯繫</A></NOBR></DIV>
      <DIV id=msviGlobalFooter><SPAN dir=ltr>©2005 Microsoft Corporation. 
      著作權所有，並保留一切權利。&nbsp;</SPAN><NOBR><A 
      href="http://www.microsoft.com/taiwan/misc/cpyright.htm" 
      target=_parent>使用規定</A> |</NOBR><WBR><NOBR><A 
      href="http://msdn.microsoft.com/library/toolbar/3.0/trademarks/zh-tw.mspx">商標</A> 
      |</NOBR><WBR><NOBR><A href="http://www.microsoft.com/info/tw/privacy.htm" 
      target=_parent>隱私權聲明</A></NOBR></DIV></TD>
    <TD width=105 bgColor=#669aff><IMG title="" height=29 alt=Microsoft 
      src="_core_two_ways_to_create_a_carchive_object.files/text.jpg" width=105 
      border=0></TD></TR></TBODY></TABLE>
<SCRIPT language=javascript>var msviFooter2;if (document.getElementById){msviFooter2 = document.getElementById("msviFooter2");msviFooter2.style.filter = "";}</SCRIPT>

<TABLE height=58 cellSpacing=0 cellPadding=0 width="100%">
  <TBODY>
  <TR vAlign=top>
    <TD>
      <DIV style="WIDTH: 200px"></DIV></TD>
    <TD 
    style="FILTER: progid:DXImageTransform.Microsoft.Gradient(startColorStr='#FFFFFF', endColorStr='#669AFF', gradientType='1')" 
    width="100%"></TD></TR></TBODY></TABLE>
<SCRIPT language=javascript>footerjs(document);</SCRIPT>
</BODY></HTML>
