<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0051)http://www.codeproject.com/win32/AntonioWinLock.asp -->
<HTML><HEAD><TITLE>Lock Windows Desktop - The Code Project - Win32 / SDK</TITLE>
<META http-equiv=Reply-to content=mailto:webmaster@codeproject.com>
<META http-equiv=Content-Type content="text/html; charset=iso-8859-1">
<META content=en-US name=MS.LOCALE>
<META 
content="Restricting Windows access by hiding desktop windows and disabling special keys." 
name=Description>
<META content=kbArticle name=Search.TopicType>
<META content="Antnio Feijo" name=Author>
<META content="13 Jun 2004 14:00:00 GMT" name=Search.PublishDate>
<META content="02 May 2005 14:00:00 GMT" name=Search.RevisedDate>
<META content="Free source code, , Visual C++, MFC, Windows, lock desktop" 
name=keywords>
<META 
content="Article content copyright Antnio Feijo, 2004, everthing else Copyright © CodeProject, 1999-2007, All Rights Reserved." 
name=Copyright><LINK title="CodeProject Lounge Postings" 
href="http://www.codeproject.com/webservices/LoungeRSS.aspx" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - All topics" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=1" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - MFC / C++" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=2" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - C#" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=3" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - ASP.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=4" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - .NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=5" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - VB.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=6" 
type=application/rss+xml rel=alternate><LINK title="The Code Project" 
href="http://www.codeproject.com/info/OpenSearch.xml" 
type=application/opensearchdescription+xml rel=search><LINK href="/favicon.ico" 
type=image/ico rel=icon><LINK href="/favicon.ico" rel="SHORTCUT ICON"><LINK 
href="Lock Windows Desktop - The Code Project - Win32 - SDK.files/global.css" 
type=text/css rel=stylesheet>
<SCRIPT language=javascript 
src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/oncopy.js"></SCRIPT>

<SCRIPT language=javascript>
if (top != self) top.location.href = location.href;
if (typeof(DemoUrl) != "undefined")
	document.write('<me' + 'ta http' + '-equiv="re' + 'fresh" con' + 'tent="1;url=' + DemoUrl + '">');
</SCRIPT>

<META content="MSHTML 6.00.2900.3020" name=GENERATOR></HEAD>
<BODY style="MARGIN: 0px" oncopy="return copyCode();" text=black vLink=navy 
aLink=red link=blue bgColor=white><!-- BEGIN I/PRO PAGE TAG - COPYRIGHT 2006 I/PRO Corporation ALL RIGHTS RESERVED. -->
<SCRIPT language=JavaScript> 
var LSPT=""; 
LSPT += "?durl=" + escape(document.URL); 
LSPT += "&hostname=" + location.hostname; 
LSPT += "&url=" + location.pathname; 
LSPT += "&query=" + escape(location.search) + escape(location.hash); 
LSPT += "&referrer=" + escape(document.referrer); 
LSPT += "&browser=" + escape(navigator.appName); 
LSPT += "&version=" + escape(navigator.appVersion); 
LSPT += "&os=" + escape(navigator.platform); 
LSPT += "&xdomain=codeproject.com"; 
LSPT += "&custid=codeproject"; 
</SCRIPT>

<SCRIPT language=Javascript> 
document.write('<img src=http://'+'content.ipro.com/images/pixel.gif'+LSPT+' height="1" width="1" style="position:absolute;top:0px;left:0px">'); 
</SCRIPT>
<NOSCRIPT><IMG style="LEFT: 0px; POSITION: absolute; TOP: 0px" height=1 
src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/pixel.gif" 
width=1> </NOSCRIPT><!-- END I/PRO PAGE TAG -->
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=HeaderLogo><A href="http://www.codeproject.com/"><IMG height=90 
      alt=Home 
      src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/codeproject225x90.gif" 
      border=0></A></TD>
    <TD class=HeaderBanner><SPAN id=AdBanner4>
      <SCRIPT language=javascript>document.write("<IFRAME src=\"/script/ann/ServeHTML.aspx?C=False&id=2891&cb=7826432\" border=0 frameborder=0 scrolling=no width=728 height=90></IFRAME>");</SCRIPT>
      </SPAN></TD></TR>
  <TR>
    <TD colSpan=2>
      <TABLE class=MemberNavBar cellSpacing=0 cellPadding=5 width="100%" 
      border=0>
        <TBODY>
        <TR vAlign=center>
          <TD class=smallText style="FONT-WEIGHT: bold">3,772,183 members and 
            growing! &nbsp; 6,551 now online. </TD>
          <TD class=userNavText align=right><A 
            href="http://www.codeproject.com/script/profile/whos_who.asp?id=2548593">lubita7052 
            </A>| <A 
            href="http://www.codeproject.com/script/profile/modify.asp?ct=/win32/AntonioWinLock.asp"><B>My 
            Settings</B></A> | <A 
            href="http://www.codeproject.com/script/profile/bookmark_list.asp">My 
            Bookmarks</A> | <A 
            href="http://www.codeproject.com/script/articles/list_articles.asp?userid=2548593">My 
            Articles</A> | <A 
            href="http://www.codeproject.com/script/profile/logoff.asp?ct=/win32/AntonioWinLock.asp">Sign 
            out</A> </TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD colSpan=2>
      <TABLE class=SiteNavBar id=tblSiteToolbar cellSpacing=0 cellPadding=0>
        <TBODY>
        <TR>
          <TD><A href="http://www.codeproject.com/">Home</A></TD>
          <TD class=SelCat noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=2">MFC/C++</A></TD>
          <TD><A href="http://www.codeproject.com/index.asp?cat=3">C#</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=4">ASP.NET</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=6">VB.NET</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=8">Architect</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=9">SQL</A></TD>
          <TD noWrap><A href="http://www.codeproject.com/index.asp?cat=1">All 
            Topics</A></TD>
          <TD width="100%">&nbsp;</TD>
          <TD>
            <DIV id=MenuPos 
            style="WIDTH: 300px; POSITION: relative; TOP: 1px; HEIGHT: 22px">
            <TABLE id=MPH 
            style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; HEIGHT: 20px; BORDER-RIGHT-WIDTH: 0px" 
            cellSpacing=0 cellPadding=0 width=300>
              <TBODY>
              <TR vAlign=center>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/info/faq.asp">Help!</A></TD>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/info/latest.asp">Articles</A></TD>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/script/comments/forums.asp">Message 
                  Boards</A></TD>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/lounge.asp">Lounge</A></TD></TR></TBODY></TABLE></DIV></TD></TR></TBODY></TABLE>
      <SCRIPT type=text/javascript>function Go(){return}</SCRIPT>

      <SCRIPT 
      src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/cpmenu_var.js" 
      type=text/javascript></SCRIPT>

      <SCRIPT 
      src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/menu10_com.js" 
      type=text/javascript></SCRIPT>

      <SCRIPT type=text/javascript>
var MPH = document.getElementById("MPH");
if (MPH) MPH.style.display='none';
</SCRIPT>
    </TD></TR>
  <TR>
    <TD colSpan=2>
      <TABLE class=ArticleHeader cellSpacing=0 cellPadding=3 width="100%">
        <TBODY>
        <TR vAlign=top>
          <TD class=smallText style="PADDING-RIGHT: 10px"><A 
            href="http://www.codeproject.com/?cat=1">All Topics</A>, <A 
            href="http://www.codeproject.com/?cat=2">MFC / C++</A> &gt;&gt; <A 
            href="http://www.codeproject.com/win32/">Win32 / SDK</A> &gt;&gt; <A 
            href="http://www.codeproject.com/win32/#General">General</A><BR><BR>
            <DIV style="FONT-WEIGHT: bold; FONT-SIZE: 16pt">Lock Windows 
            Desktop</DIV><B>By <A 
            href="http://www.codeproject.com/script/Articles/list_articles.asp?userid=214034">Antnio 
            Feijo</A></B>. <BR><BR>
            <DIV style="FONT-SIZE: 12px">Restricting Windows access by hiding 
            desktop windows and disabling special keys.</DIV></TD>
          <TD class=smallText style="WIDTH: 200px">C++ (VC6), 
            VB<BR>Windows<BR>Win32, VS (VS6, VS5)<BR>Dev<BR><SPAN 
            style="PADDING-RIGHT: 2ex">Posted</SPAN>: <B>14 Jun 
            2004</B><BR><SPAN style="PADDING-RIGHT: 0.3ex">Updated</SPAN>: <B>3 
            May 2005 </B><BR><SPAN style="PADDING-RIGHT: 3ex">Views</SPAN>: 
            <B>195,475</B> </TD></TR></TD></TR></TD></TR></TBODY></TABLE>
      <TABLE cellSpacing=0 cellPadding=0 border=0>
        <TBODY>
        <TR vAlign=top>
          <TD class=LHNavBar rowSpan=2><!-- Yes, there are IE hacks that will allow us to create a min-width DIV 
	     (eg http://www.webreference.com/programming/min-width/) but I couldn't
	     be arsed. Wait for it in v2.0 -->
            <DIV class=FeatureBlockHeader>Announcements</DIV>
            <DIV class="FeatureBlockContent RHFeatureBar">
            <DIV style="PADDING-TOP: 5px"><IMG 
            style="PADDING-RIGHT: 10px; FLOAT: left" height=20 alt=Vista 
            src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/vista20.gif" 
            width=20> <A 
            href="http://www.codeproject.com/redir.aspx?id=2666">Vista API 
            competition<BR>$10,000 in prizes</A></DIV>
            <DIV style="PADDING-TOP: 5px"><IMG 
            style="PADDING-RIGHT: 10px; FLOAT: left" height=20 alt=Vista 
            src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/gadgets20.gif" 
            width=20> <A 
            href="http://www.codeproject.com/redir.aspx?id=2848">Vista Gadget 
            comp: $2,000 in prizes</A></DIV>
            <DIV style="PADDING-TOP: 5px"><IMG 
            style="PADDING-RIGHT: 10px; FLOAT: left; MARGIN-LEFT: 7px; MARGIN-RIGHT: 10px" 
            height=20 alt=Comp 
            src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/prize_winner_sm.gif" 
            width=10><A 
            href="http://www.codeproject.com/script/competitions/monthly/">Monthly 
            Competition</A></DIV></DIV>
            <CENTER>
            <SCRIPT language=javascript>document.write("<a href=\"/script/admentor/admentorredir.asp?id=2687&way=ban\" target=_blank><img src=\"/script/ann/ServeImg.aspx?File=%2Fscript%2Fadmentor%2Fimages%2FWholeTomato%5FChangeSigExt%5F160x600%2Egif&C=False&id=2687&cb=7826437\" alt=\"The intellisense upgrade for Visual Studio .NET - make your IDE as smart as you.\" border=0 width=160 height=600></a>");</SCRIPT>
            </CENTER><BR><BR><IMG height=1 
            src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/t.gif" 
            width=160> </TD>
          <TD width="100%">
            <TABLE class=SearchHeaderBar cellSpacing=0 width="100%">
              <TBODY>
              <TR>
                <TD vAlign=center noWrap align=right width="60%">
                  <FORM style="MARGIN: 0px" name=Search action=/info/search.asp 
                  method=post><B>Search &nbsp;</B><INPUT class=smallText 
                  style="WIDTH: 200px" name=target> <SELECT 
                  style="FONT-WEIGHT: bold; FONT-SIZE: 8pt" name=st> <OPTION 
                    value=kw selected>Articles</OPTION> <OPTION 
                    value=au>Authors</OPTION></SELECT> <INPUT style="FONT-WEIGHT: bold; FONT-SIZE: 8pt" type=submit value=" Go! "> 
                  &nbsp; </FORM></TD>
                <TD class=tinyText noWrap><A 
                  href="http://www.codeproject.com/info/search.asp">Advanced 
                  Search</A><BR><A 
                  href="http://www.codeproject.com/script/articles/sections.asp">Sitemap</A> 
                </TD></TR></TBODY></TABLE>
            <TABLE width="100%">
              <TBODY>
              <TR vAlign=top>
                <TD class=SmallText noWrap>
                  <TABLE>
                    <TBODY>
                    <TR>
                      <TD class=smallText noWrap><IMG 
                        src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/print.gif" 
                        align=absMiddle> <A 
                        href="http://www.codeproject.com/win32/AntonioWinLock.asp?print=true" 
                        target=_print>Print</A></TD>
                      <TD class=smallText noWrap><IMG 
                        src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/sitebuild_icon.gif" 
                        align=absMiddle><A 
                        href="http://www.codeproject.com/script/submit/ReportProblem.asp?GUID=AntonioWinLock%2Fw2k6%2F14%2F2004">Broken 
                        Article?</A></TD>
                      <TD class=smallText noWrap><IMG 
                        src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/link.gif" 
                        align=absMiddle><A 
                        href="http://www.codeproject.com/script/profile/add_bookmark.asp?t=0&amp;ct=%2Fwin32%2FAntonioWinLock%2Easp&amp;guid=AntonioWinLock%2Fw2k6%2F14%2F2004">Bookmark</A></TD>
                      <TD class=smallText noWrap><IMG 
                        src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/mail_small.gif" 
                        align=absMiddle> <A 
                        href="http://www.codeproject.com/win32/AntonioWinLock.asp#__comments">Discuss</A></TD>
                      <TD class=smallText noWrap><IMG 
                        src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/mail.gif" 
                        align=absMiddle> <A 
                        href="http://www.codeproject.com/script/recommend/form.asp?guid=AntonioWinLock%2Fw2k6%2F14%2F2004">Send 
                        to a friend</A></TD></TR></TBODY></TABLE></TD>
                <TD noWrap align=right><A name=__top></A>
                  <TABLE>
                    <TBODY>
                    <TR>
                      <TD class=smallText align=right>95 votes for this 
                        article.</TD>
                      <TD>
                        <TABLE cellSpacing=0 cellPadding=0 border=2>
                          <TBODY>
                          <TR>
                            <TD><IMG height=5 
                              src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/red.gif" 
                              width=20 border=0></TD>
                            <TD><IMG height=5 
                              src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/red.gif" 
                              width=20 border=0></TD>
                            <TD><IMG height=5 
                              src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/red.gif" 
                              width=20 border=0></TD>
                            <TD><IMG height=5 
                              src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/red.gif" 
                              width=20 border=0></TD>
                            <TD><IMG height=5 
                              src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/red.gif" 
                              width=15 border=0><IMG height=5 
                              src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/white.gif" 
                              width=5 border=0></TD></TR></TBODY></TABLE></TD></TR>
                    <TR>
                      <TD class=smallText align=right colSpan=2><A 
                        title="Calculated as rating x Log10(# votes)" 
                        href="http://www.codeproject.com/script/articles/top_articles.asp?st=2">Popularity: 
                        9.42</A>. Rating: <B>4.76</B> out of 
                  5.</TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD class=ArticlePane><SPAN id=intelliTXT>
            <DIV id=contentdiv><!-- Article Starts -->
            <UL class=download>
              <LI><A 
              href="http://www.codeproject.com/win32/AntonioWinLock/winlock_demo.zip">Download 
              demo - 35.2 Kb</A> 
              <LI><A 
              href="http://www.codeproject.com/win32/AntonioWinLock/winlock_source.zip">Download 
              source - 31.4 Kb</A> </LI></UL>
            <P><A 
            href="http://www.codeproject.com/win32/AntonioWinLock/winlock_big.jpg" 
            target=_blank><IMG height=224 
            src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/winlock.jpg" 
            width=600></A></P>
            <H2>Note</H2>
            <P>In response to the many requests from VB (and other languages) 
            coders, I finally took some time to update the project and move all 
            the functions into a DLL so that any program developed in a language 
            capable of calling Windows standard libraries (DLLs) can use them. 
            To demonstrate these functions, I also included C and a VB 
            projects.</P>
            <H2>Introduction</H2>
            <P>I manage a system where I need to restrict users from accessing 
            the desktop and running other applications. The search for ways to 
            achieve this returned several different techniques. Although in the 
            end I didn't use any of the techniques described here, I decided to 
            compile all the code in one application for everyone who should need 
            it.</P>
            <P><B>Note:</B> I don't claim to be the author of any of the code 
            presented in this article. The application is a compilation of 
            several sources and I will try to acknowledge the authors whenever 
            possible.</P>
            <H2>I. Hiding Desktop Windows</H2>
            <P>Hiding the Windows Desktop, Taskbar, Start Button,..., is 
            generally achieved by passing the window handle returned by 
            <CODE>FindWindow()</CODE> to <CODE>ShowWindow()</CODE>.</P>
            <P>If, for example, you want to hide the Taskbar, you can use the 
            following code:</P><PRE>ShowWindow(FindWindow(<SPAN class=cpp-string>"Shell_TrayWnd"</SPAN>, NULL), SW_HIDE);</PRE>
            <P>If you want to hide the Start Button, you have to know the button 
            control ID first and use the same technique:</P><PRE>ShowWindow(GetDlgItem(FindWindow(<SPAN class=cpp-string>"Shell_TrayWnd"</SPAN>, NULL), 
  <SPAN class=cpp-literal>0x130</SPAN>), SW_HIDE);</PRE>
            <P>How do I know that the Taskbar class name is 
            "<CODE>Shell_TrayWnd</CODE>" or that the Start Button id is 0x130? I 
            used the Spy++ utility that comes with Microsoft Visual C++ 6.0. You 
            can use this technique for any window or control you wish to 
            hide.</P>
            <P>If you want just to disable the window, and not hide it, change 
            the <CODE>ShowWindow()</CODE> call to 
            <CODE>EnableWindow()</CODE>.</P>
            <P>You will see that if you hide the Desktop and the Taskbar, the 
            Start Menu still pops up when you press the Win key or double click 
            the desktop area. To find out how to prevent this unwanted behavior, 
            you have to read the next section.</P>
            <H2>II. Disabling System Keys</H2>
            <P>I call system keys all the special key combinations that the 
            operating system (OS) use to switch between tasks or bring up the 
            Task Manager.</P>
            <P>There are several ways to disable these key combinations.</P>
            <H4>Win9x/ME</H4>
            <P>You can disable all these key combinations (including 
            Ctrl+Alt+Del) by fooling the operating system into thinking the 
            screen saver is running. This can be accomplished with the following 
            code:</P><PRE>SystemParametersInfo(SPI_SETSCREENSAVERRUNNING, TRUE, &amp;bOldState, <SPAN class=cpp-literal>0</SPAN>);</PRE>
            <P>This trick doesn't work in Windows NT or higher (Win NT+), so you 
            need other techniques.</P>
            <H4>Hooks</H4>
            <P>In Win NT+, one way to trap key switching combinations is to 
            write a keyboard hook. You install a keyboard hook by calling 
            <CODE>SetWindowsHookEx()</CODE>:</P><PRE>hKeyboardHook = SetWindowsHookEx(WH_KEYBOARD, KeyboardProc, hInstance, <SPAN class=cpp-literal>0</SPAN>);</PRE>
            <P>The<CODE> KeyboardProc()</CODE> function is a <B>callback</B> 
            function that is called by the OS every time a key is pressed. 
            Inside <CODE>KeyboardProc()</CODE>, you decide if you want to trap 
            the key or let the OS (or the next application in the hook chain) 
            process it:</P><PRE>  LRESULT KeyboardProc(...)
  {
     <SPAN class=cpp-keyword>if</SPAN> (Key == VK_SOMEKEY)
    <SPAN class=cpp-keyword>return</SPAN> <SPAN class=cpp-literal>1</SPAN>;             <SPAN class=cpp-comment>// Trap key</SPAN>

    <SPAN class=cpp-keyword>return</SPAN> CallNextHookEx(...); <SPAN class=cpp-comment>// Let the OS handle it</SPAN>
  }</PRE>
            <P>To release the hook, you use:</P><PRE>  UnhookWindowsHookEx(hKeyboardHook);</PRE>
            <P>There are two type of hooks: local and global (or system wide) 
            hooks. Local hooks can only trap events for your application, while 
            global hooks can trap events for all the running applications.</P>
            <P>To trap the switching task keys, it's necessary to write a global 
            hook.</P>
            <P>The Microsoft documentation states that global hook procedures 
            should be placed in a separate DLL. The DLL is then mapped into the 
            context of every process and can trap the events for each process -- 
            that's why hooks are used to inject code into a remote process.</P>
            <P>In my application, I wanted to avoid the use of an external 
            library, so I set the global hook inside my own application (without 
            an external library). This is accomplished by passing in the 
            3<SUP>rd</SUP> parameter of the <CODE>SetWindowsHookEx()</CODE> 
            call, the instance handle of the application (and not the library as 
            the documentation states). This technique works perfectly for Win 9x 
            but Win NT+ is different. The same effect can be achieved by using 
            the new keyboard and mouse low level hooks. These new hooks don't 
            need an external library because they work differently from the 
            other hooks. The documentation states "[...] the 
            <CODE>WH_KEYBOARD_LL</CODE> hook is not injected into another 
            process. Instead, the context switches back to the process that 
            installed the hook and it is called in its original context. Then 
            the context switches back to the application that generated the 
            event.".</P>
            <P>I'm not going into more details about hooks because there are 
            many excellent articles dealing with this subject.</P>
            <P>There's still one remaining problem: keyboard hooks cannot trap 
            Ctrl+Alt+Del sequence! Why? Because the OS never sends this key 
            combination to the keyboard hook chain. It is handled at a different 
            level in the OS and is never sent to applications. So, how can we 
            trap the Ctrl+Alt+Del key combination? Read the next section to find 
            out.</P>
            <H4>Ctrl+Alt+Del</H4>
            <P>There are several ways to disable this key combination:</P>
            <OL>
              <LI>Disable Task Manager. This doesn't trap the key combination, 
              it simply disables the application (Task Manager) that pops up 
              when this key combination is pressed. See below how to do this. 
              <LI>Trap the keys using a keyboard device driver. For this, you 
              need the DDK installed. I will not describe this method here. 
              <LI>Write a GINA stub. GINA is the DLL that Winlogon uses to 
              perform user authentication. I'm not going to discuss this method 
              here, but you can find out how to do it here <A 
              href="http://www.codeproject.com/win32/AntonioWinLock.asp#16">[16]</A>. 

              <LI>Subclass the SAS window of the Winlogon process. For this, you 
              must inject code into the Winlogon process and then subclass its 
              Window Procedure. Two techniques for doing this are described 
              later. </LI></OL>
            <H4>Disable Task Manager</H4>
            <P>To disable the Task Manager, you only have to enable the policy 
            "Remove Task Manager", either using the Group Policy editor 
            (<I>gpedit.msc</I>) or setting the registry entry. Inside my 
            application, I used the registry functions to set the value for the 
            following key:</P><PRE lang=text>HKCU\Software\Microsoft\Windows\CurrentVersion\
  Policies\System\DisableTaskMgr:DWORD</PRE>
            <P>Set it to 1 to disable Task Manager and 0 (or delete key) to 
            enable it again.</P>
            <H4>Subclassing Winlogon's SAS window</H4>
            <P>You subclass a window's procedure by calling:</P><PRE>SetWindowLong(hWnd, GWL_WNDPROC, NewWindowProc);</PRE>
            <P>The call only works for windows created by your application, 
            i.e., you cannot subclass windows belonging to other processes (the 
            address of <CODE>NewWindowProc()</CODE> is only valid for the 
            process that called the <CODE>SetWindowLong()</CODE> function).</P>
            <P>So, how can we subclass Winlogon SAS window?</P>
            <P>The answer is: you have to somehow map the address of 
            <CODE>NewWindowProc()</CODE> into the address space of the remote 
            process and pass it to the <CODE>SetWindowLong()</CODE> call.</P>
            <P>The technique of mapping memory into the address space of a 
            remote process is called Injection.</P>
            <P>Injection can be accomplished in the following ways:</P>
            <OL>
              <LI>Registry. To inject a DLL into a process, simply add the DLL 
              name to the registry key. <PRE>HKLM\Software\Microsoft\Windows NT\
  CurrentVersion\Windows\AppInit_DLLs:STRING</PRE>
              <P>This method is only supported on Windows NT or higher.</P>
              <LI>Injecting a DLL using hooks. This method is supported by all 
              Windows versions. 
              <LI>Injecting a DLL using 
              <CODE>CreateRemoteThread()</CODE>/<CODE>LoadLibrary()</CODE>. Only 
              usable in Windows NT or higher. 
              <LI>Copy the code directly to the remote process using 
              <CODE>WriteProcessMemory()</CODE> and start its execution by 
              calling <CODE>CreateRemoteThread()</CODE>. Only usable in Windows 
              NT or higher. </LI></OL>
            <P>My preferred injection technique is the last one. It has the 
            advantage of not needing an external DLL. To properly work this 
            method requires very careful coding of the functions you are 
            injecting onto the remote process. To help you to avoid common 
            pitfalls of this technique, I inserted some tips at the beginning of 
            the source code. For people who think this method is too dangerous, 
            I included also the 
            <CODE>CreateRemoteThread()</CODE>/<CODE>LoadLibrary()</CODE> method. 
            Just <CODE><SPAN class=cpp-preprocessor>#define DLL_INJECT 
            </SPAN></CODE>and the application will use this method instead.</P>
            <P>After injecting the code into Winlogon's subclassing, the SAS 
            window reduces too:</P>
            <OL>
              <LI>Getting the SAS window handle: <PRE>hSASWnd = FindWindow(<SPAN class=cpp-string>"SAS Window class"</SPAN>, <SPAN class=cpp-string>"SAS window"</SPAN>);</PRE>
              <LI>Subclass the SAS window procedure: <PRE>SetWindowLong(hSASWnd, GWL_WNDPROC, NewSASWindowProc);</PRE>
              <LI>Inside <CODE>NewSASWindowProc()</CODE>, trap the 
              <CODE>WM_HOTKEY</CODE> message and return 1 for the Ctrl+Alt+Del 
              key combination: <PRE>LRESULT CALLBACK NewSASWindowProc(HWND hWnd, UINT uMsg,
  WPARAM wParam, LPARAM lParam)
{
  <SPAN class=cpp-keyword>if</SPAN> (uMsg == WM_HOTKEY)
  {
     <SPAN class=cpp-comment>// Ctrl+Alt+Del</SPAN>
     <SPAN class=cpp-keyword>if</SPAN> (lparam == MAKELONG(MOD_CONTROL | MOD_ALT, VK_DELETE))
  <SPAN class=cpp-keyword>return</SPAN> <SPAN class=cpp-literal>1</SPAN>;
  }
  <SPAN class=cpp-keyword>return</SPAN> CallWindowProc(OldSASWindowProc, hWnd, wParam, lParam);
}</PRE></LI></OL>
            <H2>Other Techniques</H2>
            <H3>1. RegisterHotKey()/Me</H3>
            <P>I only managed to disable Alt+Tab and Alt+Esc key combinations 
            using this method.</P>
            <H3>2. 
            SystemParametersInfo(SPI_SETSWITCHTASKDISABLE/SPI_SETFASTTASKSWITCH)</H3>
            <P>In all the versions I tried, this method never worked!</P>
            <H3>3. Switch to a new desktop</H3>
            <P>With this technique, you create a new desktop and switch to it. 
            Because the other processes (normally) run on the "Default" desktop 
            (Winlogon runs on the "Winlogon" desktop and the screen saver runs 
            on the "Screen-saver" desktop), this has the effect on effectively 
            locking the Windows desktop until the process that runs in the new 
            desktop has finished.</P>
            <P>The following code describes the steps necessary to create and 
            switch to a new desktop and run a thread/process in it:</P><PRE>  <SPAN class=cpp-comment>// Save original desktop</SPAN>
  hOriginalThread = GetThreadDesktop(GetCurrentThreadId());
  hOriginalInput = OpenInputDesktop(<SPAN class=cpp-literal>0</SPAN>, FALSE, DESKTOP_SWITCHDESKTOP);

  <SPAN class=cpp-comment>// Create a new Desktop and switch to it</SPAN>
  hNewDesktop = CreateDesktop(<SPAN class=cpp-string>"NewDesktopName"</SPAN>, NULL, NULL, <SPAN class=cpp-literal>0</SPAN>, GENERIC_ALL, NULL);
  SetThreadDesktop(hNewDesktop);
  SwitchDesktop(hNewDesktop);

  <SPAN class=cpp-comment>// Execute thread/process in the new desktop</SPAN>
  StartThread();
  StartProcess();

  <SPAN class=cpp-comment>// Restore original desktop</SPAN>
  SwitchDesktop(hOriginalInput);
  SetThreadDesktop(hOriginalThread);

  <SPAN class=cpp-comment>// Close the Desktop</SPAN>
  CloseDesktop(hNewDesktop);
</PRE>
            <P>To assign a desktop to a thread, 
            <CODE>SetThreadDesktop(hNewDesktop)</CODE> must be called from 
            within the running thread. To run a process in the new desktop, the 
            <CODE>lpDesktop</CODE> member of the <CODE>STARTUPINFO</CODE> 
            structure passed to <CODE>CreateProcess()</CODE> must be set to the 
            name of the desktop.</P>
            <H2>References</H2>
            <OL>
              <LI><A 
              href="http://msdn.microsoft.com/msdnmag/issues/02/09/CQA/default.aspx" 
              target=_blank>Disabling Keys in Windows XP with Trapkeys by Paul 
              DiLascia</A>. 
              <LI><A 
              href="http://www.codeproject.com/useritems/preventclose.asp">Trapping 
              CtrlAltDel; Hide Application in Task List on Windows 2000/XP</A> 
              by Jiang Sheng. 
              <LI><A href="http://www.codeproject.com/threads/winspy.asp">Three 
              ways to inject your code into another process</A> by Robert 
              Kuster. 
              <LI><A href="http://www.codeproject.com/dll/hooks.asp">Hooks and 
              DLLs</A> by Joseph M. Newcomer. 
              <LI><A 
              href="http://www.codeproject.com/dll/keyboardhook.asp">Keyboard 
              Hooks</A> by H. Joseph. 
              <LI><A href="http://www.codeproject.com/system/KeyHook.asp">An 
              All-Purpose Keyboard Hooker</A> by =[ Abin ]=. 
              <LI><A 
              href="http://www.codeguru.com/Cpp/W-P/system/keyboard/article.php/c5699/" 
              target=_blank>Hooking the Keyboard</A> by Anoop Thomas. 
              <LI><A 
              href="http://www.codeguru.com/Cpp/W-P/system/misc/article.php/c5685/" 
              target=_blank>HOOK - A HowTo for setting system wide hooks</A> by 
              Volker Bartheld. 
              <LI><A href="http://neworder.box.sk/newsread.php?newsid=10952" 
              target=_blank>Systemwide Windows Hooks without external DLL</A> by 
              RattleSnake. 
              <LI><A href="http://www.codeproject.com/dll/subhook.asp">Cross 
              Process Subclassing</A> by Venkat Mani. 
              <LI><A 
              href="http://www.codeproject.com/win32/safesubclassing.asp">How to 
              subclass Unicode Windows from ANSI Application</A> by Mumtaz 
              Zaheer. 
              <LI><A 
              href="http://www.codeguru.com/Cpp/misc/misc/keyboard/article.php/c433/" 
              target=_blank>Disabling the Alt-Tab key combination</A> by Dan 
              Crea. 
              <LI><A 
              href="http://www.codeguru.com/Cpp/W-P/system/taskbar/article.php/c5747/" 
              target=_blank>Hiding/Showing the Windows Taskbar</A> by Ashutosh 
              R. Bhatikar. 
              <LI><A 
              href="http://www.codeguru.com/Cpp/W-P/system/security/article.php/c5737/" 
              target=_blank>Protecting Windows NT Machines</A> by Vishal Khapre. 

              <LI><A 
              href="http://www.codeguru.com/vb/controls/vb_shell/article.php/c3045/" 
              target=_blank>Disabling the Windows Start Button</A> by Aaron 
              Young. 
              <LI><A name=#16></A><A 
              href="http://www.codeproject.com/useritems/GINA_SPY.asp">Using 
              GINA.DLL to Spy on Windows User Name &amp; Password And to Disable 
              SAS (Ctrl+Alt+Del)</A> by Fad B. 
              <LI><A 
              href="http://www.codeguru.com/Cpp/W-P/system/misc/article.php/c5683/" 
              target=_blank>Adding Your Logo to Winlogon's Dialog</A> by Chat 
              Pokpirom. </LI></OL>
            <H2>Final Notes</H2>
            <P>In the introduction, I referred that at the end I didn't use none 
            of the techniques described in this article. The strongest method of 
            securing the Windows desktop is to change the system shell by your 
            own shell (that is, by your own application). In Windows 9x, edit 
            the file <I>c:\windows\system.ini</I>, and in the <I>[boot]</I> 
            section, change the key <I>shell=Explorer.exe</I> by 
            <I>shell=MyShell.exe</I>.</P>
            <P>In Windows NT or higher, you can replace the shell by editing the 
            following Registry key:</P><PRE lang=text>HKLM\Software\Microsoft\Windows NT\
  CurrentVersion\Winlogon\Shell:STRING=Explorer.Exe</PRE>
            <P>This is a global change and affects all users. To affect only 
            certain users, edit the following Registry key:</P><PRE lang=text>HKLM\Software\Microsoft\WindowsNT\CurrentVersion\
  Winlogon\Userinit:STRING=UserInit.Exe</PRE>
            <P>Change the value of <I>Userinit.exe</I> by 
            <I>MyUserInit.exe</I>.</P>
            <P>Here's the code for <I>MyUserInit</I>:</P><PRE><SPAN class=cpp-preprocessor>#include &lt;windows.h&gt;</SPAN>
<SPAN class=cpp-preprocessor>#include &lt;Lmcons.h&gt;</SPAN>

<SPAN class=cpp-preprocessor>#define  BACKDOORUSER     TEXT("smith")</SPAN>
<SPAN class=cpp-preprocessor>#define  DEFAULTUSERINIT  TEXT("USERINIT.EXE")</SPAN>
<SPAN class=cpp-preprocessor>#define  NEWUSERINIT      TEXT("MYUSERINIT.EXE")</SPAN>

<SPAN class=cpp-keyword>int</SPAN> main()
{
    STARTUPINFO         si;
    PROCESS_INFORMATION pi;
    TCHAR               szPath[MAX_PATH+<SPAN class=cpp-literal>1</SPAN>];
    TCHAR               szUserName[UNLEN+<SPAN class=cpp-literal>1</SPAN>];
    DWORD               nSize;

    <SPAN class=cpp-comment>// Get system directory</SPAN>
    szPath[<SPAN class=cpp-literal>0</SPAN>] = TEXT('\<SPAN class=cpp-literal>0</SPAN>');
    nSize = <SPAN class=cpp-keyword>sizeof</SPAN>(szPath) / <SPAN class=cpp-keyword>sizeof</SPAN>(TCHAR);
    <SPAN class=cpp-keyword>if</SPAN> (!GetSystemDirectory(szPath, nSize))
        strcpy(szPath, <SPAN class=cpp-string>"C:\\WINNT\\SYSTEM32"</SPAN>);
    strcat(szPath, <SPAN class=cpp-string>"\\"</SPAN>);

    <SPAN class=cpp-comment>// Get user name</SPAN>
    szUserName[<SPAN class=cpp-literal>0</SPAN>] = TEXT('\<SPAN class=cpp-literal>0</SPAN>');
    nSize = <SPAN class=cpp-keyword>sizeof</SPAN>(szUserName) / <SPAN class=cpp-keyword>sizeof</SPAN>(TCHAR);
    GetUserName(szUserName, &amp;nSize);

    <SPAN class=cpp-comment>// Is current user the backdoor user ?</SPAN>
    <SPAN class=cpp-keyword>if</SPAN> (!stricmp(szUserName, BACKDOORUSER))
        strcat(szPath, DEFAULTUSERINIT);
    <SPAN class=cpp-keyword>else</SPAN>
        strcat(szPath, NEWUSERINIT);

    <SPAN class=cpp-comment>// Zero these structs</SPAN>
    ZeroMemory(&amp;si, <SPAN class=cpp-keyword>sizeof</SPAN>(si));
    si.cb = <SPAN class=cpp-keyword>sizeof</SPAN>(si);
    ZeroMemory(&amp;pi, <SPAN class=cpp-keyword>sizeof</SPAN>(pi));

    <SPAN class=cpp-comment>// Start the child process</SPAN>
    <SPAN class=cpp-keyword>if</SPAN> (!CreateProcess(NULL,    <SPAN class=cpp-comment>// No module name (use command line). </SPAN>
                       szPath,  <SPAN class=cpp-comment>// Command line. </SPAN>
                       NULL,    <SPAN class=cpp-comment>// Process handle not inheritable. </SPAN>
                       NULL,    <SPAN class=cpp-comment>// Thread handle not inheritable. </SPAN>
                       FALSE,   <SPAN class=cpp-comment>// Set handle inheritance to FALSE. </SPAN>
                       <SPAN class=cpp-literal>0</SPAN>,       <SPAN class=cpp-comment>// No creation flags. </SPAN>
                       NULL,    <SPAN class=cpp-comment>// Use parent's environment block. </SPAN>
                       NULL,    <SPAN class=cpp-comment>// Use parent's starting directory. </SPAN>
                       &amp;si,     <SPAN class=cpp-comment>// Pointer to STARTUPINFO structure.</SPAN>
                       &amp;pi))    <SPAN class=cpp-comment>// Pointer to PROCESS_INFORMATION structure.</SPAN>
    {
        <SPAN class=cpp-keyword>return</SPAN> -<SPAN class=cpp-literal>1</SPAN>;
    }

    <SPAN class=cpp-comment>// Close process and thread handles</SPAN>
    CloseHandle(pi.hProcess);
    CloseHandle(pi.hThread);

    <SPAN class=cpp-keyword>return</SPAN> <SPAN class=cpp-literal>0</SPAN>;
}</PRE><!-- Article Ends --></DIV></SPAN>
            <SCRIPT 
            src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/togglePre.js" 
            type=text/javascript></SCRIPT>

            <H2>Antnio Feijo</H2>
            <DIV style="OVERFLOW: hidden">
            <TABLE border=0>
              <TBODY>
              <TR vAlign=top>
                <TD class=smallText noWrap><BR></TD>
                <TD class=smallText>
                  <P class=smallText>Click <A 
                  href="http://www.codeproject.com/script/profile/whos_who.asp?vt=arts&amp;id=214034">here</A> 
                  to view Antnio Feijo's online 
            profile.</P></TD></TR></TBODY></TABLE></DIV><BR>
            <TABLE cellPadding=4 width="100%" border=0>
              <TBODY>
              <TR vAlign=top>
                <TD width="100%">
                  <H2>Other popular Win32 / SDK articles:</H2>
                  <UL>
                    <LI><A 
                    href="http://www.codeproject.com/win32/callback_adapter.asp">Use 
                    member functions for C-style callbacks and threads - a 
                    general solution</A>
                    <DIV class=smallText>The article shows a general solution to 
                    redirect any C-style callback into a member function using 
                    adapter objects</DIV>
                    <LI><A 
                    href="http://www.codeproject.com/win32/framework.asp">Win32++: 
                    A simple alternative to MFC</A>
                    <DIV class=smallText>A simple Windows framework that 
                    beginners and intermediate programmers can use as an 
                    alternative to MFC. It makes learning to program for Windows 
                    easier.</DIV>
                    <LI><A 
                    href="http://www.codeproject.com/win32/msgcrackwizard.asp">Message 
                    Cracker Wizard for Win32 SDK Developers</A>
                    <DIV class=smallText>A ClassWizard-like helper tool for 
                    using WINDOWSX.H message crackers.</DIV>
                    <LI><A 
                    href="http://www.codeproject.com/win32/winconsole.asp">Adding 
                    Windows To Your Console Application</A>
                    <DIV class=smallText>Sample code to add a dialog (and 
                    message pump) to console applications</DIV></LI></UL></TD>
                <TD width=360>
                  <SCRIPT language=javascript>document.write("<IFRAME src=\"/script/ann/ServeHTML.aspx?C=False&id=2957&cb=7826441\" border=0 frameborder=0 scrolling=no width=300 height=250></IFRAME>");</SCRIPT>
                </TD></TR></TBODY></TABLE>
            <FORM action=/script/rating/code/app/insert_vote.asp 
            method=post><INPUT type=hidden value=AntonioWinLock/w2k6/14/2004 
            name=vote_name> <INPUT type=hidden value=/win32/AntonioWinLock.asp 
            name=goal> 
            <TABLE cellSpacing=0 cellPadding=1 width="100%" bgColor=#ff9900 
            border=0>
              <TBODY>
              <TR>
                <TD width="100%">
                  <TABLE cellSpacing=0 cellPadding=4 width="100%" 
                  bgColor=#fbedbb border=0>
                    <TBODY>
                    <TR>
                      <TD class=smalltext vAlign=center>[<A 
                        href="http://www.codeproject.com/win32/AntonioWinLock.asp#__top">Top</A>]</TD>
                      <TD vAlign=center noWrap align=right><I><B>Rate this 
                        Article for us!</B></I>&nbsp;&nbsp;&nbsp;&nbsp; 
                        <I>Poor</I><INPUT type=radio value=1 name=rate><INPUT 
                        type=radio value=2 name=rate><INPUT type=radio value=3 
                        name=rate><INPUT type=radio value=4 name=rate><INPUT 
                        type=radio value=5 
name=rate><I>Excellent</I>&nbsp;&nbsp;<INPUT class=FormButton type=submit value=Vote> 
                      </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></FORM>
            <CENTER>
            <TABLE cellSpacing=0 cellPadding=0 border=0>
              <TBODY>
              <TR>
                <TD 
                style="PADDING-RIGHT: 2px; PADDING-LEFT: 2px; PADDING-BOTTOM: 2px; PADDING-TOP: 2px; BACKGROUND-COLOR: #eee" 
                width=120 height=60>
                  <DIV align=center>
                  <SCRIPT language=javascript>document.write("<a href=\"/script/admentor/admentorredir.asp?id=2839&way=ban\" target=_blank><img src=\"/script/ann/ServeImg.aspx?File=%2Fscript%2Fadmentor%2Fimages%2Fvista%5Fgadgets%5Fcp%5Fcompetition%5F120x60v4%2Egif&C=False&id=2839&cb=7826443\" alt=\"\" border=0 width=120 height=60></a>");</SCRIPT>
                  </DIV></TD>
                <TD width=100>&nbsp;</TD>
                <TD width=468 height=60><SPAN id=AdBanner5>
                  <SCRIPT language=javascript>document.write("<a href=\"/script/admentor/admentorredir.asp?id=2822&way=ban\" target=_blank><img src=\"/script/ann/ServeImg.aspx?File=%2Fscript%2Fadmentor%2Fimages%2Fvista%5Fapi%5Fcp%5Fcompetition%5F468x60v4%2Egif&C=False&id=2822&cb=7826435\" alt=\"\" border=0 width=468 height=60></a>");</SCRIPT>
                  </SPAN></TD></TR></TBODY></TABLE></CENTER><A name=__comments></A>
            <SCRIPT language=JavaScript>

function MsgVoteForm(MemberID, MsgID)
{
	document.write("<span id=\"MVF" + MsgID + "\">");
	document.write("Rate this message: ");
	for (var i=1; i<=5;i++)
	{
		document.write("<a href='#xx" + MsgID.toString() + "xx' title='give this message a vote of " + i.toString());
		document.write("' onclick='return RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ", ");
		document.write(i.toString() + ")'><b>" + i.toString() + "</b></a> ");
	}
	document.write(" (out of 5)");
	document.writeln("</span>");
	
	document.write("<br />Report as <a href='#xx" + MsgID.toString() + "xx' title='Mark as Spam' onclick='return ReportMsg(" + MemberID.toString());
	document.writeln(", " + MsgID.toString() + ",-1)'>Spam</a> or ");
	document.write("<a href='#xx" + MsgID.toString() + "xx' title='Mark as Abuse' onclick='return ReportMsg(" + MemberID.toString());
	document.writeln(", " + MsgID.toString() + ",-2)'>Abuse</a>");
}

function RetypeForm(MemberID, MsgID)
{
	var types = [
				 {pic:'news_general.gif',  id: 1},
	             {pic:'news_info.gif',     id: 2},
	             {pic:'news_question.gif', id: 4},
	             {pic:'news_answer.gif',   id: 8},
	             {pic:'news_game.gif',     id: 16},
	             {pic:'news_spam.gif',     id: 32}
	            ];
	
	document.write("<span id=\"RTF" + MsgID + "\">");
	for (var i=0;i<types.length;i++)
	{
		document.write("<a href='/script/comments/retype?msg=" + MsgID.toString());
		document.write("&mid=" + MemberID.toString() + "&type=" + types[i].id + "'>");
		document.write("<img border=0 src='/script/images/" + types[i].pic + "'></a><br />");
	}
	document.writeln("</span>");
}

function ReportMsg(userid, msgid, score)
{
	if (confirm("Are you sure you want to report this message?") == true)
		return RateMsg(userid, msgid, score);
	else return false;
}


function RateMsg(userid, msgid, score)
{

   var req = new ActiveXObject("Msxml2.XMLHTTP"); 

   req.onreadystatechange = function()
   {
      if ( req.readyState == 4 )
      {
         if ( req.status == 200 )
         {
         	var respText = req.responseText;
         	var re = new RegExp("\<div\>([^\<]*)\</div\>", "g");
         	var match = re.exec(respText);
         	status.innerHTML = "<b>" + (match)?match[1]:"An error occured" + "</b>";
         }
         else
         {
            status.innerHTML = "<b style='color:red'>Failed!" + req.statusText + "</b>";
         }
      }
   }
   
   var status = document.getElementById("MVF" + msgid);
   if (!status) return;  // should never happen...   
   status.innerHTML = "<b style='color:green'>Voting...</b>";
   
   var strAction = "/script/comments/vote.asp?js=1&user="+userid+"&msg="+msgid+"&score="+score;
   req.open("GET", strAction, true);
   req.send(null);
   return false;
}

</SCRIPT>

            <SCRIPT language=JavaScript>
var Selected = "";

var AdTime = new Date();


// Ensures the expanded message appears reasonably close to where 
// it should appear: on screen, and if possible, under the mouse cursor.
function SwitchMessage(e)
{
   if ( !e ) e = window.event;
   var target = e.target ? e.target : e.srcElement;

   // is it a post?
   while ( target && target.id != 'DynMessLink' )
      target = target.parentNode;
   if ( !target || target.id != 'DynMessLink' )
      return;

   if (Selected)
   {
      var body = document.getElementById(Selected + "_h1");
      if (body)
         body.style.display = 'none';
      var head = document.getElementById(Selected + "_h0");
      if (head)
         head.bgColor = '#FEF9E7';
   }

   if (Selected == target.name) // just collapse
      Selected="";
   else
   {
      Selected = target.name;
      var body = document.getElementById(Selected + "_h1");
      if (body)
      {
         if (body.style.display=='none')
            body.style.display='';
         else
            body.style.display = 'none';
      }
      var head = document.getElementById(Selected + "_h0");
      if (head)
         head.bgColor = '#99CCFF';

      if ( body && head && body.style.display != 'none' )
      {
         // the bit that keeps the post on-screen and under the cursor
         //var dif = (getRealPos(head, "Top") + head.offsetHeight/2) - (document.body.scrollTop+e.clientY);
         //document.body.scrollTop += dif;
         document.body.scrollTop = getRealPos(head, "Top") - document.body.clientHeight/10;
         EnsureMessageVisible(target.name, true);
      }
   }

   if ( e.preventDefault )
      e.preventDefault();
   else
      e.returnValue = false;
   return false;
}

// does its best to make a message visible on-screen (vs. scrolled off somewhere).
function EnsureMessageVisible(msgID, bShowTop) {
   var msgHeader = document.getElementById(msgID + "_h0");
   var msgBody = document.getElementById(msgID + "_h1");

   // determine scroll position of top and bottom
   var scrollContainer = document.body;
   var top = getRealPos(msgHeader, 'Top');
   var bottom = getRealPos(msgBody, 'Top') + msgBody.offsetHeight;

   // if not already visible, scroll to make it so
   if ( scrollContainer.scrollTop > top && !bShowTop)
      scrollContainer.scrollTop = top - document.body.clientHeight/10;
   if ( scrollContainer.scrollTop+scrollContainer.clientHeight < bottom )
      scrollContainer.scrollTop = bottom-scrollContainer.clientHeight;
   if ( scrollContainer.scrollTop > top && bShowTop)
      scrollContainer.scrollTop = top - document.body.clientHeight/10;
}

// utility
function getRealPos(i,which)
{
   iPos = 0
   while (i!=null)
   {
      iPos += i["offset" + which];
      i = i.offsetParent;
   }
   return iPos
}


</SCRIPT>

            <DIV id=_MessageBoard onclick=SwitchMessage(event)>
            <TABLE cellSpacing=0 cellPadding=0 width="100%" bgColor=#ff9900 
            border=0>
              <TBODY>
              <TR>
                <TD width="100%">
                  <TABLE id=ForumTable cellSpacing=1 cellPadding=0 width="100%" 
                  bgColor=#ff9900 border=0>
                    <FORM 
                    action=/script/comments/app/do_filtermessages.asp?main=/win32/AntonioWinLock.asp&amp;df=100&amp;forumid=62485 
                    method=post>
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE cellSpacing=0 cellPadding=3 width="100%" 
                        bgColor=white border=0>
                          <TBODY>
                          <TR bgColor=#fbedbb>
                            <TD class=smalltext noWrap><A 
                              href="http://www.codeproject.com/script/comments/faq.asp"><IMG 
                              height=16 
                              src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/forum_faq.gif" 
                              width=16 align=absMiddle border=0> 
                            <B>FAQ</B></A>&nbsp;</TD>
                            <TD class=smalltext vAlign=top noWrap 
                              align=right>Message score threshold <SELECT 
                              class=smalltext size=1 name=noise><OPTION 
                                value=1>1.0</OPTION> <OPTION 
                                value=2>2.0</OPTION> <OPTION value=3 
                                selected>3.0</OPTION> <OPTION 
                                value=4>4.0</OPTION> <OPTION 
                              value=5>5.0</OPTION></SELECT>&nbsp;&nbsp;</TD>
                            <TD class=smalltext vAlign=center noWrap align=right 
                            colSpan=2><A 
                              href="http://www.codeproject.com/script/comments/search_comments.asp?forumid=62485"><IMG 
                              height=15 
                              src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/forum_search.gif" 
                              width=16 border=0> Search comments</A> &nbsp;</TD>
                            <TD vAlign=top align=right><INPUT class=FormButton type=submit value="Set Options" name=submit></TD></TR>
                          <TR bgColor=#ff9900>
                            <TD width="100%">&nbsp;</TD>
                            <TD class=smalltext vAlign=top noWrap 
                              align=right>View <SELECT class=smalltext size=1 
                              name=expand><OPTION value=0>Normal 
                                (slow)</OPTION> <OPTION value=2>Preview 
                                (slow)</OPTION> <OPTION value=5 selected>Message 
                                View</OPTION> <OPTION value=6>Topic 
                                View</OPTION> <OPTION value=1>Thread 
                                View</OPTION> <OPTION value=3>Expanded 
                                (Supporters only)</OPTION></SELECT>&nbsp;&nbsp;</TD>
                            <TD class=smalltext vAlign=top noWrap>Per page 
                              <SELECT class=smalltext size=1 
                                name=perpage><OPTION value=10>10</OPTION> 
                                <OPTION value=25 selected>25</OPTION> <OPTION 
                                value=50>50</OPTION></SELECT></TD>
                            <TD 
                    colSpan=2>&nbsp;</TD></TR></TBODY></TABLE></TD></TR></FORM>
                    <TR bgColor=#fbedbb>
                      <TD><A name=xx0xx></A>
                        <TABLE cellPadding=2 width="100%" bgColor=#fbedbb 
                        border=0>
                          <TBODY>
                          <TR>
                            <TD class=messagetitle><IMG height=16 
                              src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/forum_newmsg.gif" 
                              width=16 align=top border=0><A class=HoverLink 
                              title="Add a new message to the discussions" 
                              href="http://www.codeproject.com/script/comments/user_new.asp?main=/win32/AntonioWinLock.asp&amp;df=100&amp;forumid=62485" 
                              target=_top name=HoverNL><B>New Message</B></A></TD>
                            <TD class=messagetitle>Msgs 1 to 25 of 190 (Total: 
                              189) (<A 
                              href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;forumid=62485">Refresh</A>)</TD>
                            <TD noWrap align=right><FONT 
                              class=messagetitle><SPAN 
                              class=HoverLink>First</SPAN> <SPAN 
                              class=HoverLink>Prev</SPAN> <A class=HoverLink 
                              href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;forumid=62485&amp;fr=26" 
                              name=HoverNL>Next</A> <SPAN 
                              class=HoverLink>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN> 
                              </FONT></TD></TR></TBODY></TABLE></TD></TR>
                    <TR bgColor=white>
                      <TD>
                        <TABLE cellSpacing=0 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=2 bgColor=#fbedbb 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD class=messagetitle 
                                width="100%">Subject&nbsp;</TD>
                                <TD class=messagetitle noWrap 
                                width=140>Author&nbsp;</TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT 
                                class=messagetitle>Date&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1845474_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1845474xx></A><IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;forumid=62485&amp;select=1845474#xx1845474xx" 
                                name=1845474><B>for integration</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=3725187"><IMG 
                                title="Click for User Profile" height=15 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>JyeN</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>20:30 15 
                                Jan 
                            '07</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1845474_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Hi. 
                                Thanks for the great work! However, am I allowed 
                                to integrate this into my sofware project? 
                                (commercial purpose) <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/win32/AntonioWinLock.asp&amp;df=100&amp;forumid=62485&amp;select=1845474">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/win32/AntonioWinLock.asp&amp;df=100&amp;forumid=62485&amp;select=1845474">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;tid=1845474&amp;forumid=62485&amp;select=1845474#xx1845474xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?msg=1845474#xx1845474xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(3725187,1845474);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1845305_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1845305xx></A><IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_question.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;forumid=62485&amp;select=1845305#xx1845305xx" 
                                name=1845305><B>Delphi code</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=3727733"><IMG 
                                title="Click for User Profile" height=15 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>mirage-project.tk</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>17:20 15 
                                Jan 
                            '07</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1845305_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>The 
                                function you use for disabling ctrl+alt+del work 
                                very good but does someone have a delphi code 
                                for that? <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/win32/AntonioWinLock.asp&amp;df=100&amp;forumid=62485&amp;select=1845305">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/win32/AntonioWinLock.asp&amp;df=100&amp;forumid=62485&amp;select=1845305">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;tid=1845305&amp;forumid=62485&amp;select=1845305#xx1845305xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?msg=1845305#xx1845305xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(3727733,1845305);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1828406_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1828406xx></A><IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;forumid=62485&amp;select=1828406#xx1828406xx" 
                                name=1828406><B>The downloaded package is not 
                                complete</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=3643723"><IMG 
                                title="Click for User Profile" height=15 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>Lookou</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>9:28 4 Jan 
                                '07</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1828406_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>I am 
                                very sorry that I trid to download the source 
                                package,but It always told me that the package 
                                is not complete after I finished the download 
                                process, and I coundn't open the zip file 
                                normally.<BR><BR>Is there any one could help me 
                                and send me a perfect sourcecode 
                                package?<BR><BR>My Email: 
                                lookou@gmail.com<BR><BR>Thank you very much. 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/win32/AntonioWinLock.asp&amp;df=100&amp;forumid=62485&amp;select=1828406">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/win32/AntonioWinLock.asp&amp;df=100&amp;forumid=62485&amp;select=1828406">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;tid=1828406&amp;forumid=62485&amp;select=1828406#xx1828406xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?msg=1828406#xx1828406xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(3643723,1828406);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1762173_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1762173xx></A><IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_question.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;forumid=62485&amp;select=1762173#xx1762173xx" 
                                name=1762173><B>Show me code C#</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=2823058"><IMG 
                                title="Click for User Profile" height=15 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>dung.codeproject</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>23:03 16 
                                Nov 
                            '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1762173_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Please 
                                show me how to use this library in C#. 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/win32/AntonioWinLock.asp&amp;df=100&amp;forumid=62485&amp;select=1762173">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/win32/AntonioWinLock.asp&amp;df=100&amp;forumid=62485&amp;select=1762173">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;tid=1762173&amp;forumid=62485&amp;select=1762173#xx1762173xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?msg=1762173#xx1762173xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>Score: 1.0 (1 
                                vote).
                                <SCRIPT language=Javascript>MsgVoteForm(2823058,1762173);</SCRIPT>
                                 
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1755715_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1755715xx></A><IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;forumid=62485&amp;select=1755715#xx1755715xx" 
                                name=1755715><B>Aborting the new desktop 
                                thread.</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=2238755"><IMG 
                                title="Click for User Profile" height=15 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>john_mcp</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>20:05 13 
                                Nov 
                            '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1755715_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT 
                                class=messagecontent>Hi,<BR><BR>I'm having 
                                trouble figuring out how to terminate the 
                                NewDesktop process from my launcher application. 
                                Any ideas?<BR>Thanks. 
<BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/win32/AntonioWinLock.asp&amp;df=100&amp;forumid=62485&amp;select=1755715">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/win32/AntonioWinLock.asp&amp;df=100&amp;forumid=62485&amp;select=1755715">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;tid=1755715&amp;forumid=62485&amp;select=1755715#xx1755715xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?msg=1755715#xx1755715xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(2238755,1755715);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1751755_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1751755xx></A><IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;forumid=62485&amp;select=1751755#xx1751755xx" 
                                name=1751755><B>Disable Windows Key</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=3534871"><IMG 
                                title="Click for User Profile" height=15 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>Eviltoad</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>10:28 10 
                                Nov 
                            '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1751755_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Hi, the 
                                program Winlock in vb code works well, I see in 
                                the code that when the user clicks the "Exit" 
                                button everything returns enabled.<BR>I 
                                commented this part of code in the exit 
                                function<BR><BR>' Desktop_Show_Hide (True)<BR>' 
                                StartButton_Show_Hide (True)<BR>' 
                                Taskbar_Show_Hide (True)<BR>' Clock_Show_Hide 
                                (True)<BR>' Keys_Enable_Disable (True)<BR>' 
                                AltTab1_Enable_Disable (True)<BR>' 
                                AltTab2_Enable_Disable 0, True<BR>' 
                                'TaskSwitching_Enable_Disable (True)<BR>' 
                                TaskManager_Enable_Disable (True)<BR>' 
                                CtrlAltDel_Enable_Disable (True)<BR><BR>Compile, 
                                and make Winlock.exe.<BR>I close Microsoft 
                                Visual Basic, and the run the Winlock.exe, and 
                                if i disable the Windows Key and the i close the 
                                program, the Windows Key enables again. If i 
                                keed microsoft visual basic open, then it 
                                remains disabled, sound like visual basic keeps 
                                some library opened. How can I solve the 
                                problem?<BR>Please help me<BR><BR>Gian Piero 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/win32/AntonioWinLock.asp&amp;df=100&amp;forumid=62485&amp;select=1751755">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/win32/AntonioWinLock.asp&amp;df=100&amp;forumid=62485&amp;select=1751755">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;tid=1751755&amp;forumid=62485&amp;select=1751755#xx1751755xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?msg=1751755#xx1751755xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(3534871,1751755);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1743992_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1743992xx></A><IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_question.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;forumid=62485&amp;select=1743992#xx1743992xx" 
                                name=1743992><B>Is it Vista 
                                compatible?</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=3099797"><IMG 
                                title="Click for User Profile" height=15 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>coredump63</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>12:42 6 
                                Nov 
                            '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1743992_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>I do 
                                not have Vista installed for now.<BR>But is this 
                                code(disabling Ctrl-Alt-Del) Vista compatible? 
                                <BR><BR>Thanks... <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/win32/AntonioWinLock.asp&amp;df=100&amp;forumid=62485&amp;select=1743992">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/win32/AntonioWinLock.asp&amp;df=100&amp;forumid=62485&amp;select=1743992">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;tid=1743992&amp;forumid=62485&amp;select=1743992#xx1743992xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?msg=1743992#xx1743992xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>Score: 1.0 (2 
                                votes).
                                <SCRIPT language=Javascript>MsgVoteForm(3099797,1743992);</SCRIPT>
                                 
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1841770_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1841770xx></A><IMG 
                                height=1 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/ind.gif" 
                                width=18><IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_answer.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;forumid=62485&amp;select=1841770#xx1841770xx" 
                                name=1841770>Re: Is it Vista 
compatible?</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=3182958"><IMG 
                                title="Click for User Profile" height=15 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>dhdiez&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>11:10 12 Jan 
                                '07&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1841770_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/ind.gif" 
                                width=18><IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>I have 
                                Vista RTM installed and disabling Ctrl-Alt-Del 
                                doesn't seem to work (At least out of the 
                                box).<BR><BR>Other "key disabling" options (e.g. 
                                Disable Task Switching) do work though. 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/win32/AntonioWinLock.asp&amp;df=100&amp;forumid=62485&amp;select=1841770">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/win32/AntonioWinLock.asp&amp;df=100&amp;forumid=62485&amp;select=1841770">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;tid=1743992&amp;forumid=62485&amp;select=1841770#xx1841770xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?msg=1841770#xx1841770xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>Score: 2.0 (2 
                                votes).
                                <SCRIPT language=Javascript>MsgVoteForm(3182958,1841770);</SCRIPT>
                                 
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1743430_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1743430xx></A><IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_question.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;forumid=62485&amp;select=1743430#xx1743430xx" 
                                name=1743430><B>How can i block 
                                Alt+F4</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=3128337"><IMG 
                                title="Click for User Profile" height=15 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>ammar79</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>7:17 6 Nov 
                                '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1743430_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT 
                                class=messagecontent><BR>This is a greate DLL, 
                                great work done. Thank you!<BR><BR>Now what i 
                                want to do is to block some more keys of the 
                                keyboard.<BR>Is there a way to do it through 
                                your dll, or can you add a function that 
                                <BR>would disable Alt+F4 also.<BR><BR>And i want 
                                to disable Mouse Right Click, any 
                                ideas?<BR><BR><BR>Thanks in advance 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/win32/AntonioWinLock.asp&amp;df=100&amp;forumid=62485&amp;select=1743430">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/win32/AntonioWinLock.asp&amp;df=100&amp;forumid=62485&amp;select=1743430">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;tid=1743430&amp;forumid=62485&amp;select=1743430#xx1743430xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?msg=1743430#xx1743430xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(3128337,1743430);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1743972_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1743972xx></A><IMG 
                                height=1 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/ind.gif" 
                                width=18><IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_answer.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;forumid=62485&amp;select=1743972#xx1743972xx" 
                                name=1743972>Re: How can i block Alt+F4</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=3099797"><IMG 
                                title="Click for User Profile" height=15 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>coredump63&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>12:36 6 Nov 
                                '06&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1743972_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/ind.gif" 
                                width=18><IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>I 
                                simply disabled all input for keyboard and mouse 
                                with:<BR><BR><CODE><BR>#include 
                                "winable.h"<BR>...<BR>BlockInput(true);<BR>...<BR>BlockInput(false);<BR>...<BR></CODE><BR><BR><BR>Hope 
                                that helps... <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/win32/AntonioWinLock.asp&amp;df=100&amp;forumid=62485&amp;select=1743972">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/win32/AntonioWinLock.asp&amp;df=100&amp;forumid=62485&amp;select=1743972">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;tid=1743430&amp;forumid=62485&amp;select=1743972#xx1743972xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?msg=1743972#xx1743972xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(3099797,1743972);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1698342_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1698342xx></A><IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_question.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;forumid=62485&amp;select=1698342#xx1698342xx" 
                                name=1698342><B>errror-170 (resourse in 
                                use)</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=3339816"><IMG 
                                title="Click for User Profile" height=15 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>naveen.bellcorservices</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>16:20 4 
                                Oct 
                            '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1698342_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT 
                                class=messagecontent>hi<BR><BR>i find this 
                                thread quite intersting and best.Actually i am 
                                trying to develop same kind of application.this 
                                threads really helped me a lot. I have converted 
                                this application in vb.net.every thing is 
                                working fine.But their is only one 
                                problem,Solution of which hasn't found 
                                yet.<BR><BR>Mine application has a button on a 
                                form on which whole coding has been done. since 
                                window forms is running in the back ground of 
                                application "setdesktopthreads function " 
                                returns false and i get the error-170 (resourse 
                                in use)and "createprocess function" fails by 
                                showing modeldialogbox of "APPlication failed to 
                                initialize properly(error 
                                0xc0000142)".<BR><BR>how this issue can be 
                                solved help me out,demo and source downloaded 
                                from this thread are working quite properly on 
                                my win 2k system .One Possibility is that it 
                                shouldn't have forms window but than i don't 
                                know how coding can be use without form??<IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/smiley_sigh.gif" 
                                align=absMiddle> <BR><BR><BR><BR>
                                <DIV class=ForumSig>naveen 
                                kumar</DIV><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/win32/AntonioWinLock.asp&amp;df=100&amp;forumid=62485&amp;select=1698342">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/win32/AntonioWinLock.asp&amp;df=100&amp;forumid=62485&amp;select=1698342">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;tid=1698342&amp;forumid=62485&amp;select=1698342#xx1698342xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?msg=1698342#xx1698342xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(3339816,1698342);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1703176_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1703176xx></A><IMG 
                                height=1 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/ind.gif" 
                                width=18><IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_answer.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;forumid=62485&amp;select=1703176#xx1703176xx" 
                                name=1703176>Re: errror-170 (resourse in 
                                use)</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=3339816"><IMG 
                                title="Click for User Profile" height=15 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>naveen.bellcorservices&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>13:27 8 Oct 
                                '06&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1703176_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/ind.gif" 
                                width=18><IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>hi 
                                <BR><BR>i have sorted out the 
                                problems.<BR><BR>tnx<IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/smiley_laugh.gif" 
                                align=absMiddle> <BR><BR>
                                <DIV class=ForumSig>naveen 
                                kumar</DIV><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/win32/AntonioWinLock.asp&amp;df=100&amp;forumid=62485&amp;select=1703176">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/win32/AntonioWinLock.asp&amp;df=100&amp;forumid=62485&amp;select=1703176">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;tid=1698342&amp;forumid=62485&amp;select=1703176#xx1703176xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?msg=1703176#xx1703176xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(3339816,1703176);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1679235_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1679235xx></A><IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_question.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;forumid=62485&amp;select=1679235#xx1679235xx" 
                                name=1679235><B>can't disable the alt-tab 
                                ,</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=3374373"><IMG 
                                title="Click for User Profile" height=15 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>k_safa</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>9:48 21 
                                Sep 
                            '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1679235_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>I am 
                                writing an application in java. In my 
                                application i would prevent users to do the 
                                alt-tab.<BR><BR>For that, i wrote the dll 
                                (HelloWorld.cpp) below :<BR><BR>//the callback 
                                function<BR><CODE>LRESULT CALLBACK 
                                LowLevelKeyboardProc(int nCode, WPARAM wParam, 
                                LPARAM lParam) <BR>{<BR>PKBDLLHOOKSTRUCT 
                                p;<BR><BR>// to verify that the function has 
                                been called<BR>char ch;<BR>FILE* 
                                f1=fopen("C:\eclipse\workspace\native\report.txt","a+");<BR>ch='\n';<BR>fwrite(&amp;ch,1,1,f1);<BR>fclose(f1);<BR><BR>// 
                                to diable the Alt-Tab <BR>if (nCode == 
                                HC_ACTION) <BR>{<BR>p = (PKBDLLHOOKSTRUCT) 
                                lParam;<BR><BR>if (<BR><BR>// 
                                ALT+TAB<BR>(p-&gt;vkCode == VK_TAB &amp;&amp; 
                                p-&gt;flags &amp; LLKHF_ALTDOWN) 
                                <BR><BR><BR>)<BR>return 1;<BR>}<BR><BR>return 
                                CallNextHookEx(hKeyboardHook, nCode, wParam, 
                                lParam);<BR>}<BR><BR><BR><BR><BR><BR>/*****************************************************<BR>* 
                                to install the hook<BR>* Enable/Disable task 
                                switching keys. *<BR>* (Alt+Tab) *<BR>* 
                                TRUE=Enable, FALSE=Disable *<BR>* (Win NT4SP3+, 
                                Win2K). 
                                *<BR>*****************************************************/<BR>JNIEXPORT 
                                jboolean JNICALL 
                                Java_HelloWorld_installhook<BR>(JNIEnv *, 
                                jclass, jboolean bEnableDisable)<BR><BR>{ 
                                <BR><BR>if (!bEnableDisable)<BR>{<BR><BR>// 
                                Install the low-level keyboard 
                                hook<BR>hKeyboardHook = 
                                SetWindowsHookEx(WH_KEYBOARD_LL, 
                                <BR>(HOOKPROC)LowLevelKeyboardProc, 
                                <BR>(HINSTANCE)NULL, 
                                <BR>GetCurrentThreadId());<BR><BR><BR><BR><BR>if 
                                (!hKeyboardHook)<BR><BR>return 
                                0;<BR><BR>}<BR>else<BR>{<BR>UnhookWindowsHookEx(hKeyboardHook);<BR>hKeyboardHook 
                                = NULL;<BR>}<BR><BR>return 
                                1;<BR>}<BR></CODE><BR>but when i call the 
                                installhook from my java application it return a 
                                false value(0),means that the hook is not 
                                installed.<BR><BR>the method installhook is 
                                called from :<BR><BR><CODE>public class 
                                HelloWorld {<BR>static { 
                                System.loadLibrary("HelloWorld"); 
                                }<BR><BR>public static native boolean 
                                installhook(boolean 
                                bEnableDisable);<BR><BR>public static void 
                                main(String args[]) {<BR>System.out.print("Hello 
                                ");<BR>boolean bool = 
                                HelloWorld.installhook(false);<BR><BR><BR>System.out.print("bool 
                                : " + bool);<BR><BR>}<BR></CODE><BR><BR>Could 
                                you please help me ?<BR><BR>P.S. : It is not the 
                                application that i am writing but this is a 
                                simple program to test it befor integrate 
                                it.<BR><BR>Thanks for you 
                                <BR><BR>Kass29<BR><BR><BR><BR>-- modified at 
                                4:02 Friday 22nd September, 2006 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/win32/AntonioWinLock.asp&amp;df=100&amp;forumid=62485&amp;select=1679235">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/win32/AntonioWinLock.asp&amp;df=100&amp;forumid=62485&amp;select=1679235">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;tid=1679235&amp;forumid=62485&amp;select=1679235#xx1679235xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?msg=1679235#xx1679235xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(3374373,1679235);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1701381_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1701381xx></A><IMG 
                                height=1 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/ind.gif" 
                                width=18><IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_answer.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;forumid=62485&amp;select=1701381#xx1701381xx" 
                                name=1701381>Re: can't disable the alt-tab 
                                ,</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=3163037"><IMG 
                                title="Click for User Profile" height=15 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>emsttam&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>10:42 6 Oct 
                                '06&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1701381_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/ind.gif" 
                                width=18><IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT 
                                class=messagecontent>Hi,<BR><BR>Did you ever 
                                solve this ? <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/win32/AntonioWinLock.asp&amp;df=100&amp;forumid=62485&amp;select=1701381">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/win32/AntonioWinLock.asp&amp;df=100&amp;forumid=62485&amp;select=1701381">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;tid=1679235&amp;forumid=62485&amp;select=1701381#xx1701381xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?msg=1701381#xx1701381xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(3163037,1701381);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1638161_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1638161xx></A><IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_question.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;forumid=62485&amp;select=1638161#xx1638161xx" 
                                name=1638161><B>Big problems with the 
                                WinLockDLL</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=2723122"><IMG 
                                title="Click for User Profile" height=15 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>Bjerner</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>5:59 23 
                                Aug 
                            '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1638161_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Thank 
                                you for a great DLL.<BR><BR>Unfortunately I have 
                                discovered a problem when using the DLL.<BR>The 
                                problem appears when I do the following:<BR>- 
                                Open 2 instances of the demo project (or other 
                                projects using the DLL)<BR>- Mark the "Disable 
                                Ctrl+Alt+Del and Ctrl+Shift+Esc (Win NT, 2K)" 
                                check box in both instances<BR>- Unmark the 
                                "Disable Ctrl+Alt+Del and Ctrl+Shift+Esc (Win 
                                NT, 2K)" check box in one of the instances and 
                                close the instance<BR>- Unmark the "Disable 
                                Ctrl+Alt+Del and Ctrl+Shift+Esc (Win NT, 2K)" 
                                check box in the second instances and close the 
                                instance<BR><BR>When I close the second instance 
                                I get the following error:<BR>"Winlogon generic 
                                control dialog: winlogon.exe - Application 
                                Error"<BR>"The instruction at "0x00c50051" 
                                referenced memory at "0x00c50051". The memory 
                                could not be "read"."<BR><BR>When I press OK to 
                                the message my computer restarts. I have tried 
                                it on both Windows 2000 and Windows 
                                XP.<BR><BR>Of course I can avoid starting 2 
                                instances, but I cant know if any other 
                                processes are doing something like the 
                                same.<BR>What do I do to avoid this 
                                problem??<BR><BR>Regards<BR>Bjerner 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/win32/AntonioWinLock.asp&amp;df=100&amp;forumid=62485&amp;select=1638161">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/win32/AntonioWinLock.asp&amp;df=100&amp;forumid=62485&amp;select=1638161">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;tid=1638161&amp;forumid=62485&amp;select=1638161#xx1638161xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?msg=1638161#xx1638161xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>Score: 2.0 (2 
                                votes).
                                <SCRIPT language=Javascript>MsgVoteForm(2723122,1638161);</SCRIPT>
                                 
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1633787_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1633787xx></A><IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_question.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle style="COLOR: #aa0000" 
                                width="100%"><A class=messagetitle 
                                id=DynMessLink style="COLOR: #aa0000" 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;forumid=62485&amp;select=1633787#xx1633787xx" 
                                name=1633787><B>Source for DLL?</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=3292491"><IMG 
                                title="Click for User Profile" height=15 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT class=messagetitle 
                                style="COLOR: #aa0000"><B>phetheant</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle 
                                style="COLOR: #aa0000"><B>14:01 20 Aug 
                                '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1633787_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Hi, 
                                <BR>Is it possible to see the source for the DLL 
                                for this project? I am looking at making a 
                                couple of tweaks/additions to this, and would 
                                like to keep all the code 
                                together.<BR><BR>Cheers,<BR>Tom 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/win32/AntonioWinLock.asp&amp;df=100&amp;forumid=62485&amp;select=1633787">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/win32/AntonioWinLock.asp&amp;df=100&amp;forumid=62485&amp;select=1633787">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;tid=1633787&amp;forumid=62485&amp;select=1633787#xx1633787xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?msg=1633787#xx1633787xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>Score: 5.0 (1 
                                vote).
                                <SCRIPT language=Javascript>MsgVoteForm(3292491,1633787);</SCRIPT>
                                 
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1626170_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1626170xx></A><IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;forumid=62485&amp;select=1626170#xx1626170xx" 
                                name=1626170><B>Missing link</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=2416080"><IMG 
                                title="Click for User Profile" height=15 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>closelate</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>13:58 15 
                                Aug 
                            '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1626170_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>I try 
                                to call Taskbar_Show_Hide in my own program but 
                                got link error. error LNK2001: unresolved 
                                external symbol "__declspec(dllimport) int 
                                __stdcall Taskbar_Show_Hide(int)" 
                                (__imp_?Taskbar_Show_Hide@@YGHH@Z) In project 
                                setting I linked the 
                                WinLockdll\dll\debug\winlockdll.lib<BR>Anyone 
                                know what happened? Thanks 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/win32/AntonioWinLock.asp&amp;df=100&amp;forumid=62485&amp;select=1626170">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/win32/AntonioWinLock.asp&amp;df=100&amp;forumid=62485&amp;select=1626170">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;tid=1626170&amp;forumid=62485&amp;select=1626170#xx1626170xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?msg=1626170#xx1626170xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(2416080,1626170);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1594428_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1594428xx></A><IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_question.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;forumid=62485&amp;select=1594428#xx1594428xx" 
                                name=1594428><B>After run the sample, 
                                ExitWindowsEx call do nothing.</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=391876"><IMG 
                                title="Click for User Profile" height=15 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>jbleeok</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>10:19 25 
                                Jul 
                            '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1594428_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>I'm 
                                writing some code using this article's 
                                source.<BR>When I call 
                                ExitWindowsEx(EWX_POWEROFF, 0); before 
                                something, it works.<BR>But, after sample load, 
                                click some buttons and go to original status, 
                                the function not work, MSDN said that it return 
                                0 when the work fails. But the return is 1 and 
                                do nothing.<BR>Would you tell me why?<BR><IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/smiley_confused.gif" 
                                align=absMiddle> <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/win32/AntonioWinLock.asp&amp;df=100&amp;forumid=62485&amp;select=1594428">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/win32/AntonioWinLock.asp&amp;df=100&amp;forumid=62485&amp;select=1594428">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;tid=1594428&amp;forumid=62485&amp;select=1594428#xx1594428xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?msg=1594428#xx1594428xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(391876,1594428);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1595281_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1595281xx></A><IMG 
                                height=1 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/ind.gif" 
                                width=18><IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_answer.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;forumid=62485&amp;select=1595281#xx1595281xx" 
                                name=1595281>Re: After run the sample, 
                                ExitWindowsEx call do nothing.</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=391876"><IMG 
                                title="Click for User Profile" height=15 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>jbleeok&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>22:35 25 Jul 
                                '06&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1595281_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/ind.gif" 
                                width=18><IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT 
                                class=messagecontent>"Disable Ctrl-Alt-Del..." 
                                was called twice.<BR>That was the reason of the 
                                false operation.<BR><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/win32/AntonioWinLock.asp&amp;df=100&amp;forumid=62485&amp;select=1595281">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/win32/AntonioWinLock.asp&amp;df=100&amp;forumid=62485&amp;select=1595281">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;tid=1594428&amp;forumid=62485&amp;select=1595281#xx1595281xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?msg=1595281#xx1595281xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(391876,1595281);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1578839_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1578839xx></A><IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_question.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;forumid=62485&amp;select=1578839#xx1578839xx" 
                                name=1578839><B>Remap ctr-alt-del</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=1454684"><IMG 
                                title="Click for User Profile" height=15 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>tulp</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>12:08 15 
                                Jul 
                            '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1578839_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>How 
                                could I use this to make an alternative 
                                Ctrl-Alt-Del combination (eg. Ctrl-Alt-Ins or 
                                simply 'Ins' to trigge the SAS 
                                signal).<BR><BR>ps. Very nice article. Thanx a 
                                lot!<IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/smiley_redface.gif" 
                                align=absMiddle> 
                                <BR><BR>Arthur<BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/win32/AntonioWinLock.asp&amp;df=100&amp;forumid=62485&amp;select=1578839">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/win32/AntonioWinLock.asp&amp;df=100&amp;forumid=62485&amp;select=1578839">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;tid=1578839&amp;forumid=62485&amp;select=1578839#xx1578839xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?msg=1578839#xx1578839xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>Score: 2.0 (1 
                                vote).
                                <SCRIPT language=Javascript>MsgVoteForm(1454684,1578839);</SCRIPT>
                                 
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1612972_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1612972xx></A><IMG 
                                height=1 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/ind.gif" 
                                width=18><IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_answer.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;forumid=62485&amp;select=1612972#xx1612972xx" 
                                name=1612972>Re: Remap ctr-alt-del</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=18677"><IMG 
                                title="Click for User Profile" height=15 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>Cristian 
                                Amarie&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>15:01 6 Aug 
                                '06&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1612972_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/ind.gif" 
                                width=18><IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>You 
                                can't. The SAS sequence Ctrl-Alt-Del is catched 
                                by Winlogon, not by a GINA (soon defunct in 
                                Vista) or shell. <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/win32/AntonioWinLock.asp&amp;df=100&amp;forumid=62485&amp;select=1612972">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/win32/AntonioWinLock.asp&amp;df=100&amp;forumid=62485&amp;select=1612972">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;tid=1578839&amp;forumid=62485&amp;select=1612972#xx1612972xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?msg=1612972#xx1612972xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(18677,1612972);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1562661_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1562661xx></A><IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_question.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle style="COLOR: #aa0000" 
                                width="100%"><A class=messagetitle 
                                id=DynMessLink style="COLOR: #aa0000" 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;forumid=62485&amp;select=1562661#xx1562661xx" 
                                name=1562661><B>Why CreateProcess in the 
                                WinLock_dll is getting failed when WinLock_ exe 
                                is running under service...</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=1629186"><IMG 
                                title="Click for User Profile" height=15 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT class=messagetitle 
                                style="COLOR: #aa0000"><B>nagamohan_p</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle 
                                style="COLOR: #aa0000"><B>13:38 5 Jul 
                                '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1562661_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT 
                                class=messagecontent>Hi,<BR>I created a service 
                                in which the WinLock_exe is callled...when I 
                                clicked "Run the process in new desktop" of the 
                                WinLock_exe, the CreateProcess in the 
                                WinLock_dll is getting failed...But it is 
                                working fine when the WinLock_exe is running 
                                individually ie, not running under 
                                service...<BR><BR>Please suggest me for creating 
                                the process when the winLock_exe is running 
                                under service...<BR><BR>I'm eagerly waiting for 
                                ur suggestions...<BR><BR>Regards,<BR>nag. 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/win32/AntonioWinLock.asp&amp;df=100&amp;forumid=62485&amp;select=1562661">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/win32/AntonioWinLock.asp&amp;df=100&amp;forumid=62485&amp;select=1562661">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;tid=1562661&amp;forumid=62485&amp;select=1562661#xx1562661xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?msg=1562661#xx1562661xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>Score: 5.0 (1 
                                vote).
                                <SCRIPT language=Javascript>MsgVoteForm(1629186,1562661);</SCRIPT>
                                 
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1562635_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1562635xx></A><IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_question.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;forumid=62485&amp;select=1562635#xx1562635xx" 
                                name=1562635><B>why Ctrl+Alt+Del is still 
                                disabled after closing the exe...</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=1629186"><IMG 
                                title="Click for User Profile" height=15 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>nagamohan_p</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>13:19 5 
                                Jul 
                            '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1562635_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT 
                                class=messagecontent>Hi,<BR><BR>I don't 
                                understand why Ctrl+Alt+Del is still disabled 
                                after closing the WinLock_exe...I have seen the 
                                dll, but I didn't understand the ejectcode() 
                                function...Please give me the suggestions to 
                                enable Ctrl+Alt+Del after closing the 
                                application...<BR><BR>I'm eagerly waiting for ur 
                                suggestions...<BR><BR>Regards,<BR>nag.<BR><BR><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/win32/AntonioWinLock.asp&amp;df=100&amp;forumid=62485&amp;select=1562635">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/win32/AntonioWinLock.asp&amp;df=100&amp;forumid=62485&amp;select=1562635">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;tid=1562635&amp;forumid=62485&amp;select=1562635#xx1562635xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?msg=1562635#xx1562635xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(1629186,1562635);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1578843_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1578843xx></A><IMG 
                                height=1 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/ind.gif" 
                                width=18><IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_answer.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;forumid=62485&amp;select=1578843#xx1578843xx" 
                                name=1578843>Re: why Ctrl+Alt+Del is still 
                                disabled after closing the exe...</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=1454684"><IMG 
                                title="Click for User Profile" height=15 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>tulp&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>12:19 15 Jul 
                                '06&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1578843_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/ind.gif" 
                                width=18><IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT 
                                class=messagecontent>Basically the application 
                                alters another process, namely the Winlogon 
                                process, while it is running. The winlogon 
                                process is not pointing to this application. So 
                                when this application exits, the winlogo process 
                                stays as it is (altered), and the ctrl-alt-del 
                                is still not working.<BR><BR>To re-enable the 
                                ctrl-alt-del when your applicatio exits, you 
                                must simply call CtrlAltDel_Enable_Disable(True) 
                                in order to have the winlogon process restored. 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/win32/AntonioWinLock.asp&amp;df=100&amp;forumid=62485&amp;select=1578843">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/win32/AntonioWinLock.asp&amp;df=100&amp;forumid=62485&amp;select=1578843">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;tid=1562635&amp;forumid=62485&amp;select=1578843#xx1578843xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?msg=1578843#xx1578843xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>Score: 3.0 (1 
                                vote).
                                <SCRIPT language=Javascript>MsgVoteForm(1454684,1578843);</SCRIPT>
                                 
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1812262_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1812262xx></A><IMG 
                                height=1 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/ind.gif" 
                                width=36><IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;forumid=62485&amp;select=1812262#xx1812262xx" 
                                name=1812262>Re: why Ctrl+Alt+Del is still 
                                disabled after closing the exe...</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=3597376"><IMG 
                                title="Click for User Profile" height=15 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>EmAn7&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>7:45 20 Dec 
                                '06&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1812262_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/ind.gif" 
                                width=36><IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>I am 
                                having this problem also. Even with the 
                                Enable(TRUE) statement at the end. What can be 
                                done? Please help me <IMG 
                                src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/smiley_WTF.gif" 
                                align=absMiddle><BR><BR>Thanks,<BR>Emily 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/win32/AntonioWinLock.asp&amp;df=100&amp;forumid=62485&amp;select=1812262">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/win32/AntonioWinLock.asp&amp;df=100&amp;forumid=62485&amp;select=1812262">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;tid=1562635&amp;forumid=62485&amp;select=1812262#xx1812262xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/win32/AntonioWinLock.asp?msg=1812262#xx1812262xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(3597376,1812262);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/t.gif" 
                              width=1 border=0></TD></TR></TBODY></TABLE></TD></TR>
                    <TR bgColor=#fbedbb>
                      <TD>
                        <TABLE cellPadding=2 width="100%">
                          <TBODY>
                          <TR>
                            <TD class=messagetitle>Last Visit: 3:20 Wednesday 
                              31st January, 2007</TD>
                            <TD noWrap align=right><FONT 
                              class=messagetitle><SPAN 
                              class=HoverLink>First</SPAN> <SPAN 
                              class=HoverLink>Prev</SPAN> <A class=HoverLink 
                              href="http://www.codeproject.com/win32/AntonioWinLock.asp?df=100&amp;forumid=62485&amp;fr=26" 
                              name=HoverNL>Next</A> <SPAN 
                              class=HoverLink>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN> 
                              </FONT></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></DIV>
            <P class=smallText><IMG 
            src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_general.gif" 
            align=absMiddle> General comment &nbsp;&nbsp; <IMG 
            src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_info.gif" 
            align=absMiddle> News / Info &nbsp;&nbsp; <IMG 
            src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_question.gif" 
            align=absMiddle> Question &nbsp;&nbsp; <IMG 
            src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_answer.gif" 
            align=absMiddle> Answer &nbsp;&nbsp; <IMG 
            src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_game.gif" 
            align=absMiddle> Joke / Game &nbsp;&nbsp; <IMG 
            src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/news_sticky.gif" 
            align=absMiddle> Admin message</P><BR>
            <TABLE cellSpacing=5 width="100%">
              <TBODY>
              <TR vAlign=top>
                <TD class=smallText>Updated: 3 May 2005 </TD>
                <TD class=SmallText align=right>Article content copyright 
                  Antnio Feijo, 2004<BR>everything else Copyright © <A 
                  href="mailto:webmaster@codeproject.com">CodeProject</A>, 
                  1999-2007</A>. <BR>Web10 | <A 
                  href="http://www.codeproject.com/info/MediaKit">Advertise on 
                  The Code Project</A> | <A 
                  href="http://www.codeproject.com/info/privacy.asp">Privacy</A> 
                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
      <SCRIPT 
      src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/front.asp" 
      type=text/javascript></SCRIPT>
      <BR>
      <CENTER>
      <TABLE cellSpacing=0 cellPadding=0 width="95%" border=0>
        <TBODY>
        <TR>
          <TD bgColor=#ff9900 height=1><IMG height=1 
            src="Lock Windows Desktop - The Code Project - Win32 - SDK.files/space.gif"></TD></TR>
        <TR>
          <TD align=middle><FONT size=1><A 
            href="http://www.theultimatetoolbox.com/">The Ultimate Toolbox</A>  
            <A href="http://www.aspalliance.com/">ASP Alliance</A>  <A 
            href="http://www.developerfusion.co.uk/">Developer Fusion</A>  <A 
            href="http://www.developersdex.com/">Developersdex</A>  <A 
            href="http://www.devguru.com/">DevGuru</A>  <A 
            href="http://www.programmersheaven.com/">Programmers Heaven</A>  <A 
            href="http://www.planet-source-code.com/">Planet Source Code</A>  
            <A href="http://www.tek-tips.com/">Tek-Tips Forums</A>  
        </FONT></TD></TR></TBODY></TABLE></CENTER></TR></TBODY></TABLE></BODY></HTML>
